{"remainingRequest":"/opt/MTOBS-BIKASH/node_modules/babel-loader/lib/index.js?presets[]=@babel/react&presets[]=@babel/env!/opt/MTOBS-BIKASH/node_modules/eslint-loader/dist/cjs.js!/opt/MTOBS-BIKASH/src/js/components/stock-movement-wizard/modals/SubstitutionsModal.jsx","dependencies":[{"path":"/opt/MTOBS-BIKASH/src/js/components/stock-movement-wizard/modals/SubstitutionsModal.jsx","mtime":1698037750000},{"path":"/opt/MTOBS-BIKASH/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/opt/MTOBS-BIKASH/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/opt/MTOBS-BIKASH/node_modules/eslint-loader/dist/cjs.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsgcmV0dXJuIF90eXBlb2YgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgInN5bWJvbCIgPT0gdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfSwgX3R5cGVvZihvYmopOyB9CmZ1bmN0aW9uIF9leHRlbmRzKCkgeyBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gPyBPYmplY3QuYXNzaWduLmJpbmQoKSA6IGZ1bmN0aW9uICh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXTsgZm9yICh2YXIga2V5IGluIHNvdXJjZSkgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkgeyB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOyB9IH0gfSByZXR1cm4gdGFyZ2V0OyB9OyByZXR1cm4gX2V4dGVuZHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfQpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7IHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7IH0KZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC4iKTsgfQpmdW5jdGlvbiBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobywgbWluTGVuKSB7IGlmICghbykgcmV0dXJuOyBpZiAodHlwZW9mIG8gPT09ICJzdHJpbmciKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpOyBpZiAobiA9PT0gIk9iamVjdCIgJiYgby5jb25zdHJ1Y3RvcikgbiA9IG8uY29uc3RydWN0b3IubmFtZTsgaWYgKG4gPT09ICJNYXAiIHx8IG4gPT09ICJTZXQiKSByZXR1cm4gQXJyYXkuZnJvbShvKTsgaWYgKG4gPT09ICJBcmd1bWVudHMiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgfQpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5KGl0ZXIpIHsgaWYgKHR5cGVvZiBTeW1ib2wgIT09ICJ1bmRlZmluZWQiICYmIGl0ZXJbU3ltYm9sLml0ZXJhdG9yXSAhPSBudWxsIHx8IGl0ZXJbIkBAaXRlcmF0b3IiXSAhPSBudWxsKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTsgfQpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShhcnIpOyB9CmZ1bmN0aW9uIF9hcnJheUxpa2VUb0FycmF5KGFyciwgbGVuKSB7IGlmIChsZW4gPT0gbnVsbCB8fCBsZW4gPiBhcnIubGVuZ3RoKSBsZW4gPSBhcnIubGVuZ3RoOyBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShsZW4pOyBpIDwgbGVuOyBpKyspIHsgYXJyMltpXSA9IGFycltpXTsgfSByZXR1cm4gYXJyMjsgfQpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsgZW51bWVyYWJsZU9ubHkgJiYgKHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KSksIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsgfSByZXR1cm4ga2V5czsgfQpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gbnVsbCAhPSBhcmd1bWVudHNbaV0gPyBhcmd1bWVudHNbaV0gOiB7fTsgaSAlIDIgPyBvd25LZXlzKE9iamVjdChzb3VyY2UpLCAhMCkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KSA6IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKSA6IG93bktleXMoT2JqZWN0KHNvdXJjZSkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsgfSk7IH0gcmV0dXJuIHRhcmdldDsgfQpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7IGtleSA9IF90b1Byb3BlcnR5S2V5KGtleSk7IGlmIChrZXkgaW4gb2JqKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgeyB2YWx1ZTogdmFsdWUsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7IH0gZWxzZSB7IG9ialtrZXldID0gdmFsdWU7IH0gcmV0dXJuIG9iajsgfQpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgX3RvUHJvcGVydHlLZXkoZGVzY3JpcHRvci5rZXkpLCBkZXNjcmlwdG9yKTsgfSB9CmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbnN0cnVjdG9yLCAicHJvdG90eXBlIiwgeyB3cml0YWJsZTogZmFsc2UgfSk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQpmdW5jdGlvbiBfdG9Qcm9wZXJ0eUtleShhcmcpIHsgdmFyIGtleSA9IF90b1ByaW1pdGl2ZShhcmcsICJzdHJpbmciKTsgcmV0dXJuIF90eXBlb2Yoa2V5KSA9PT0gInN5bWJvbCIgPyBrZXkgOiBTdHJpbmcoa2V5KTsgfQpmdW5jdGlvbiBfdG9QcmltaXRpdmUoaW5wdXQsIGhpbnQpIHsgaWYgKF90eXBlb2YoaW5wdXQpICE9PSAib2JqZWN0IiB8fCBpbnB1dCA9PT0gbnVsbCkgcmV0dXJuIGlucHV0OyB2YXIgcHJpbSA9IGlucHV0W1N5bWJvbC50b1ByaW1pdGl2ZV07IGlmIChwcmltICE9PSB1bmRlZmluZWQpIHsgdmFyIHJlcyA9IHByaW0uY2FsbChpbnB1dCwgaGludCB8fCAiZGVmYXVsdCIpOyBpZiAoX3R5cGVvZihyZXMpICE9PSAib2JqZWN0IikgcmV0dXJuIHJlczsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQEB0b1ByaW1pdGl2ZSBtdXN0IHJldHVybiBhIHByaW1pdGl2ZSB2YWx1ZS4iKTsgfSByZXR1cm4gKGhpbnQgPT09ICJzdHJpbmciID8gU3RyaW5nIDogTnVtYmVyKShpbnB1dCk7IH0KZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBPYmplY3QuZGVmaW5lUHJvcGVydHkoc3ViQ2xhc3MsICJwcm90b3R5cGUiLCB7IHdyaXRhYmxlOiBmYWxzZSB9KTsgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7IH0KZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mLmJpbmQoKSA6IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IG8uX19wcm90b19fID0gcDsgcmV0dXJuIG87IH07IHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7IH0KZnVuY3Rpb24gX2NyZWF0ZVN1cGVyKERlcml2ZWQpIHsgdmFyIGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QgPSBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCk7IHJldHVybiBmdW5jdGlvbiBfY3JlYXRlU3VwZXJJbnRlcm5hbCgpIHsgdmFyIFN1cGVyID0gX2dldFByb3RvdHlwZU9mKERlcml2ZWQpLCByZXN1bHQ7IGlmIChoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KSB7IHZhciBOZXdUYXJnZXQgPSBfZ2V0UHJvdG90eXBlT2YodGhpcykuY29uc3RydWN0b3I7IHJlc3VsdCA9IFJlZmxlY3QuY29uc3RydWN0KFN1cGVyLCBhcmd1bWVudHMsIE5ld1RhcmdldCk7IH0gZWxzZSB7IHJlc3VsdCA9IFN1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7IH0gcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIHJlc3VsdCk7IH07IH0KZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7IHJldHVybiBjYWxsOyB9IGVsc2UgaWYgKGNhbGwgIT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJEZXJpdmVkIGNvbnN0cnVjdG9ycyBtYXkgb25seSByZXR1cm4gb2JqZWN0IG9yIHVuZGVmaW5lZCIpOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9CmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7IH0gcmV0dXJuIHNlbGY7IH0KZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHsgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSAidW5kZWZpbmVkIiB8fCAhUmVmbGVjdC5jb25zdHJ1Y3QpIHJldHVybiBmYWxzZTsgaWYgKFJlZmxlY3QuY29uc3RydWN0LnNoYW0pIHJldHVybiBmYWxzZTsgaWYgKHR5cGVvZiBQcm94eSA9PT0gImZ1bmN0aW9uIikgcmV0dXJuIHRydWU7IHRyeSB7IEJvb2xlYW4ucHJvdG90eXBlLnZhbHVlT2YuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChCb29sZWFuLCBbXSwgZnVuY3Rpb24gKCkge30pKTsgcmV0dXJuIHRydWU7IH0gY2F0Y2ggKGUpIHsgcmV0dXJuIGZhbHNlOyB9IH0KZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mLmJpbmQoKSA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7IH07IHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7IH0KaW1wb3J0IFJlYWN0LCB7IENvbXBvbmVudCB9IGZyb20gJ3JlYWN0JzsKaW1wb3J0IF8gZnJvbSAnbG9kYXNoJzsKaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJzsKaW1wb3J0IHsgY29ubmVjdCB9IGZyb20gJ3JlYWN0LXJlZHV4JzsKaW1wb3J0IHsgVG9vbHRpcCB9IGZyb20gJ3JlYWN0LXRpcHB5JzsKaW1wb3J0IHsgaGlkZVNwaW5uZXIsIHNob3dTcGlubmVyIH0gZnJvbSAnYWN0aW9ucyc7CmltcG9ydCBBcnJheUZpZWxkIGZyb20gJ2NvbXBvbmVudHMvZm9ybS1lbGVtZW50cy9BcnJheUZpZWxkJzsKaW1wb3J0IExhYmVsRmllbGQgZnJvbSAnY29tcG9uZW50cy9mb3JtLWVsZW1lbnRzL0xhYmVsRmllbGQnOwppbXBvcnQgTW9kYWxXcmFwcGVyIGZyb20gJ2NvbXBvbmVudHMvZm9ybS1lbGVtZW50cy9Nb2RhbFdyYXBwZXInOwppbXBvcnQgUHJvZHVjdFNlbGVjdEZpZWxkIGZyb20gJ2NvbXBvbmVudHMvZm9ybS1lbGVtZW50cy9Qcm9kdWN0U2VsZWN0RmllbGQnOwppbXBvcnQgU2VsZWN0RmllbGQgZnJvbSAnY29tcG9uZW50cy9mb3JtLWVsZW1lbnRzL1NlbGVjdEZpZWxkJzsKaW1wb3J0IFRleHRGaWVsZCBmcm9tICdjb21wb25lbnRzL2Zvcm0tZWxlbWVudHMvVGV4dEZpZWxkJzsKaW1wb3J0IGFwaUNsaWVudCBmcm9tICd1dGlscy9hcGlDbGllbnQnOwppbXBvcnQgeyBkZWJvdW5jZUF2YWlsYWJsZUl0ZW1zRmV0Y2ggfSBmcm9tICd1dGlscy9vcHRpb24tdXRpbHMnOwppbXBvcnQgVHJhbnNsYXRlIGZyb20gJ3V0aWxzL1RyYW5zbGF0ZSc7CnZhciBGSUVMRFMgPSB7CiAgcmVhc29uQ29kZTogewogICAgdHlwZTogU2VsZWN0RmllbGQsCiAgICBsYWJlbDogJ3JlYWN0LnN0b2NrTW92ZW1lbnQucmVhc29uRm9yLmxhYmVsJywKICAgIGRlZmF1bHRNZXNzYWdlOiAnUmVhc29uIGZvciBub3QgZnVsZmlsbGluZyBmdWxsIHF0eScsCiAgICBhdHRyaWJ1dGVzOiB7CiAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICBjbGFzc05hbWU6ICdtYi0yJwogICAgfSwKICAgIGdldER5bmFtaWNBdHRyOiBmdW5jdGlvbiBnZXREeW5hbWljQXR0cihwcm9wcykgewogICAgICByZXR1cm4gewogICAgICAgIG9wdGlvbnM6IHByb3BzLnJlYXNvbkNvZGVzCiAgICAgIH07CiAgICB9CiAgfSwKICBzdWJzdGl0dXRpb25zOiB7CiAgICB0eXBlOiBBcnJheUZpZWxkLAogICAgZ2V0RHluYW1pY1Jvd0F0dHI6IGZ1bmN0aW9uIGdldER5bmFtaWNSb3dBdHRyKF9yZWYpIHsKICAgICAgdmFyIHJvd1ZhbHVlcyA9IF9yZWYucm93VmFsdWVzLAogICAgICAgIG9yaWdpbmFsSXRlbSA9IF9yZWYub3JpZ2luYWxJdGVtLAogICAgICAgIGlzTG9hZGluZyA9IF9yZWYuaXNMb2FkaW5nLAogICAgICAgIGlzRW1wdHlEYXRhID0gX3JlZi5pc0VtcHR5RGF0YTsKICAgICAgdmFyIGNsYXNzTmFtZSA9ICcnOwogICAgICB2YXIgcm93RGF0ZSA9IG5ldyBEYXRlKHJvd1ZhbHVlcy5taW5FeHBpcmF0aW9uRGF0ZSk7CiAgICAgIHZhciBvcmlnRGF0ZSA9IG9yaWdpbmFsSXRlbSAmJiBvcmlnaW5hbEl0ZW0ubWluRXhwaXJhdGlvbkRhdGUgPyBuZXcgRGF0ZShvcmlnaW5hbEl0ZW0ubWluRXhwaXJhdGlvbkRhdGUpIDogbnVsbDsKICAgICAgaWYgKCFyb3dWYWx1ZXMub3JpZ2luYWxJdGVtKSB7CiAgICAgICAgY2xhc3NOYW1lID0gb3JpZ0RhdGUgJiYgcm93RGF0ZSAmJiByb3dEYXRlIDwgb3JpZ0RhdGUgfHwgIW9yaWdEYXRlICYmIHJvd0RhdGUgPyAndGV4dC1kYW5nZXInIDogJyc7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY2xhc3NOYW1lID0gJ2ZvbnQtd2VpZ2h0LWJvbGQnOwogICAgICB9CiAgICAgIHJldHVybiB7CiAgICAgICAgY2xhc3NOYW1lOiBjbGFzc05hbWUsCiAgICAgICAgaXNMb2FkaW5nOiBpc0xvYWRpbmcsCiAgICAgICAgaXNFbXB0eURhdGE6IGlzRW1wdHlEYXRhCiAgICAgIH07CiAgICB9LAogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0L3Byb3AtdHlwZXMKICAgIGFkZEJ1dHRvbjogZnVuY3Rpb24gYWRkQnV0dG9uKF9yZWYyKSB7CiAgICAgIHZhciBhZGRSb3cgPSBfcmVmMi5hZGRSb3c7CiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiYnV0dG9uIiwgewogICAgICAgIHR5cGU6ICJidXR0b24iLAogICAgICAgIGNsYXNzTmFtZTogImJ0biBidG4tb3V0bGluZS1zdWNjZXNzIGJ0bi14cyIsCiAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgIHJldHVybiBhZGRSb3coe30sIG51bGwsIGZhbHNlKTsKICAgICAgICB9CiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyYW5zbGF0ZSwgewogICAgICAgIGlkOiAicmVhY3QuZGVmYXVsdC5idXR0b24uYWRkQ3VzdG9tU3Vic3RpdHV0aW9uLmxhYmVsIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkFkZCBjdXN0b20gc3Vic3RpdHV0aW9uIgogICAgICB9KSk7CiAgICB9LAogICAgZmllbGRzOiB7CiAgICAgIHByb2R1Y3Q6IHsKICAgICAgICBmaWVsZEtleTogJ2Rpc2FibGVkJywKICAgICAgICB0eXBlOiBQcm9kdWN0U2VsZWN0RmllbGQsCiAgICAgICAgbGFiZWw6ICdyZWFjdC5zdG9ja01vdmVtZW50LnByb2R1Y3QubGFiZWwnLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnUHJvZHVjdCcsCiAgICAgICAgZ2V0RHluYW1pY0F0dHI6IGZ1bmN0aW9uIGdldER5bmFtaWNBdHRyKF9yZWYzKSB7CiAgICAgICAgICB2YXIgZGVib3VuY2VkQXZhaWxhYmxlSXRlbXNGZXRjaCA9IF9yZWYzLmRlYm91bmNlZEF2YWlsYWJsZUl0ZW1zRmV0Y2g7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBsb2FkT3B0aW9uczogZGVib3VuY2VkQXZhaWxhYmxlSXRlbXNGZXRjaAogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgICdwcm9kdWN0Lm1pbkV4cGlyYXRpb25EYXRlJzogewogICAgICAgIHR5cGU6IExhYmVsRmllbGQsCiAgICAgICAgbGFiZWw6ICdyZWFjdC5zdG9ja01vdmVtZW50LmV4cGlyeS5sYWJlbCcsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdFeHBpcnknLAogICAgICAgIGZsZXhXaWR0aDogJzInLAogICAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICAgIHNob3dWYWx1ZVRvb2x0aXA6IHRydWUKICAgICAgICB9CiAgICAgIH0sCiAgICAgICdwcm9kdWN0LnF1YW50aXR5QXZhaWxhYmxlJzogewogICAgICAgIHR5cGU6IExhYmVsRmllbGQsCiAgICAgICAgbGFiZWw6ICdyZWFjdC5zdG9ja01vdmVtZW50LnF1YW50aXR5QXZhaWxhYmxlLmxhYmVsJywKICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1F0eSBBdmFpbGFibGUnLAogICAgICAgIGZsZXhXaWR0aDogJzInLAogICAgICAgIGZpZWxkS2V5OiAnJywKICAgICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tbmVzdGVkLXRlcm5hcnkKICAgICAgICAgIGZvcm1hdFZhbHVlOiBmdW5jdGlvbiBmb3JtYXRWYWx1ZShmaWVsZFZhbHVlKSB7CiAgICAgICAgICAgIHJldHVybiBfLmdldChmaWVsZFZhbHVlLCAncXVhbnRpdHlBdmFpbGFibGUnKSA/IF8uZ2V0KGZpZWxkVmFsdWUsICdxdWFudGl0eUF2YWlsYWJsZScpLnRvTG9jYWxlU3RyaW5nKCdlbi1VUycpIDogXy5nZXQoZmllbGRWYWx1ZSwgJ3Byb2R1Y3QucXVhbnRpdHlBdmFpbGFibGUnKSA/IF8uZ2V0KGZpZWxkVmFsdWUsICdwcm9kdWN0LnF1YW50aXR5QXZhaWxhYmxlJykudG9Mb2NhbGVTdHJpbmcoJ2VuLVVTJykgOiBudWxsOwogICAgICAgICAgfSwKICAgICAgICAgIHNob3dWYWx1ZVRvb2x0aXA6IHRydWUKICAgICAgICB9LAogICAgICAgIGdldER5bmFtaWNBdHRyOiBmdW5jdGlvbiBnZXREeW5hbWljQXR0cihfcmVmNCkgewogICAgICAgICAgdmFyIGZpZWxkVmFsdWUgPSBfcmVmNC5maWVsZFZhbHVlOwogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgdG9vbHRpcFZhbHVlOiBfLm1hcChmaWVsZFZhbHVlICYmIGZpZWxkVmFsdWUuYXZhaWxhYmxlSXRlbXMsIGZ1bmN0aW9uIChhdmFpbGFibGVJdGVtKSB7CiAgICAgICAgICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJwIiwgbnVsbCwgZmllbGRWYWx1ZS5wcm9kdWN0Q29kZSwgIiAiLCBmaWVsZFZhbHVlLnByb2R1Y3ROYW1lLCAiLCAiLCBhdmFpbGFibGVJdGVtLmV4cGlyYXRpb25EYXRlID8gYXZhaWxhYmxlSXRlbS5leHBpcmF0aW9uRGF0ZSA6ICctLS0nLCAiLCBRdHkgIiwgYXZhaWxhYmxlSXRlbS5xdWFudGl0eUF2YWlsYWJsZSk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgcXVhbnRpdHlTZWxlY3RlZDogewogICAgICAgIHR5cGU6IFRleHRGaWVsZCwKICAgICAgICBsYWJlbDogJ3JlYWN0LnN0b2NrTW92ZW1lbnQucXVhbnRpdHlTZWxlY3RlZC5sYWJlbCcsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdRdWFudGl0eSBzZWxlY3RlZCcsCiAgICAgICAgZmxleFdpZHRoOiAnMicsCiAgICAgICAgYXR0cmlidXRlczogewogICAgICAgICAgdHlwZTogJ251bWJlcicKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9Cn07CgovKioKICogTW9kYWwgd2luZG93IHdoZXJlIHVzZXIgY2FuIGNob29zZSBzdWJzdGl0dXRpb24gYW5kIGl0J3MgcXVhbnRpdHkuCiAqIEl0IGlzIGF2YWlsYWJsZSBvbmx5IHdoZW4gdGhlcmUgaXMgYSBzdWJzdGl0dXRpb24gZm9yIGFuIGl0ZW0uCiAqLwoKLyogZXNsaW50IG5vLXBhcmFtLXJlYXNzaWduOiAiZXJyb3IiICovCnZhciBTdWJzdGl0dXRpb25zTW9kYWwgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoU3Vic3RpdHV0aW9uc01vZGFsLCBfQ29tcG9uZW50KTsKICB2YXIgX3N1cGVyID0gX2NyZWF0ZVN1cGVyKFN1YnN0aXR1dGlvbnNNb2RhbCk7CiAgZnVuY3Rpb24gU3Vic3RpdHV0aW9uc01vZGFsKHByb3BzKSB7CiAgICB2YXIgX3RoaXM7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU3Vic3RpdHV0aW9uc01vZGFsKTsKICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpOwogICAgdmFyIF9wcm9wcyRmaWVsZENvbmZpZyA9IHByb3BzLmZpZWxkQ29uZmlnLAogICAgICBhdHRyaWJ1dGVzID0gX3Byb3BzJGZpZWxkQ29uZmlnLmF0dHJpYnV0ZXMsCiAgICAgIGdldER5bmFtaWNBdHRyID0gX3Byb3BzJGZpZWxkQ29uZmlnLmdldER5bmFtaWNBdHRyOwogICAgdmFyIGR5bmFtaWNBdHRyID0gZ2V0RHluYW1pY0F0dHIgPyBnZXREeW5hbWljQXR0cihwcm9wcykgOiB7fTsKICAgIHZhciBhdHRyID0gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBhdHRyaWJ1dGVzKSwgZHluYW1pY0F0dHIpOwogICAgX3RoaXMuc3RhdGUgPSB7CiAgICAgIGlzRW1wdHlEYXRhOiB0cnVlLAogICAgICBpc0xvYWRpbmc6IGZhbHNlLAogICAgICBhdHRyOiBhdHRyLAogICAgICBmb3JtVmFsdWVzOiB7fSwKICAgICAgb3JpZ2luYWxJdGVtOiBudWxsCiAgICB9OwogICAgX3RoaXMub25PcGVuID0gX3RoaXMub25PcGVuLmJpbmQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcykpOwogICAgX3RoaXMub25TYXZlID0gX3RoaXMub25TYXZlLmJpbmQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcykpOwogICAgX3RoaXMudmFsaWRhdGUgPSBfdGhpcy52YWxpZGF0ZS5iaW5kKF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpKTsKICAgIF90aGlzLmRlYm91bmNlZEF2YWlsYWJsZUl0ZW1zRmV0Y2ggPSBkZWJvdW5jZUF2YWlsYWJsZUl0ZW1zRmV0Y2goX3RoaXMucHJvcHMuZGVib3VuY2VUaW1lLCBfdGhpcy5wcm9wcy5taW5TZWFyY2hMZW5ndGgpOwogICAgcmV0dXJuIF90aGlzOwogIH0KICBfY3JlYXRlQ2xhc3MoU3Vic3RpdHV0aW9uc01vZGFsLCBbewogICAga2V5OiAiY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhuZXh0UHJvcHMpIHsKICAgICAgdmFyIF9uZXh0UHJvcHMkZmllbGRDb25maSA9IG5leHRQcm9wcy5maWVsZENvbmZpZywKICAgICAgICBhdHRyaWJ1dGVzID0gX25leHRQcm9wcyRmaWVsZENvbmZpLmF0dHJpYnV0ZXMsCiAgICAgICAgZ2V0RHluYW1pY0F0dHIgPSBfbmV4dFByb3BzJGZpZWxkQ29uZmkuZ2V0RHluYW1pY0F0dHI7CiAgICAgIHZhciBkeW5hbWljQXR0ciA9IGdldER5bmFtaWNBdHRyID8gZ2V0RHluYW1pY0F0dHIobmV4dFByb3BzKSA6IHt9OwogICAgICB2YXIgYXR0ciA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgYXR0cmlidXRlcyksIGR5bmFtaWNBdHRyKTsKICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgYXR0cjogYXR0cgogICAgICB9KTsKICAgIH0KCiAgICAvKiogTG9hZHMgYXZhaWxhYmxlIHN1YnN0aXR1dGlvbnMgZm9yIGNob3NlbiBpdGVtIGludG8gbW9kYWwncyBmb3JtLgogICAgICogQHB1YmxpYwogICAgICovCiAgfSwgewogICAga2V5OiAib25PcGVuIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvbk9wZW4oKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwogICAgICB0aGlzLnN0YXRlLmF0dHIub25PcGVuKCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMi5mZXRjaFN1YnN0aXR1dGlvbnMoKTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqIFNlbmRzIGFsbCBjaGFuZ2VzIG1hZGUgYnkgdXNlciBpbiB0aGlzIG1vZGFsIHRvIEFQSSBhbmQgdXBkYXRlcyBkYXRhLgogICAgICogQHBhcmFtIHtvYmplY3R9IHZhbHVlcwogICAgICogQHB1YmxpYwogICAgICovCiAgfSwgewogICAga2V5OiAib25TYXZlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvblNhdmUodmFsdWVzKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwogICAgICB0aGlzLnByb3BzLnNob3dTcGlubmVyKCk7CiAgICAgIHZhciBzdWJzdGl0dXRpb25zID0gXy5maWx0ZXIodmFsdWVzLnN1YnN0aXR1dGlvbnMsIGZ1bmN0aW9uIChzdWIpIHsKICAgICAgICByZXR1cm4gc3ViLnF1YW50aXR5U2VsZWN0ZWQgPiAwOwogICAgICB9KTsKICAgICAgdmFyIG9yaWdpbmFsSXRlbSA9IF8uZmluZCh2YWx1ZXMuc3Vic3RpdHV0aW9ucywgZnVuY3Rpb24gKHN1YikgewogICAgICAgIHJldHVybiBzdWIub3JpZ2luYWxJdGVtOwogICAgICB9KSB8fCB0aGlzLnN0YXRlLmF0dHIubGluZUl0ZW07CiAgICAgIHZhciBzdWJzdGl0dXRpb25SZWFzb25Db2RlID0gXy5nZXQodmFsdWVzLCAncmVhc29uQ29kZS52YWx1ZScpOwogICAgICB2YXIgdXJsID0gIi9vcGVuYm94ZXMvYXBpL3N0b2NrTW92ZW1lbnRJdGVtcy8iLmNvbmNhdChvcmlnaW5hbEl0ZW0ucmVxdWlzaXRpb25JdGVtSWQsICIvc3Vic3RpdHV0ZUl0ZW0iKTsKICAgICAgdmFyIHBheWxvYWQgPSB7CiAgICAgICAgc3Vic3RpdHV0aW9uSXRlbXM6IF8ubWFwKHN1YnN0aXR1dGlvbnMsIGZ1bmN0aW9uIChzdWIsIGtleSkgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgJ25ld1Byb2R1Y3QuaWQnOiBzdWIucHJvZHVjdC5pZCwKICAgICAgICAgICAgbmV3UXVhbnRpdHk6IHN1Yi5xdWFudGl0eVNlbGVjdGVkLAogICAgICAgICAgICByZWFzb25Db2RlOiBzdWJzdGl0dXRpb25SZWFzb25Db2RlID09PSAnU1VCU1RJVFVUSU9OJyA/IHN1YnN0aXR1dGlvblJlYXNvbkNvZGUgOiAiU1VCU1RJVFVUSU9OIi5jb25jYXQoc3Vic3RpdHV0aW9uUmVhc29uQ29kZSA/ICIgKCIuY29uY2F0KHN1YnN0aXR1dGlvblJlYXNvbkNvZGUsICIpIikgOiAnJyksCiAgICAgICAgICAgIC8vIFNvcnQgb3JkZXIgb2Ygc3Vic3RpdHV0aW9uIGl0ZW1zIHNob3VsZCBiZSBkaWZmZXJlbnQgZm9yIGVhY2ggb2YgdGhlbSBzbyBpdCBpcyBpbmNyZWFzZWQKICAgICAgICAgICAgc29ydE9yZGVyOiBvcmlnaW5hbEl0ZW0uc29ydE9yZGVyICsga2V5CiAgICAgICAgICB9OwogICAgICAgIH0pCiAgICAgIH07CiAgICAgIGFwaUNsaWVudC5wb3N0KHVybCwgcGF5bG9hZCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMzLnByb3BzLm9uUmVzcG9uc2UoKTsKICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzMy5wcm9wcy5oaWRlU3Bpbm5lcigpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJmZXRjaFN1YnN0aXR1dGlvbnMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZldGNoU3Vic3RpdHV0aW9ucygpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CiAgICAgIHRoaXMuc2V0U3RhdGUoewogICAgICAgIGlzTG9hZGluZzogdHJ1ZQogICAgICB9KTsKICAgICAgdmFyIHVybCA9ICIvb3BlbmJveGVzL2FwaS9zdG9ja01vdmVtZW50cy8iLmNvbmNhdCh0aGlzLnN0YXRlLmF0dHIubGluZUl0ZW0ucmVxdWlzaXRpb25JdGVtSWQsICIvc3Vic3RpdHV0aW9uSXRlbXMiKTsKICAgICAgcmV0dXJuIGFwaUNsaWVudC5nZXQodXJsKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgICAgdmFyIHN1YnN0aXR1dGlvbnMgPSBfLm1hcChyZXNwLmRhdGEuZGF0YSwgZnVuY3Rpb24gKHZhbCkgewogICAgICAgICAgdmFyIF92YWwkcHJvZHVjdCRkaXNwbGF5TjsKICAgICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHZhbCksIHt9LCB7CiAgICAgICAgICAgIGRpc2FibGVkOiB0cnVlLAogICAgICAgICAgICBwcm9kdWN0OiB7CiAgICAgICAgICAgICAgaWQ6ICIiLmNvbmNhdCh2YWwucHJvZHVjdElkKSwKICAgICAgICAgICAgICBwcm9kdWN0Q29kZTogIiIuY29uY2F0KHZhbC5wcm9kdWN0Q29kZSksCiAgICAgICAgICAgICAgbmFtZTogIiIuY29uY2F0KHZhbC5wcm9kdWN0TmFtZSksCiAgICAgICAgICAgICAgZGlzcGxheU5hbWU6IChfdmFsJHByb2R1Y3QkZGlzcGxheU4gPSB2YWwucHJvZHVjdC5kaXNwbGF5TmFtZXMpID09PSBudWxsIHx8IF92YWwkcHJvZHVjdCRkaXNwbGF5TiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3ZhbCRwcm9kdWN0JGRpc3BsYXlOWyJkZWZhdWx0Il0sCiAgICAgICAgICAgICAgbWluRXhwaXJhdGlvbkRhdGU6ICIiLmNvbmNhdCh2YWwubWluRXhwaXJhdGlvbkRhdGUpLAogICAgICAgICAgICAgIHF1YW50aXR5QXZhaWxhYmxlOiAiIi5jb25jYXQodmFsLnF1YW50aXR5QXZhaWxhYmxlKSwKICAgICAgICAgICAgICBoYW5kbGluZ0ljb25zOiB2YWwucHJvZHVjdC5oYW5kbGluZ0ljb25zCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICAgIHZhciBvcmlnaW5hbEl0ZW0gPSBudWxsOwogICAgICAgIGlmIChfLnRvSW50ZWdlcihfdGhpczQuc3RhdGUuYXR0ci5saW5lSXRlbS5xdWFudGl0eUF2YWlsYWJsZSkgPiAwKSB7CiAgICAgICAgICB2YXIgX3Byb2R1Y3QkZGlzcGxheU5hbWVzOwogICAgICAgICAgdmFyIF90aGlzNCRzdGF0ZSRhdHRyJGxpbiA9IF90aGlzNC5zdGF0ZS5hdHRyLmxpbmVJdGVtLAogICAgICAgICAgICBwcm9kdWN0Q29kZSA9IF90aGlzNCRzdGF0ZSRhdHRyJGxpbi5wcm9kdWN0Q29kZSwKICAgICAgICAgICAgcHJvZHVjdCA9IF90aGlzNCRzdGF0ZSRhdHRyJGxpbi5wcm9kdWN0LAogICAgICAgICAgICBwcm9kdWN0TmFtZSA9IF90aGlzNCRzdGF0ZSRhdHRyJGxpbi5wcm9kdWN0TmFtZSwKICAgICAgICAgICAgbWluRXhwaXJhdGlvbkRhdGUgPSBfdGhpczQkc3RhdGUkYXR0ciRsaW4ubWluRXhwaXJhdGlvbkRhdGUsCiAgICAgICAgICAgIHF1YW50aXR5QXZhaWxhYmxlID0gX3RoaXM0JHN0YXRlJGF0dHIkbGluLnF1YW50aXR5QXZhaWxhYmxlOwogICAgICAgICAgb3JpZ2luYWxJdGVtID0gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBfdGhpczQuc3RhdGUuYXR0ci5saW5lSXRlbSksIHt9LCB7CiAgICAgICAgICAgIG9yaWdpbmFsSXRlbTogdHJ1ZSwKICAgICAgICAgICAgcHJvZHVjdDogewogICAgICAgICAgICAgIGlkOiAiIi5jb25jYXQocHJvZHVjdC5pZCksCiAgICAgICAgICAgICAgcHJvZHVjdENvZGU6ICIiLmNvbmNhdChwcm9kdWN0Q29kZSksCiAgICAgICAgICAgICAgbmFtZTogIiIuY29uY2F0KHByb2R1Y3ROYW1lKSwKICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogKF9wcm9kdWN0JGRpc3BsYXlOYW1lcyA9IHByb2R1Y3QuZGlzcGxheU5hbWVzKSA9PT0gbnVsbCB8fCBfcHJvZHVjdCRkaXNwbGF5TmFtZXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9wcm9kdWN0JGRpc3BsYXlOYW1lc1siZGVmYXVsdCJdLAogICAgICAgICAgICAgIG1pbkV4cGlyYXRpb25EYXRlOiBtaW5FeHBpcmF0aW9uRGF0ZSwKICAgICAgICAgICAgICBxdWFudGl0eUF2YWlsYWJsZTogcXVhbnRpdHlBdmFpbGFibGUKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgICBzdWJzdGl0dXRpb25zID0gW29yaWdpbmFsSXRlbV0uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShzdWJzdGl0dXRpb25zKSk7CiAgICAgICAgfQogICAgICAgIF90aGlzNC5zZXRTdGF0ZSh7CiAgICAgICAgICBpc0VtcHR5RGF0YTogIXN1YnN0aXR1dGlvbnMubGVuZ3RoLAogICAgICAgICAgZm9ybVZhbHVlczogewogICAgICAgICAgICBzdWJzdGl0dXRpb25zOiBzdWJzdGl0dXRpb25zCiAgICAgICAgICB9LAogICAgICAgICAgb3JpZ2luYWxJdGVtOiBvcmlnaW5hbEl0ZW0KICAgICAgICB9KTsKICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGVycikgewogICAgICAgIHJldHVybiBlcnI7CiAgICAgIH0pWyJmaW5hbGx5Il0oZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBfdGhpczQuc2V0U3RhdGUoewogICAgICAgICAgaXNMb2FkaW5nOiBmYWxzZQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ2YWxpZGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdmFsaWRhdGUodmFsdWVzKSB7CiAgICAgIHZhciBlcnJvcnMgPSB7fTsKICAgICAgZXJyb3JzLnN1YnN0aXR1dGlvbnMgPSBbXTsKICAgICAgdmFyIHN1YlF0eSA9IDA7CiAgICAgIF8uZm9yRWFjaCh2YWx1ZXMuc3Vic3RpdHV0aW9ucywgZnVuY3Rpb24gKGl0ZW0sIGtleSkgewogICAgICAgIGlmIChpdGVtLnF1YW50aXR5U2VsZWN0ZWQpIHsKICAgICAgICAgIHN1YlF0eSArPSBfLnRvSW50ZWdlcihpdGVtLnF1YW50aXR5U2VsZWN0ZWQpOwogICAgICAgIH0KICAgICAgICBpZiAoaXRlbS5wcm9kdWN0ICYmIGl0ZW0ucXVhbnRpdHlTZWxlY3RlZCA+IF8udG9JbnRlZ2VyKGl0ZW0ucHJvZHVjdC5xdWFudGl0eUF2YWlsYWJsZSkpIHsKICAgICAgICAgIGVycm9ycy5zdWJzdGl0dXRpb25zW2tleV0gPSB7CiAgICAgICAgICAgIHF1YW50aXR5U2VsZWN0ZWQ6ICdyZWFjdC5zdG9ja01vdmVtZW50LmVycm9ycy5oaWdoZXJRdHlTZWxlY3RlZC5sYWJlbCcKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICAgIGlmIChpdGVtLnF1YW50aXR5U2VsZWN0ZWQgPCAwKSB7CiAgICAgICAgICBlcnJvcnMuc3Vic3RpdHV0aW9uc1trZXldID0gewogICAgICAgICAgICBxdWFudGl0eVNlbGVjdGVkOiAncmVhY3Quc3RvY2tNb3ZlbWVudC5lcnJvcnMubmVnYXRpdmVRdHlTZWxlY3RlZC5sYWJlbCcKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9KTsKICAgICAgaWYgKHN1YlF0eSA8IHRoaXMuc3RhdGUuYXR0ci5saW5lSXRlbS5xdWFudGl0eVJlcXVlc3RlZCAmJiAhdmFsdWVzLnJlYXNvbkNvZGUpIHsKICAgICAgICBlcnJvcnMucmVhc29uQ29kZSA9ICdyZWFjdC5kZWZhdWx0LmVycm9yLnJlcXVpcmVkRmllbGQubGFiZWwnOwogICAgICB9CiAgICAgIHJldHVybiBlcnJvcnM7CiAgICB9CgogICAgLyoqIFN1bXMgdXAgcXVhbnRpdHkgc2VsZWN0ZWQgZnJvbSBhbGwgYXZhaWxhYmxlIHN1YnN0aXR1dGlvbnMuCiAgICAgKiBAcGFyYW0ge29iamVjdH0gdmFsdWVzCiAgICAgKiBAcHVibGljCiAgICAgKi8KCiAgICAvKiBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2xhc3MtbWV0aG9kcy11c2UtdGhpcyAqLwogIH0sIHsKICAgIGtleTogImNhbGN1bGF0ZVNlbGVjdGVkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjYWxjdWxhdGVTZWxlY3RlZCh2YWx1ZXMpIHsKICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCBudWxsLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIGNsYXNzTmFtZTogImZvbnQtd2VpZ2h0LWJvbGQgcGItMiIKICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoVHJhbnNsYXRlLCB7CiAgICAgICAgaWQ6ICJyZWFjdC5zdG9ja01vdmVtZW50LnF1YW50aXR5U2VsZWN0ZWQubGFiZWwiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiUXVhbnRpdHkgc2VsZWN0ZWQiCiAgICAgIH0pLCAiOiAiLCBfLnJlZHVjZSh2YWx1ZXMuc3Vic3RpdHV0aW9ucywgZnVuY3Rpb24gKHN1bSwgdmFsKSB7CiAgICAgICAgcmV0dXJuIHN1bSArICh2YWwucXVhbnRpdHlTZWxlY3RlZCA/IF8udG9JbnRlZ2VyKHZhbC5xdWFudGl0eVNlbGVjdGVkKSA6IDApOwogICAgICB9LCAwKSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJociIsIG51bGwpKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHsKICAgICAgdmFyIF90aGlzJHN0YXRlJGF0dHIkbGluZSwgX3RoaXMkc3RhdGUkYXR0ciRsaW5lMiwgX3RoaXMkc3RhdGUkYXR0ciRsaW5lMzsKICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KE1vZGFsV3JhcHBlciwgX2V4dGVuZHMoe30sIHRoaXMuc3RhdGUuYXR0ciwgewogICAgICAgIG9uT3BlbjogdGhpcy5vbk9wZW4sCiAgICAgICAgb25TYXZlOiB0aGlzLm9uU2F2ZSwKICAgICAgICBmaWVsZHM6IEZJRUxEUywKICAgICAgICB2YWxpZGF0ZTogdGhpcy52YWxpZGF0ZSwKICAgICAgICBpbml0aWFsVmFsdWVzOiB0aGlzLnN0YXRlLmZvcm1WYWx1ZXMsCiAgICAgICAgZm9ybVByb3BzOiB7CiAgICAgICAgICBpc0VtcHR5RGF0YTogdGhpcy5zdGF0ZS5pc0VtcHR5RGF0YSwKICAgICAgICAgIGlzTG9hZGluZzogdGhpcy5zdGF0ZS5pc0xvYWRpbmcsCiAgICAgICAgICBlbXB0eURhdGFNZXNzYWdlSWQ6ICdyZWFjdC5zdG9ja01vdmVtZW50Lm5vU3Vic3RpdHV0aW9uc0F2YWlsYWJsZS5tZXNzYWdlJywKICAgICAgICAgIGRlZmF1bHRFbXB0eURhdGFNZXNzYWdlOiAnVGhlcmUgYXJlIG5vIHN1YnN0aXR1dGlvbnMgYXZhaWxhYmxlJywKICAgICAgICAgIHJlYXNvbkNvZGVzOiB0aGlzLnN0YXRlLmF0dHIucmVhc29uQ29kZXMsCiAgICAgICAgICBvcmlnaW5hbEl0ZW06IHRoaXMuc3RhdGUub3JpZ2luYWxJdGVtLAogICAgICAgICAgZGVib3VuY2VkQXZhaWxhYmxlSXRlbXNGZXRjaDogdGhpcy5kZWJvdW5jZWRBdmFpbGFibGVJdGVtc0ZldGNoCiAgICAgICAgfSwKICAgICAgICByZW5kZXJCb2R5V2l0aFZhbHVlczogdGhpcy5jYWxjdWxhdGVTZWxlY3RlZAogICAgICB9KSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgY2xhc3NOYW1lOiAiZm9udC13ZWlnaHQtYm9sZCIKICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoVHJhbnNsYXRlLCB7CiAgICAgICAgaWQ6ICJyZWFjdC5zdG9ja01vdmVtZW50LnByb2R1Y3RDb2RlLmxhYmVsIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlByb2R1Y3QgY29kZSIKICAgICAgfSksICI6ICIsIHRoaXMuc3RhdGUuYXR0ci5saW5lSXRlbS5wcm9kdWN0Q29kZSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgY2xhc3NOYW1lOiAiZm9udC13ZWlnaHQtYm9sZCIKICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoVG9vbHRpcCwgewogICAgICAgIGh0bWw6IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgICBjbGFzc05hbWU6ICJ0ZXh0LXRydW5jYXRlIgogICAgICAgIH0sIHRoaXMuc3RhdGUuYXR0ci5saW5lSXRlbS5wcm9kdWN0Lm5hbWUpLAogICAgICAgIHRoZW1lOiAiZGFyayIsCiAgICAgICAgZGlzYWJsZWQ6ICEoKF90aGlzJHN0YXRlJGF0dHIkbGluZSA9IHRoaXMuc3RhdGUuYXR0ci5saW5lSXRlbS5wcm9kdWN0LmRpc3BsYXlOYW1lcykgIT09IG51bGwgJiYgX3RoaXMkc3RhdGUkYXR0ciRsaW5lICE9PSB2b2lkIDAgJiYgX3RoaXMkc3RhdGUkYXR0ciRsaW5lWyJkZWZhdWx0Il0pLAogICAgICAgIHBvc2l0aW9uOiAidG9wLXN0YXJ0IgogICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUcmFuc2xhdGUsIHsKICAgICAgICBpZDogInJlYWN0LnN0b2NrTW92ZW1lbnQucHJvZHVjdE5hbWUubGFiZWwiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiUHJvZHVjdCBuYW1lIgogICAgICB9KSwgIjogIiwgKF90aGlzJHN0YXRlJGF0dHIkbGluZTIgPSAoX3RoaXMkc3RhdGUkYXR0ciRsaW5lMyA9IHRoaXMuc3RhdGUuYXR0ci5saW5lSXRlbS5wcm9kdWN0LmRpc3BsYXlOYW1lcykgPT09IG51bGwgfHwgX3RoaXMkc3RhdGUkYXR0ciRsaW5lMyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkc3RhdGUkYXR0ciRsaW5lM1siZGVmYXVsdCJdKSAhPT0gbnVsbCAmJiBfdGhpcyRzdGF0ZSRhdHRyJGxpbmUyICE9PSB2b2lkIDAgPyBfdGhpcyRzdGF0ZSRhdHRyJGxpbmUyIDogdGhpcy5zdGF0ZS5hdHRyLmxpbmVJdGVtLnByb2R1Y3QubmFtZSkpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIGNsYXNzTmFtZTogImZvbnQtd2VpZ2h0LWJvbGQiCiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyYW5zbGF0ZSwgewogICAgICAgIGlkOiAicmVhY3Quc3RvY2tNb3ZlbWVudC5xdWFudGl0eVJlcXVlc3RlZC5sYWJlbCIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJRdHkgUmVxdWVzdGVkIgogICAgICB9KSwgIjogIiwgdGhpcy5zdGF0ZS5hdHRyLmxpbmVJdGVtLnF1YW50aXR5UmVxdWVzdGVkKSkpOwogICAgfQogIH1dKTsKICByZXR1cm4gU3Vic3RpdHV0aW9uc01vZGFsOwp9KENvbXBvbmVudCk7CnZhciBtYXBTdGF0ZVRvUHJvcHMgPSBmdW5jdGlvbiBtYXBTdGF0ZVRvUHJvcHMoc3RhdGUpIHsKICByZXR1cm4gewogICAgZGVib3VuY2VUaW1lOiBzdGF0ZS5zZXNzaW9uLnNlYXJjaENvbmZpZy5kZWJvdW5jZVRpbWUsCiAgICBtaW5TZWFyY2hMZW5ndGg6IHN0YXRlLnNlc3Npb24uc2VhcmNoQ29uZmlnLm1pblNlYXJjaExlbmd0aAogIH07Cn07CmV4cG9ydCBkZWZhdWx0IGNvbm5lY3QobWFwU3RhdGVUb1Byb3BzLCB7CiAgc2hvd1NwaW5uZXI6IHNob3dTcGlubmVyLAogIGhpZGVTcGlubmVyOiBoaWRlU3Bpbm5lcgp9KShTdWJzdGl0dXRpb25zTW9kYWwpOwpTdWJzdGl0dXRpb25zTW9kYWwucHJvcFR5cGVzID0gewogIC8qKiBOYW1lIG9mIHRoZSBmaWVsZCAqLwogIGZpZWxkTmFtZTogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLAogIC8qKiBDb25maWd1cmF0aW9uIG9mIHRoZSBmaWVsZCAqLwogIGZpZWxkQ29uZmlnOiBQcm9wVHlwZXMuc2hhcGUoewogICAgZ2V0RHluYW1pY0F0dHI6IFByb3BUeXBlcy5mdW5jCiAgfSkuaXNSZXF1aXJlZCwKICAvKiogU3RvY2sgbW92ZW1lbnQncyBJRCAqLwogIHN0b2NrTW92ZW1lbnRJZDogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLAogIC8qKiBGdW5jdGlvbiBjYWxsZWQgd2hlbiBkYXRhIGlzIGxvYWRpbmcgKi8KICBzaG93U3Bpbm5lcjogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCwKICAvKiogRnVuY3Rpb24gY2FsbGVkIHdoZW4gZGF0YSBoYXMgbG9hZGVkICovCiAgaGlkZVNwaW5uZXI6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsCiAgLyoqIEZ1bmN0aW9uIHVwZGF0aW5nIHBhZ2Ugb24gd2hpY2ggbW9kYWwgaXMgbG9jYXRlZCBjYWxsZWQgd2hlbiB1c2VyIHNhdmVzIGNoYW5nZXMgKi8KICBvblJlc3BvbnNlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLAogIGRlYm91bmNlVGltZTogUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkLAogIG1pblNlYXJjaExlbmd0aDogUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkCn07"},null]}