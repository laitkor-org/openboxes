{"remainingRequest":"/opt/MTOBS-BIKASH/node_modules/babel-loader/lib/index.js?presets[]=@babel/react&presets[]=@babel/env!/opt/MTOBS-BIKASH/node_modules/eslint-loader/dist/cjs.js!/opt/MTOBS-BIKASH/src/js/components/stock-movement-wizard/modals/CombinedShipmentItemsModal.jsx","dependencies":[{"path":"/opt/MTOBS-BIKASH/src/js/components/stock-movement-wizard/modals/CombinedShipmentItemsModal.jsx","mtime":1698037750000},{"path":"/opt/MTOBS-BIKASH/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/opt/MTOBS-BIKASH/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/opt/MTOBS-BIKASH/node_modules/eslint-loader/dist/cjs.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsgcmV0dXJuIF90eXBlb2YgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgInN5bWJvbCIgPT0gdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfSwgX3R5cGVvZihvYmopOyB9CmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBlbnVtZXJhYmxlT25seSAmJiAoc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7IH0pKSwga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBudWxsICE9IGFyZ3VtZW50c1tpXSA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpICUgMiA/IG93bktleXMoT2JqZWN0KHNvdXJjZSksICEwKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7IH0pIDogT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpIDogb3duS2V5cyhPYmplY3Qoc291cmNlKSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSByZXR1cm4gdGFyZ2V0OyB9CmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsga2V5ID0gX3RvUHJvcGVydHlLZXkoa2V5KTsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9CmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBfdG9Qcm9wZXJ0eUtleShkZXNjcmlwdG9yLmtleSksIGRlc2NyaXB0b3IpOyB9IH0KZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29uc3RydWN0b3IsICJwcm90b3R5cGUiLCB7IHdyaXRhYmxlOiBmYWxzZSB9KTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9CmZ1bmN0aW9uIF90b1Byb3BlcnR5S2V5KGFyZykgeyB2YXIga2V5ID0gX3RvUHJpbWl0aXZlKGFyZywgInN0cmluZyIpOyByZXR1cm4gX3R5cGVvZihrZXkpID09PSAic3ltYm9sIiA/IGtleSA6IFN0cmluZyhrZXkpOyB9CmZ1bmN0aW9uIF90b1ByaW1pdGl2ZShpbnB1dCwgaGludCkgeyBpZiAoX3R5cGVvZihpbnB1dCkgIT09ICJvYmplY3QiIHx8IGlucHV0ID09PSBudWxsKSByZXR1cm4gaW5wdXQ7IHZhciBwcmltID0gaW5wdXRbU3ltYm9sLnRvUHJpbWl0aXZlXTsgaWYgKHByaW0gIT09IHVuZGVmaW5lZCkgeyB2YXIgcmVzID0gcHJpbS5jYWxsKGlucHV0LCBoaW50IHx8ICJkZWZhdWx0Iik7IGlmIChfdHlwZW9mKHJlcykgIT09ICJvYmplY3QiKSByZXR1cm4gcmVzOyB0aHJvdyBuZXcgVHlwZUVycm9yKCJAQHRvUHJpbWl0aXZlIG11c3QgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlLiIpOyB9IHJldHVybiAoaGludCA9PT0gInN0cmluZyIgPyBTdHJpbmcgOiBOdW1iZXIpKGlucHV0KTsgfQpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzdWJDbGFzcywgInByb3RvdHlwZSIsIHsgd3JpdGFibGU6IGZhbHNlIH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfQpmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2YuYmluZCgpIDogZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfQpmdW5jdGlvbiBfY3JlYXRlU3VwZXIoRGVyaXZlZCkgeyB2YXIgaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCA9IF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKTsgcmV0dXJuIGZ1bmN0aW9uIF9jcmVhdGVTdXBlckludGVybmFsKCkgeyB2YXIgU3VwZXIgPSBfZ2V0UHJvdG90eXBlT2YoRGVyaXZlZCksIHJlc3VsdDsgaWYgKGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QpIHsgdmFyIE5ld1RhcmdldCA9IF9nZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3RvcjsgcmVzdWx0ID0gUmVmbGVjdC5jb25zdHJ1Y3QoU3VwZXIsIGFyZ3VtZW50cywgTmV3VGFyZ2V0KTsgfSBlbHNlIHsgcmVzdWx0ID0gU3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfSByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgcmVzdWx0KTsgfTsgfQpmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikpIHsgcmV0dXJuIGNhbGw7IH0gZWxzZSBpZiAoY2FsbCAhPT0gdm9pZCAwKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkRlcml2ZWQgY29uc3RydWN0b3JzIG1heSBvbmx5IHJldHVybiBvYmplY3Qgb3IgdW5kZWZpbmVkIik7IH0gcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7IH0KZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7IGlmIChzZWxmID09PSB2b2lkIDApIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsgfSByZXR1cm4gc2VsZjsgfQpmdW5jdGlvbiBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCkgeyBpZiAodHlwZW9mIFJlZmxlY3QgPT09ICJ1bmRlZmluZWQiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlOyBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlOyBpZiAodHlwZW9mIFByb3h5ID09PSAiZnVuY3Rpb24iKSByZXR1cm4gdHJ1ZTsgdHJ5IHsgQm9vbGVhbi5wcm90b3R5cGUudmFsdWVPZi5jYWxsKFJlZmxlY3QuY29uc3RydWN0KEJvb2xlYW4sIFtdLCBmdW5jdGlvbiAoKSB7fSkpOyByZXR1cm4gdHJ1ZTsgfSBjYXRjaCAoZSkgeyByZXR1cm4gZmFsc2U7IH0gfQpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YuYmluZCgpIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfQppbXBvcnQgUmVhY3QsIHsgQ29tcG9uZW50IH0gZnJvbSAncmVhY3QnOwppbXBvcnQgdXBkYXRlIGZyb20gJ2ltbXV0YWJpbGl0eS1oZWxwZXInOwppbXBvcnQgXyBmcm9tICdsb2Rhc2gnOwppbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnOwppbXBvcnQgeyBnZXRUcmFuc2xhdGUgfSBmcm9tICdyZWFjdC1sb2NhbGl6ZS1yZWR1eCc7CmltcG9ydCB7IGNvbm5lY3QgfSBmcm9tICdyZWFjdC1yZWR1eCc7CmltcG9ydCB7IGhpZGVTcGlubmVyLCBzaG93U3Bpbm5lciB9IGZyb20gJ2FjdGlvbnMnOwppbXBvcnQgQXJyYXlGaWVsZCBmcm9tICdjb21wb25lbnRzL2Zvcm0tZWxlbWVudHMvQXJyYXlGaWVsZCc7CmltcG9ydCBMYWJlbEZpZWxkIGZyb20gJ2NvbXBvbmVudHMvZm9ybS1lbGVtZW50cy9MYWJlbEZpZWxkJzsKaW1wb3J0IE1vZGFsV3JhcHBlciBmcm9tICdjb21wb25lbnRzL2Zvcm0tZWxlbWVudHMvTW9kYWxXcmFwcGVyJzsKaW1wb3J0IFRleHRGaWVsZCBmcm9tICdjb21wb25lbnRzL2Zvcm0tZWxlbWVudHMvVGV4dEZpZWxkJzsKaW1wb3J0IFByb2R1Y3RTZWxlY3QgZnJvbSAnY29tcG9uZW50cy9wcm9kdWN0LXNlbGVjdC9Qcm9kdWN0U2VsZWN0JzsKaW1wb3J0IGFwaUNsaWVudCBmcm9tICd1dGlscy9hcGlDbGllbnQnOwppbXBvcnQgQ2hlY2tib3ggZnJvbSAndXRpbHMvQ2hlY2tib3gnOwppbXBvcnQgeyBkZWJvdW5jZVByb2R1Y3RzSW5PcmRlcnMgfSBmcm9tICd1dGlscy9vcHRpb24tdXRpbHMnOwppbXBvcnQgU2VsZWN0IGZyb20gJ3V0aWxzL1NlbGVjdCc7CmltcG9ydCB7IHRyYW5zbGF0ZVdpdGhEZWZhdWx0TWVzc2FnZSB9IGZyb20gJ3V0aWxzL1RyYW5zbGF0ZSc7CnZhciBGSUVMRFMgPSB7CiAgb3JkZXJJdGVtczogewogICAgdHlwZTogQXJyYXlGaWVsZCwKICAgIGFycm93c05hdmlnYXRpb246IHRydWUsCiAgICBtYXhUYWJsZUhlaWdodDogJ2NhbGMoMTAwdmggLSA1MDBweCknLAogICAgZmllbGRzOiB7CiAgICAgIGNoZWNrZWQ6IHsKICAgICAgICBmaWVsZEtleTogJycsCiAgICAgICAgbGFiZWw6ICdyZWFjdC5zdG9ja01vdmVtZW50LnNlbGVjdEFsbC5sYWJlbCcsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdTZWxlY3QgQWxsJywKICAgICAgICBmbGV4V2lkdGg6ICcwLjQnLAogICAgICAgIGhlYWRlckFsaWduOiAncmlnaHQnLAogICAgICAgIGdldER5bmFtaWNBdHRyOiBmdW5jdGlvbiBnZXREeW5hbWljQXR0cihfcmVmKSB7CiAgICAgICAgICB2YXIgc2VsZWN0QWxsSXRlbXMgPSBfcmVmLnNlbGVjdEFsbEl0ZW1zLAogICAgICAgICAgICBhbGxJdGVtc1NlbGVjdGVkID0gX3JlZi5hbGxJdGVtc1NlbGVjdGVkOwogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgaGVhZGVySHRtbDogZnVuY3Rpb24gaGVhZGVySHRtbCgpIHsKICAgICAgICAgICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImlucHV0IiwgewogICAgICAgICAgICAgICAgdHlwZTogImNoZWNrYm94IiwKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogIm10LTEiLAogICAgICAgICAgICAgICAgY2hlY2tlZDogYWxsSXRlbXNTZWxlY3RlZCwKICAgICAgICAgICAgICAgIG9uQ2xpY2s6IHNlbGVjdEFsbEl0ZW1zCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAgICAgfSwKICAgICAgICB0eXBlOiBmdW5jdGlvbiB0eXBlKF9yZWYyKSB7CiAgICAgICAgICB2YXIgcm93SW5kZXggPSBfcmVmMi5yb3dJbmRleCwKICAgICAgICAgICAgZmllbGRWYWx1ZSA9IF9yZWYyLmZpZWxkVmFsdWUsCiAgICAgICAgICAgIHNlbGVjdFJvdyA9IF9yZWYyLnNlbGVjdFJvdzsKICAgICAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDaGVja2JveCwgewogICAgICAgICAgICBpZDogcm93SW5kZXgudG9TdHJpbmcoKSwKICAgICAgICAgICAgZGlzYWJsZWQ6IGZhbHNlLAogICAgICAgICAgICBzdHlsZTogewogICAgICAgICAgICAgIG1hcmdpbkxlZnQ6ICcxLjFyZW0nCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHZhbHVlOiBmaWVsZFZhbHVlLmNoZWNrZWQsCiAgICAgICAgICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZSh2YWx1ZSkgewogICAgICAgICAgICAgIHJldHVybiBzZWxlY3RSb3codmFsdWUsIHJvd0luZGV4KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBvcmRlck51bWJlcjogewogICAgICAgIHR5cGU6IExhYmVsRmllbGQsCiAgICAgICAgbGFiZWw6ICdyZWFjdC5zdG9ja01vdmVtZW50Lm9yZGVyTnVtYmVyLmxhYmVsJywKICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1BPIE51bWJlcicsCiAgICAgICAgZmxleFdpZHRoOiAnMScsCiAgICAgICAgZmllbGRLZXk6ICcnLAogICAgICAgIGdldER5bmFtaWNBdHRyOiBmdW5jdGlvbiBnZXREeW5hbWljQXR0cihfcmVmMykgewogICAgICAgICAgdmFyIGZpZWxkVmFsdWUgPSBfcmVmMy5maWVsZFZhbHVlOwogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgdXJsOiBmaWVsZFZhbHVlICYmIGZpZWxkVmFsdWUub3JkZXJJZCA/ICIvb3BlbmJveGVzL29yZGVyL3Nob3cvIi5jb25jYXQoZmllbGRWYWx1ZS5vcmRlcklkKSA6ICcnCiAgICAgICAgICB9OwogICAgICAgIH0sCiAgICAgICAgYXR0cmlidXRlczogewogICAgICAgICAgZm9ybWF0VmFsdWU6IGZ1bmN0aW9uIGZvcm1hdFZhbHVlKGZpZWxkVmFsdWUpIHsKICAgICAgICAgICAgcmV0dXJuIGZpZWxkVmFsdWUgJiYgZmllbGRWYWx1ZS5vcmRlck51bWJlcjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIHByb2R1Y3RDb2RlOiB7CiAgICAgICAgdHlwZTogTGFiZWxGaWVsZCwKICAgICAgICBsYWJlbDogJ3JlYWN0LnN0b2NrTW92ZW1lbnQucHJvZHVjdENvZGUubGFiZWwnLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnUHJvZHVjdCBDb2RlJywKICAgICAgICBmbGV4V2lkdGg6ICcxJwogICAgICB9LAogICAgICBwcm9kdWN0TmFtZTogewogICAgICAgIHR5cGU6IExhYmVsRmllbGQsCiAgICAgICAgbGFiZWw6ICdyZWFjdC5zdG9ja01vdmVtZW50LnByb2R1Y3ROYW1lLmxhYmVsJywKICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1Byb2R1Y3QgbmFtZScsCiAgICAgICAgZmxleFdpZHRoOiAnMycsCiAgICAgICAgYXR0cmlidXRlczogewogICAgICAgICAgY2xhc3NOYW1lOiAndGV4dC1sZWZ0IG1sLTEnCiAgICAgICAgfSwKICAgICAgICBnZXREeW5hbWljQXR0cjogZnVuY3Rpb24gZ2V0RHluYW1pY0F0dHIoX3JlZjQpIHsKICAgICAgICAgIHZhciB2YWx1ZXMgPSBfcmVmNC52YWx1ZXMsCiAgICAgICAgICAgIHJvd0luZGV4ID0gX3JlZjQucm93SW5kZXg7CiAgICAgICAgICB2YXIgb3JkZXJJdGVtID0gdmFsdWVzLm9yZGVySXRlbXNbcm93SW5kZXhdOwogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgY29sb3I6IG9yZGVySXRlbSA9PT0gbnVsbCB8fCBvcmRlckl0ZW0gPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9yZGVySXRlbS5jb2xvciwKICAgICAgICAgICAgc2hvd1ZhbHVlVG9vbHRpcDogdHJ1ZSwKICAgICAgICAgICAgdG9vbHRpcFZhbHVlOiBvcmRlckl0ZW0gPT09IG51bGwgfHwgb3JkZXJJdGVtID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcmRlckl0ZW0ucHJvZHVjdE5hbWUsCiAgICAgICAgICAgIGZvcm1hdFZhbHVlOiBmdW5jdGlvbiBmb3JtYXRWYWx1ZSgpIHsKICAgICAgICAgICAgICByZXR1cm4gKG9yZGVySXRlbSA9PT0gbnVsbCB8fCBvcmRlckl0ZW0gPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9yZGVySXRlbS5kaXNwbGF5TmFtZSkgfHwgKG9yZGVySXRlbSA9PT0gbnVsbCB8fCBvcmRlckl0ZW0gPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9yZGVySXRlbS5wcm9kdWN0TmFtZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9LAogICAgICBzdXBwbGllckNvZGU6IHsKICAgICAgICB0eXBlOiBMYWJlbEZpZWxkLAogICAgICAgIGxhYmVsOiAncmVhY3Quc3RvY2tNb3ZlbWVudC5zdXBwbGllckNvZGUubGFiZWwnLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnU3VwcGxpZXIgY29kZScsCiAgICAgICAgZmxleFdpZHRoOiAnMScKICAgICAgfSwKICAgICAgYnVkZ2V0Q29kZTogewogICAgICAgIHR5cGU6IExhYmVsRmllbGQsCiAgICAgICAgbGFiZWw6ICdyZWFjdC5zdG9ja01vdmVtZW50LmJ1ZGdldENvZGUubGFiZWwnLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQnVkZ2V0IENvZGUnLAogICAgICAgIGZsZXhXaWR0aDogJzEnCiAgICAgIH0sCiAgICAgIHJlY2lwaWVudDogewogICAgICAgIHR5cGU6IExhYmVsRmllbGQsCiAgICAgICAgbGFiZWw6ICdyZWFjdC5zdG9ja01vdmVtZW50LnJlY2lwaWVudC5sYWJlbCcsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdSZWNpcGllbnQnLAogICAgICAgIGZsZXhXaWR0aDogJzEuNScsCiAgICAgICAgYXR0cmlidXRlczogewogICAgICAgICAgc2hvd1ZhbHVlVG9vbHRpcDogdHJ1ZQogICAgICAgIH0KICAgICAgfSwKICAgICAgcXVhbnRpdHlBdmFpbGFibGU6IHsKICAgICAgICB0eXBlOiBMYWJlbEZpZWxkLAogICAgICAgIGxhYmVsOiAncmVhY3Quc3RvY2tNb3ZlbWVudC5xdWFudGl0eUF2YWlsYWJsZS5sYWJlbCcsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdRdWFudGl0eSBBdmFpbGFibGUnLAogICAgICAgIGZsZXhXaWR0aDogJzEnCiAgICAgIH0sCiAgICAgIHF1YW50aXR5VG9TaGlwOiB7CiAgICAgICAgdHlwZTogVGV4dEZpZWxkLAogICAgICAgIGxhYmVsOiAncmVhY3Quc3RvY2tNb3ZlbWVudC5xdWFudGl0eVRvU2hpcC5sYWJlbCcsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdRdWFudGl0eSB0byBTaGlwJywKICAgICAgICBmbGV4V2lkdGg6ICcxJywKICAgICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgICB0eXBlOiAnbnVtYmVyJwogICAgICAgIH0sCiAgICAgICAgZ2V0RHluYW1pY0F0dHI6IGZ1bmN0aW9uIGdldER5bmFtaWNBdHRyKF9yZWY1KSB7CiAgICAgICAgICB2YXIgdXBkYXRlUm93ID0gX3JlZjUudXBkYXRlUm93LAogICAgICAgICAgICB2YWx1ZXMgPSBfcmVmNS52YWx1ZXMsCiAgICAgICAgICAgIHJvd0luZGV4ID0gX3JlZjUucm93SW5kZXg7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBvbkNoYW5nZTogZnVuY3Rpb24gb25DaGFuZ2UoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZVJvdyh2YWx1ZXMsIHJvd0luZGV4KTsKICAgICAgICAgICAgfQogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHVvbTogewogICAgICAgIHR5cGU6IExhYmVsRmllbGQsCiAgICAgICAgbGFiZWw6ICdyZWFjdC5zdG9ja01vdmVtZW50LnVvbS5sYWJlbCcsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdVb00nLAogICAgICAgIGZsZXhXaWR0aDogJzEnCiAgICAgIH0KICAgIH0KICB9Cn07CmZ1bmN0aW9uIHZhbGlkYXRlKHZhbHVlcykgewogIHZhciBlcnJvcnMgPSB7fTsKICBlcnJvcnMub3JkZXJJdGVtcyA9IFtdOwogIF8uZm9yRWFjaCh2YWx1ZXMub3JkZXJJdGVtcywgZnVuY3Rpb24gKGl0ZW0sIGtleSkgewogICAgaWYgKGl0ZW0uY2hlY2tlZCAmJiAoXy50b0ludGVnZXIoaXRlbS5xdWFudGl0eVRvU2hpcCkgPiBpdGVtLnF1YW50aXR5QXZhaWxhYmxlIHx8IF8udG9JbnRlZ2VyKGl0ZW0ucXVhbnRpdHlUb1NoaXApIDwgMCkpIHsKICAgICAgZXJyb3JzLm9yZGVySXRlbXNba2V5XSA9IHsKICAgICAgICBxdWFudGl0eVRvU2hpcDogJ3JlYWN0LmNvbWJpbmVkU2hpcG1lbnRzLmVycm9ycy5xdWFudGl0eVRvU2hpcC5sYWJlbCcKICAgICAgfTsKICAgIH0KICB9KTsKICByZXR1cm4gZXJyb3JzOwp9CnZhciBJTklUSUFMX1NUQVRFID0gewogIG9yZGVyTnVtYmVyT3B0aW9uczogW10sCiAgc2VsZWN0ZWRPcmRlcnM6IFtdLAogIHNlbGVjdGVkUHJvZHVjdElkOiAnJywKICBzZWxlY3RlZE9yZGVySXRlbXM6IFtdLAogIGZvcm1WYWx1ZXM6IHsKICAgIG9yZGVySXRlbXM6IFtdCiAgfSwKICBzb3J0T3JkZXI6IDAKfTsKdmFyIENvbWJpbmVkU2hpcG1lbnRJdGVtc01vZGFsID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29tcG9uZW50KSB7CiAgX2luaGVyaXRzKENvbWJpbmVkU2hpcG1lbnRJdGVtc01vZGFsLCBfQ29tcG9uZW50KTsKICB2YXIgX3N1cGVyID0gX2NyZWF0ZVN1cGVyKENvbWJpbmVkU2hpcG1lbnRJdGVtc01vZGFsKTsKICBmdW5jdGlvbiBDb21iaW5lZFNoaXBtZW50SXRlbXNNb2RhbChwcm9wcykgewogICAgdmFyIF90aGlzOwogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENvbWJpbmVkU2hpcG1lbnRJdGVtc01vZGFsKTsKICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpOwogICAgX3RoaXMuc3RhdGUgPSBJTklUSUFMX1NUQVRFOwogICAgX3RoaXMub25PcGVuID0gX3RoaXMub25PcGVuLmJpbmQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcykpOwogICAgX3RoaXMub25TYXZlID0gX3RoaXMub25TYXZlLmJpbmQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcykpOwogICAgX3RoaXMuc2VsZWN0Um93ID0gX3RoaXMuc2VsZWN0Um93LmJpbmQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcykpOwogICAgX3RoaXMudXBkYXRlUm93ID0gX3RoaXMudXBkYXRlUm93LmJpbmQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcykpOwogICAgX3RoaXMuc2VsZWN0QWxsSXRlbXMgPSBfdGhpcy5zZWxlY3RBbGxJdGVtcy5iaW5kKF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpKTsKICAgIF90aGlzLmFsbEl0ZW1zU2VsZWN0ZWQgPSBfdGhpcy5hbGxJdGVtc1NlbGVjdGVkLmJpbmQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcykpOwogICAgX3RoaXMuZGVib3VuY2VQcm9kdWN0c0luT3JkZXJzID0gZGVib3VuY2VQcm9kdWN0c0luT3JkZXJzKF90aGlzLnByb3BzLmRlYm91bmNlVGltZSwgX3RoaXMucHJvcHMubWluU2VhcmNoTGVuZ3RoLCBfdGhpcy5wcm9wcy52ZW5kb3IsIF90aGlzLnByb3BzLmRlc3RpbmF0aW9uKTsKICAgIHJldHVybiBfdGhpczsKICB9CiAgX2NyZWF0ZUNsYXNzKENvbWJpbmVkU2hpcG1lbnRJdGVtc01vZGFsLCBbewogICAga2V5OiAib25PcGVuIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvbk9wZW4oKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwogICAgICB0aGlzLnByb3BzLm9uT3BlbigpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzMi5zZXRTdGF0ZShJTklUSUFMX1NUQVRFLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpczIuZ2V0T3JkZXJOdW1iZXJPcHRpb25zKCk7CiAgICAgICAgICBfdGhpczIuZmV0Y2hPcmRlckl0ZW1zKCk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uU2F2ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25TYXZlKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKICAgICAgdGhpcy5wcm9wcy5zaG93U3Bpbm5lcigpOwogICAgICB2YXIgc2hpcG1lbnQgPSB0aGlzLnByb3BzLnNoaXBtZW50OwogICAgICB2YXIgc2VsZWN0ZWRPcmRlckl0ZW1zID0gdGhpcy5zdGF0ZS5zZWxlY3RlZE9yZGVySXRlbXM7CiAgICAgIHZhciBwYXlsb2FkID0gewogICAgICAgIGl0ZW1zVG9BZGQ6IF8ubWFwKHNlbGVjdGVkT3JkZXJJdGVtcywgZnVuY3Rpb24gKGl0ZW0sIGtleSkgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgb3JkZXJJdGVtSWQ6IGtleSwKICAgICAgICAgICAgcXVhbnRpdHlUb1NoaXA6IF8udG9JbnRlZ2VyKGl0ZW0ucXVhbnRpdHlUb1NoaXApLAogICAgICAgICAgICBzb3J0T3JkZXI6IF8udG9JbnRlZ2VyKGl0ZW0uc29ydE9yZGVyKQogICAgICAgICAgfTsKICAgICAgICB9KQogICAgICB9OwogICAgICB2YXIgdXJsID0gIi9vcGVuYm94ZXMvYXBpL2NvbWJpbmVkU2hpcG1lbnRJdGVtcy9hZGRUb1NoaXBtZW50LyIuY29uY2F0KHNoaXBtZW50KTsKICAgICAgYXBpQ2xpZW50LnBvc3QodXJsLCBwYXlsb2FkKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczMuc2V0U3RhdGUoSU5JVElBTF9TVEFURSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXMzLnByb3BzLmhpZGVTcGlubmVyKCk7CiAgICAgICAgICBfdGhpczMucHJvcHMub25SZXNwb25zZSgpOwogICAgICAgIH0pOwogICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMy5wcm9wcy5oaWRlU3Bpbm5lcigpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRTb3J0T3JkZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFNvcnRPcmRlcigpIHsKICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgc29ydE9yZGVyOiB0aGlzLnN0YXRlLnNvcnRPcmRlciArIDEKICAgICAgfSk7CiAgICAgIHJldHVybiB0aGlzLnN0YXRlLnNvcnRPcmRlcjsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRPcmRlck51bWJlck9wdGlvbnMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldE9yZGVyTnVtYmVyT3B0aW9ucygpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CiAgICAgIHZhciBfdGhpcyRwcm9wcyA9IHRoaXMucHJvcHMsCiAgICAgICAgdmVuZG9yID0gX3RoaXMkcHJvcHMudmVuZG9yLAogICAgICAgIGRlc3RpbmF0aW9uID0gX3RoaXMkcHJvcHMuZGVzdGluYXRpb247CiAgICAgIHZhciB1cmwgPSAiL29wZW5ib3hlcy9hcGkvb3JkZXJOdW1iZXJPcHRpb25zP3ZlbmRvcj0iLmNvbmNhdCh2ZW5kb3IsICImZGVzdGluYXRpb249IikuY29uY2F0KGRlc3RpbmF0aW9uKTsKICAgICAgYXBpQ2xpZW50LmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICByZXR1cm4gX3RoaXM0LnNldFN0YXRlKHsKICAgICAgICAgIG9yZGVyTnVtYmVyT3B0aW9uczogcmVzcC5kYXRhLmRhdGEKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0U2VsZWN0ZWRPcmRlcnMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldFNlbGVjdGVkT3JkZXJzKHNlbGVjdGVkT3JkZXJzKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwogICAgICB0aGlzLnNldFN0YXRlKHsKICAgICAgICBzZWxlY3RlZE9yZGVyczogc2VsZWN0ZWRPcmRlcnMKICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBfdGhpczUuZmV0Y2hPcmRlckl0ZW1zKCk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInNldFNlbGVjdGVkUHJvZHVjdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0U2VsZWN0ZWRQcm9kdWN0KHNlbGVjdGVkUHJvZHVjdCkgewogICAgICB2YXIgX3RoaXM2ID0gdGhpczsKICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgc2VsZWN0ZWRQcm9kdWN0SWQ6IHNlbGVjdGVkUHJvZHVjdCA/IHNlbGVjdGVkUHJvZHVjdC5pZCA6ICcnCiAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gX3RoaXM2LmZldGNoT3JkZXJJdGVtcygpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJmZXRjaE9yZGVySXRlbXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZldGNoT3JkZXJJdGVtcygpIHsKICAgICAgdmFyIF90aGlzNyA9IHRoaXM7CiAgICAgIHZhciBfdGhpcyRzdGF0ZSA9IHRoaXMuc3RhdGUsCiAgICAgICAgc2VsZWN0ZWRPcmRlcnMgPSBfdGhpcyRzdGF0ZS5zZWxlY3RlZE9yZGVycywKICAgICAgICBzZWxlY3RlZFByb2R1Y3RJZCA9IF90aGlzJHN0YXRlLnNlbGVjdGVkUHJvZHVjdElkLAogICAgICAgIHNlbGVjdGVkT3JkZXJJdGVtcyA9IF90aGlzJHN0YXRlLnNlbGVjdGVkT3JkZXJJdGVtczsKICAgICAgdmFyIF90aGlzJHByb3BzMiA9IHRoaXMucHJvcHMsCiAgICAgICAgdmVuZG9yID0gX3RoaXMkcHJvcHMyLnZlbmRvciwKICAgICAgICBkZXN0aW5hdGlvbiA9IF90aGlzJHByb3BzMi5kZXN0aW5hdGlvbjsKICAgICAgdmFyIHVybCA9ICcvb3BlbmJveGVzL2FwaS9jb21iaW5lZFNoaXBtZW50SXRlbXMvZmluZE9yZGVySXRlbXMnOwogICAgICB2YXIgcGF5bG9hZCA9IHsKICAgICAgICBvcmRlcklkczogXy5tYXAoc2VsZWN0ZWRPcmRlcnMsIGZ1bmN0aW9uIChvKSB7CiAgICAgICAgICByZXR1cm4gby5pZDsKICAgICAgICB9KSwKICAgICAgICBwcm9kdWN0SWQ6IHNlbGVjdGVkUHJvZHVjdElkLAogICAgICAgIHZlbmRvcjogdmVuZG9yLAogICAgICAgIGRlc3RpbmF0aW9uOiBkZXN0aW5hdGlvbgogICAgICB9OwogICAgICByZXR1cm4gYXBpQ2xpZW50LnBvc3QodXJsLCBwYXlsb2FkKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgICAgcmV0dXJuIF90aGlzNy5zZXRTdGF0ZSh7CiAgICAgICAgICBmb3JtVmFsdWVzOiB7CiAgICAgICAgICAgIG9yZGVySXRlbXM6IF8ubWFwKHJlc3AuZGF0YS5vcmRlckl0ZW1zLCBmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIGl0ZW0pLCB7fSwgewogICAgICAgICAgICAgICAgY2hlY2tlZDogISFzZWxlY3RlZE9yZGVySXRlbXNbaXRlbS5vcmRlckl0ZW1JZF0sCiAgICAgICAgICAgICAgICBxdWFudGl0eVRvU2hpcDogc2VsZWN0ZWRPcmRlckl0ZW1zW2l0ZW0ub3JkZXJJdGVtSWRdID8gc2VsZWN0ZWRPcmRlckl0ZW1zW2l0ZW0ub3JkZXJJdGVtSWRdLnF1YW50aXR5VG9TaGlwIDogJycsCiAgICAgICAgICAgICAgICBzb3J0T3JkZXI6IF90aGlzNy5nZXRTb3J0T3JkZXIoKQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KQogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZWxlY3RSb3ciLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNlbGVjdFJvdyh2YWx1ZSwgcm93SW5kZXgpIHsKICAgICAgdmFyIF90aGlzJHN0YXRlMiA9IHRoaXMuc3RhdGUsCiAgICAgICAgZm9ybVZhbHVlcyA9IF90aGlzJHN0YXRlMi5mb3JtVmFsdWVzLAogICAgICAgIHNlbGVjdGVkT3JkZXJJdGVtcyA9IF90aGlzJHN0YXRlMi5zZWxlY3RlZE9yZGVySXRlbXM7CiAgICAgIHZhciBuZXdTdGF0ZSA9IHsKICAgICAgICBmb3JtVmFsdWVzOiB7CiAgICAgICAgICBvcmRlckl0ZW1zOiBfLm1hcChmb3JtVmFsdWVzLm9yZGVySXRlbXMsIGZ1bmN0aW9uIChpdGVtLCBpZHgpIHsKICAgICAgICAgICAgaWYgKHJvd0luZGV4ID09PSBpZHgpIHsKICAgICAgICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBpdGVtKSwge30sIHsKICAgICAgICAgICAgICAgIGNoZWNrZWQ6IHZhbHVlLAogICAgICAgICAgICAgICAgcXVhbnRpdHlUb1NoaXA6IHZhbHVlID8gaXRlbS5xdWFudGl0eUF2YWlsYWJsZSA6ICcnLAogICAgICAgICAgICAgICAgc29ydE9yZGVyOiB2YWx1ZSA/IGl0ZW0uc29ydE9yZGVyIDogJycKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgaXRlbSk7CiAgICAgICAgICB9KQogICAgICAgIH0KICAgICAgfTsKICAgICAgaWYgKCF2YWx1ZSkgewogICAgICAgIGRlbGV0ZSBzZWxlY3RlZE9yZGVySXRlbXNbZm9ybVZhbHVlcy5vcmRlckl0ZW1zW3Jvd0luZGV4XS5vcmRlckl0ZW1JZF07CiAgICAgICAgbmV3U3RhdGUgPSBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIG5ld1N0YXRlKSwge30sIHsKICAgICAgICAgIHNlbGVjdGVkT3JkZXJJdGVtczogc2VsZWN0ZWRPcmRlckl0ZW1zCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbmV3U3RhdGUgPSBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIG5ld1N0YXRlKSwge30sIHsKICAgICAgICAgIHNlbGVjdGVkT3JkZXJJdGVtczogX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBzZWxlY3RlZE9yZGVySXRlbXMpLCB7fSwgX2RlZmluZVByb3BlcnR5KHt9LCBmb3JtVmFsdWVzLm9yZGVySXRlbXNbcm93SW5kZXhdLm9yZGVySXRlbUlkLCB7CiAgICAgICAgICAgIHF1YW50aXR5VG9TaGlwOiB2YWx1ZSA/IGZvcm1WYWx1ZXMub3JkZXJJdGVtc1tyb3dJbmRleF0ucXVhbnRpdHlBdmFpbGFibGUgOiAnJywKICAgICAgICAgICAgc29ydE9yZGVyOiB2YWx1ZSA/IGZvcm1WYWx1ZXMub3JkZXJJdGVtc1tyb3dJbmRleF0uc29ydE9yZGVyIDogJycKICAgICAgICAgIH0pKQogICAgICAgIH0pOwogICAgICB9CiAgICAgIHRoaXMuc2V0U3RhdGUobmV3U3RhdGUpOwogICAgfQogIH0sIHsKICAgIGtleTogInVwZGF0ZVJvdyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlUm93KHZhbHVlcywgaW5kZXgpIHsKICAgICAgdmFyIHNlbGVjdGVkT3JkZXJJdGVtcyA9IHRoaXMuc3RhdGUuc2VsZWN0ZWRPcmRlckl0ZW1zOwogICAgICB2YXIgaXRlbSA9IHZhbHVlcy5vcmRlckl0ZW1zW2luZGV4XTsKICAgICAgaXRlbS5jaGVja2VkID0gdHJ1ZTsKICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgZm9ybVZhbHVlczogdXBkYXRlKHZhbHVlcywgewogICAgICAgICAgb3JkZXJJdGVtczogX2RlZmluZVByb3BlcnR5KHt9LCBpbmRleCwgewogICAgICAgICAgICAkc2V0OiBpdGVtCiAgICAgICAgICB9KQogICAgICAgIH0pLAogICAgICAgIHNlbGVjdGVkT3JkZXJJdGVtczogX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBzZWxlY3RlZE9yZGVySXRlbXMpLCB7fSwgX2RlZmluZVByb3BlcnR5KHt9LCBpdGVtLm9yZGVySXRlbUlkLCB7CiAgICAgICAgICBxdWFudGl0eVRvU2hpcDogaXRlbS5xdWFudGl0eVRvU2hpcCwKICAgICAgICAgIHNvcnRPcmRlcjogaXRlbS5zb3J0T3JkZXIKICAgICAgICB9KSkKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiYWxsSXRlbXNTZWxlY3RlZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYWxsSXRlbXNTZWxlY3RlZCgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3RhdGUuZm9ybVZhbHVlcy5vcmRlckl0ZW1zLmV2ZXJ5KGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIGl0ZW0uY2hlY2tlZDsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAic2VsZWN0QWxsSXRlbXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNlbGVjdEFsbEl0ZW1zKCkgewogICAgICB2YXIgX3RoaXM4ID0gdGhpczsKICAgICAgdmFyIGFsbEl0ZW1zU2VsZWN0ZWQgPSB0aGlzLmFsbEl0ZW1zU2VsZWN0ZWQoKTsKICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgZm9ybVZhbHVlczogewogICAgICAgICAgb3JkZXJJdGVtczogdGhpcy5zdGF0ZS5mb3JtVmFsdWVzLm9yZGVySXRlbXMubWFwKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIGl0ZW0pLCB7fSwgewogICAgICAgICAgICAgIGNoZWNrZWQ6ICFhbGxJdGVtc1NlbGVjdGVkLAogICAgICAgICAgICAgIHF1YW50aXR5VG9TaGlwOiAhYWxsSXRlbXNTZWxlY3RlZCA/IGl0ZW0ucXVhbnRpdHlBdmFpbGFibGUgOiAnJywKICAgICAgICAgICAgICBzb3J0T3JkZXI6ICFhbGxJdGVtc1NlbGVjdGVkID8gaXRlbS5zb3J0T3JkZXIgOiAnJwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIF90aGlzOC51cGRhdGVBbGxTZWxlY3RlZEl0ZW1zKCk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInVwZGF0ZUFsbFNlbGVjdGVkSXRlbXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUFsbFNlbGVjdGVkSXRlbXMoKSB7CiAgICAgIHZhciBhbGxJdGVtc1NlbGVjdGVkID0gdGhpcy5hbGxJdGVtc1NlbGVjdGVkKCk7CiAgICAgIHZhciB1cGRhdGVkU2VsZWN0ZWRPcmRlckl0ZW1zID0gdGhpcy5zdGF0ZS5mb3JtVmFsdWVzLm9yZGVySXRlbXMucmVkdWNlKGZ1bmN0aW9uIChhY2MsIGN1cnIpIHsKICAgICAgICBpZiAoYWxsSXRlbXNTZWxlY3RlZCkgewogICAgICAgICAgcmV0dXJuIF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgYWNjKSwge30sIF9kZWZpbmVQcm9wZXJ0eSh7fSwgY3Vyci5vcmRlckl0ZW1JZCwgewogICAgICAgICAgICBxdWFudGl0eVRvU2hpcDogY3Vyci5xdWFudGl0eUF2YWlsYWJsZSwKICAgICAgICAgICAgc29ydE9yZGVyOiBjdXJyLnNvcnRPcmRlcgogICAgICAgICAgfSkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gYWNjOwogICAgICB9LCB7fSk7CiAgICAgIHRoaXMuc2V0U3RhdGUoewogICAgICAgIHNlbGVjdGVkT3JkZXJJdGVtczogdXBkYXRlZFNlbGVjdGVkT3JkZXJJdGVtcwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHsKICAgICAgdmFyIF90aGlzOSA9IHRoaXM7CiAgICAgIHZhciBfdGhpcyRzdGF0ZTMgPSB0aGlzLnN0YXRlLAogICAgICAgIG9yZGVyTnVtYmVyT3B0aW9ucyA9IF90aGlzJHN0YXRlMy5vcmRlck51bWJlck9wdGlvbnMsCiAgICAgICAgc2VsZWN0ZWRPcmRlcnMgPSBfdGhpcyRzdGF0ZTMuc2VsZWN0ZWRPcmRlcnMsCiAgICAgICAgZm9ybVZhbHVlcyA9IF90aGlzJHN0YXRlMy5mb3JtVmFsdWVzOwogICAgICB2YXIgX3RoaXMkcHJvcHMzID0gdGhpcy5wcm9wcywKICAgICAgICBidG5PcGVuVGV4dCA9IF90aGlzJHByb3BzMy5idG5PcGVuVGV4dCwKICAgICAgICBidG5PcGVuRGVmYXVsdFRleHQgPSBfdGhpcyRwcm9wczMuYnRuT3BlbkRlZmF1bHRUZXh0LAogICAgICAgIHRyYW5zbGF0ZSA9IF90aGlzJHByb3BzMy50cmFuc2xhdGUsCiAgICAgICAgYnRuT3BlbkRpc2FibGVkID0gX3RoaXMkcHJvcHMzLmJ0bk9wZW5EaXNhYmxlZDsKICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KE1vZGFsV3JhcHBlciwgewogICAgICAgIG9uT3BlbjogdGhpcy5vbk9wZW4sCiAgICAgICAgb25TYXZlOiB0aGlzLm9uU2F2ZSwKICAgICAgICBmaWVsZHM6IEZJRUxEUywKICAgICAgICB2YWxpZGF0ZTogdmFsaWRhdGUsCiAgICAgICAgaW5pdGlhbFZhbHVlczogZm9ybVZhbHVlcywKICAgICAgICB0aXRsZTogInJlYWN0LmNvbWJpbmVkU2hpcG1lbnRzLmFkZEl0ZW1zVG9TaGlwbWVudC5sYWJlbCIsCiAgICAgICAgZGVmYXVsdFRpdGxlTWVzc2FnZTogIkFkZCBpdGVtcyB0byBzaGlwbWVudCIsCiAgICAgICAgZm9ybVByb3BzOiB7CiAgICAgICAgICBzZWxlY3RSb3c6IHRoaXMuc2VsZWN0Um93LAogICAgICAgICAgdXBkYXRlUm93OiB0aGlzLnVwZGF0ZVJvdywKICAgICAgICAgIHNlbGVjdEFsbEl0ZW1zOiB0aGlzLnNlbGVjdEFsbEl0ZW1zLAogICAgICAgICAgYWxsSXRlbXNTZWxlY3RlZDogdGhpcy5hbGxJdGVtc1NlbGVjdGVkKCkKICAgICAgICB9LAogICAgICAgIGJ0blNhdmVUZXh0OiAicmVhY3QuY29tYmluZWRTaGlwbWVudHMuYWRkSXRlbXNUb1NoaXBtZW50LmxhYmVsIiwKICAgICAgICBidG5TYXZlRGVmYXVsdFRleHQ6ICJBZGQgaXRlbXMgdG8gc2hpcG1lbnQiLAogICAgICAgIGJ0bk9wZW5UZXh0OiBidG5PcGVuVGV4dCwKICAgICAgICBidG5PcGVuRGVmYXVsdFRleHQ6IGJ0bk9wZW5EZWZhdWx0VGV4dCwKICAgICAgICBidG5PcGVuRGlzYWJsZWQ6IGJ0bk9wZW5EaXNhYmxlZCwKICAgICAgICBidG5TYXZlRGlzYWJsZWQ6ICFfLmZpbmQoZm9ybVZhbHVlcy5vcmRlckl0ZW1zLCBmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgcmV0dXJuIGl0ZW0uY2hlY2tlZDsKICAgICAgICB9KQogICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIGNsYXNzTmFtZTogImQtZmxleCBtYi0zIGp1c3RpZnktY29udGVudC1zdGFydCBhbGlnbi1pdGVtcy1jZW50ZXIgdy0xMDAgY29tYmluZWQtc2hpcG1lbnQtZmlsdGVyIgogICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChTZWxlY3QsIHsKICAgICAgICBmaWVsZE5hbWU6ICJvcmRlck51bWJlciIsCiAgICAgICAgcGxhY2Vob2xkZXI6IHRyYW5zbGF0ZSgncmVhY3QuY29tYmluZWRTaGlwbWVudHMuc2VsZWN0T3JkZXJzLmxhYmVsJywgJ1NlbGVjdCBvcmRlcnMuLi4nKSwKICAgICAgICB2YWx1ZTogc2VsZWN0ZWRPcmRlcnMsCiAgICAgICAgbXVsdGk6IHRydWUsCiAgICAgICAgb3B0aW9uczogb3JkZXJOdW1iZXJPcHRpb25zLAogICAgICAgIHNob3dWYWx1ZVRvb2x0aXA6IHRydWUsCiAgICAgICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKHZhbHVlKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXM5LnNldFNlbGVjdGVkT3JkZXJzKHZhbHVlKTsKICAgICAgICB9LAogICAgICAgIHZhbHVlS2V5OiAiaWQiLAogICAgICAgIGxhYmVsS2V5OiAib3JkZXJOdW1iZXIiLAogICAgICAgIGNsYXNzZXM6ICIiLAogICAgICAgIGNhY2hlOiBmYWxzZQogICAgICB9KSwgIlx4QTAiLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChQcm9kdWN0U2VsZWN0LCB7CiAgICAgICAgc2hvd1NlbGVjdGVkT3B0aW9uQ29sb3I6IHRydWUsCiAgICAgICAgcGxhY2Vob2xkZXI6IHRyYW5zbGF0ZSgncmVhY3QuY29tYmluZWRTaGlwbWVudHMuc2VsZWN0UHJvZHVjdC5sYWJlbCcsICdTZWxlY3QgcHJvZHVjdC4uLicpLAogICAgICAgIGxvYWRPcHRpb25zOiB0aGlzLmRlYm91bmNlUHJvZHVjdHNJbk9yZGVycywKICAgICAgICBvbkNoYW5nZTogZnVuY3Rpb24gb25DaGFuZ2UodmFsdWUpIHsKICAgICAgICAgIHJldHVybiBfdGhpczkuc2V0U2VsZWN0ZWRQcm9kdWN0KHZhbHVlKTsKICAgICAgICB9CiAgICAgIH0pKSk7CiAgICB9CiAgfV0pOwogIHJldHVybiBDb21iaW5lZFNoaXBtZW50SXRlbXNNb2RhbDsKfShDb21wb25lbnQpOwp2YXIgbWFwU3RhdGVUb1Byb3BzID0gZnVuY3Rpb24gbWFwU3RhdGVUb1Byb3BzKHN0YXRlKSB7CiAgcmV0dXJuIHsKICAgIGRlYm91bmNlVGltZTogc3RhdGUuc2Vzc2lvbi5zZWFyY2hDb25maWcuZGVib3VuY2VUaW1lLAogICAgbWluU2VhcmNoTGVuZ3RoOiBzdGF0ZS5zZXNzaW9uLnNlYXJjaENvbmZpZy5taW5TZWFyY2hMZW5ndGgsCiAgICB0cmFuc2xhdGU6IHRyYW5zbGF0ZVdpdGhEZWZhdWx0TWVzc2FnZShnZXRUcmFuc2xhdGUoc3RhdGUubG9jYWxpemUpKQogIH07Cn07CmV4cG9ydCBkZWZhdWx0IGNvbm5lY3QobWFwU3RhdGVUb1Byb3BzLCB7CiAgc2hvd1NwaW5uZXI6IHNob3dTcGlubmVyLAogIGhpZGVTcGlubmVyOiBoaWRlU3Bpbm5lcgp9KShDb21iaW5lZFNoaXBtZW50SXRlbXNNb2RhbCk7CkNvbWJpbmVkU2hpcG1lbnRJdGVtc01vZGFsLnByb3BUeXBlcyA9IHsKICB2ZW5kb3I6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCwKICBkZXN0aW5hdGlvbjogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLAogIHNoaXBtZW50OiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsCiAgc2hvd1NwaW5uZXI6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsCiAgaGlkZVNwaW5uZXI6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsCiAgZGVib3VuY2VUaW1lOiBQcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWQsCiAgbWluU2VhcmNoTGVuZ3RoOiBQcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWQsCiAgdHJhbnNsYXRlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLAogIG9uUmVzcG9uc2U6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsCiAgb25PcGVuOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLAogIGJ0bk9wZW5UZXh0OiBQcm9wVHlwZXMuc3RyaW5nLAogIGJ0bk9wZW5EZWZhdWx0VGV4dDogUHJvcFR5cGVzLnN0cmluZywKICBidG5PcGVuRGlzYWJsZWQ6IFByb3BUeXBlcy5ib29sCn07CkNvbWJpbmVkU2hpcG1lbnRJdGVtc01vZGFsLmRlZmF1bHRQcm9wcyA9IHsKICBidG5PcGVuVGV4dDogJycsCiAgYnRuT3BlbkRlZmF1bHRUZXh0OiAnJywKICBidG5PcGVuRGlzYWJsZWQ6IGZhbHNlCn07"},null]}