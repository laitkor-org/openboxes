{"remainingRequest":"/opt/MTOBS-BIKASH/node_modules/babel-loader/lib/index.js?presets[]=@babel/react&presets[]=@babel/env!/opt/MTOBS-BIKASH/node_modules/eslint-loader/dist/cjs.js!/opt/MTOBS-BIKASH/src/js/components/stock-movement-wizard/outbound/CreateStockMovement.jsx","dependencies":[{"path":"/opt/MTOBS-BIKASH/src/js/components/stock-movement-wizard/outbound/CreateStockMovement.jsx","mtime":1698037750000},{"path":"/opt/MTOBS-BIKASH/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/opt/MTOBS-BIKASH/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/opt/MTOBS-BIKASH/node_modules/eslint-loader/dist/cjs.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsgcmV0dXJuIF90eXBlb2YgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgInN5bWJvbCIgPT0gdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfSwgX3R5cGVvZihvYmopOyB9CmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgeyByZXR1cm4gX2FycmF5V2l0aEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFyciwgaSkgfHwgX25vbkl0ZXJhYmxlUmVzdCgpOyB9CmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIik7IH0KZnVuY3Rpb24gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8sIG1pbkxlbikgeyBpZiAoIW8pIHJldHVybjsgaWYgKHR5cGVvZiBvID09PSAic3RyaW5nIikgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IHZhciBuID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pLnNsaWNlKDgsIC0xKTsgaWYgKG4gPT09ICJPYmplY3QiICYmIG8uY29uc3RydWN0b3IpIG4gPSBvLmNvbnN0cnVjdG9yLm5hbWU7IGlmIChuID09PSAiTWFwIiB8fCBuID09PSAiU2V0IikgcmV0dXJuIEFycmF5LmZyb20obyk7IGlmIChuID09PSAiQXJndW1lbnRzIiB8fCAvXig/OlVpfEkpbnQoPzo4fDE2fDMyKSg/OkNsYW1wZWQpP0FycmF5JC8udGVzdChuKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IH0KZnVuY3Rpb24gX2FycmF5TGlrZVRvQXJyYXkoYXJyLCBsZW4pIHsgaWYgKGxlbiA9PSBudWxsIHx8IGxlbiA+IGFyci5sZW5ndGgpIGxlbiA9IGFyci5sZW5ndGg7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGxlbik7IGkgPCBsZW47IGkrKykgeyBhcnIyW2ldID0gYXJyW2ldOyB9IHJldHVybiBhcnIyOyB9CmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsgdmFyIF9pID0gbnVsbCA9PSBhcnIgPyBudWxsIDogInVuZGVmaW5lZCIgIT0gdHlwZW9mIFN5bWJvbCAmJiBhcnJbU3ltYm9sLml0ZXJhdG9yXSB8fCBhcnJbIkBAaXRlcmF0b3IiXTsgaWYgKG51bGwgIT0gX2kpIHsgdmFyIF9zLCBfZSwgX3gsIF9yLCBfYXJyID0gW10sIF9uID0gITAsIF9kID0gITE7IHRyeSB7IGlmIChfeCA9IChfaSA9IF9pLmNhbGwoYXJyKSkubmV4dCwgMCA9PT0gaSkgeyBpZiAoT2JqZWN0KF9pKSAhPT0gX2kpIHJldHVybjsgX24gPSAhMTsgfSBlbHNlIGZvciAoOyAhKF9uID0gKF9zID0gX3guY2FsbChfaSkpLmRvbmUpICYmIChfYXJyLnB1c2goX3MudmFsdWUpLCBfYXJyLmxlbmd0aCAhPT0gaSk7IF9uID0gITApIHsgOyB9IH0gY2F0Y2ggKGVycikgeyBfZCA9ICEwLCBfZSA9IGVycjsgfSBmaW5hbGx5IHsgdHJ5IHsgaWYgKCFfbiAmJiBudWxsICE9IF9pWyJyZXR1cm4iXSAmJiAoX3IgPSBfaVsicmV0dXJuIl0oKSwgT2JqZWN0KF9yKSAhPT0gX3IpKSByZXR1cm47IH0gZmluYWxseSB7IGlmIChfZCkgdGhyb3cgX2U7IH0gfSByZXR1cm4gX2FycjsgfSB9CmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsgfQpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsgZW51bWVyYWJsZU9ubHkgJiYgKHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KSksIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsgfSByZXR1cm4ga2V5czsgfQpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gbnVsbCAhPSBhcmd1bWVudHNbaV0gPyBhcmd1bWVudHNbaV0gOiB7fTsgaSAlIDIgPyBvd25LZXlzKE9iamVjdChzb3VyY2UpLCAhMCkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KSA6IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKSA6IG93bktleXMoT2JqZWN0KHNvdXJjZSkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsgfSk7IH0gcmV0dXJuIHRhcmdldDsgfQpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7IGtleSA9IF90b1Byb3BlcnR5S2V5KGtleSk7IGlmIChrZXkgaW4gb2JqKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgeyB2YWx1ZTogdmFsdWUsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7IH0gZWxzZSB7IG9ialtrZXldID0gdmFsdWU7IH0gcmV0dXJuIG9iajsgfQpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgX3RvUHJvcGVydHlLZXkoZGVzY3JpcHRvci5rZXkpLCBkZXNjcmlwdG9yKTsgfSB9CmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbnN0cnVjdG9yLCAicHJvdG90eXBlIiwgeyB3cml0YWJsZTogZmFsc2UgfSk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQpmdW5jdGlvbiBfdG9Qcm9wZXJ0eUtleShhcmcpIHsgdmFyIGtleSA9IF90b1ByaW1pdGl2ZShhcmcsICJzdHJpbmciKTsgcmV0dXJuIF90eXBlb2Yoa2V5KSA9PT0gInN5bWJvbCIgPyBrZXkgOiBTdHJpbmcoa2V5KTsgfQpmdW5jdGlvbiBfdG9QcmltaXRpdmUoaW5wdXQsIGhpbnQpIHsgaWYgKF90eXBlb2YoaW5wdXQpICE9PSAib2JqZWN0IiB8fCBpbnB1dCA9PT0gbnVsbCkgcmV0dXJuIGlucHV0OyB2YXIgcHJpbSA9IGlucHV0W1N5bWJvbC50b1ByaW1pdGl2ZV07IGlmIChwcmltICE9PSB1bmRlZmluZWQpIHsgdmFyIHJlcyA9IHByaW0uY2FsbChpbnB1dCwgaGludCB8fCAiZGVmYXVsdCIpOyBpZiAoX3R5cGVvZihyZXMpICE9PSAib2JqZWN0IikgcmV0dXJuIHJlczsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQEB0b1ByaW1pdGl2ZSBtdXN0IHJldHVybiBhIHByaW1pdGl2ZSB2YWx1ZS4iKTsgfSByZXR1cm4gKGhpbnQgPT09ICJzdHJpbmciID8gU3RyaW5nIDogTnVtYmVyKShpbnB1dCk7IH0KZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBPYmplY3QuZGVmaW5lUHJvcGVydHkoc3ViQ2xhc3MsICJwcm90b3R5cGUiLCB7IHdyaXRhYmxlOiBmYWxzZSB9KTsgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7IH0KZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mLmJpbmQoKSA6IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IG8uX19wcm90b19fID0gcDsgcmV0dXJuIG87IH07IHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7IH0KZnVuY3Rpb24gX2NyZWF0ZVN1cGVyKERlcml2ZWQpIHsgdmFyIGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QgPSBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCk7IHJldHVybiBmdW5jdGlvbiBfY3JlYXRlU3VwZXJJbnRlcm5hbCgpIHsgdmFyIFN1cGVyID0gX2dldFByb3RvdHlwZU9mKERlcml2ZWQpLCByZXN1bHQ7IGlmIChoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KSB7IHZhciBOZXdUYXJnZXQgPSBfZ2V0UHJvdG90eXBlT2YodGhpcykuY29uc3RydWN0b3I7IHJlc3VsdCA9IFJlZmxlY3QuY29uc3RydWN0KFN1cGVyLCBhcmd1bWVudHMsIE5ld1RhcmdldCk7IH0gZWxzZSB7IHJlc3VsdCA9IFN1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7IH0gcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIHJlc3VsdCk7IH07IH0KZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7IHJldHVybiBjYWxsOyB9IGVsc2UgaWYgKGNhbGwgIT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJEZXJpdmVkIGNvbnN0cnVjdG9ycyBtYXkgb25seSByZXR1cm4gb2JqZWN0IG9yIHVuZGVmaW5lZCIpOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9CmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7IH0gcmV0dXJuIHNlbGY7IH0KZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHsgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSAidW5kZWZpbmVkIiB8fCAhUmVmbGVjdC5jb25zdHJ1Y3QpIHJldHVybiBmYWxzZTsgaWYgKFJlZmxlY3QuY29uc3RydWN0LnNoYW0pIHJldHVybiBmYWxzZTsgaWYgKHR5cGVvZiBQcm94eSA9PT0gImZ1bmN0aW9uIikgcmV0dXJuIHRydWU7IHRyeSB7IEJvb2xlYW4ucHJvdG90eXBlLnZhbHVlT2YuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChCb29sZWFuLCBbXSwgZnVuY3Rpb24gKCkge30pKTsgcmV0dXJuIHRydWU7IH0gY2F0Y2ggKGUpIHsgcmV0dXJuIGZhbHNlOyB9IH0KZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mLmJpbmQoKSA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7IH07IHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7IH0KaW1wb3J0IFJlYWN0LCB7IENvbXBvbmVudCB9IGZyb20gJ3JlYWN0JzsKaW1wb3J0IHVwZGF0ZSBmcm9tICdpbW11dGFiaWxpdHktaGVscGVyJzsKaW1wb3J0IF8gZnJvbSAnbG9kYXNoJzsKaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnOwppbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnOwppbXBvcnQgeyBjb25maXJtQWxlcnQgfSBmcm9tICdyZWFjdC1jb25maXJtLWFsZXJ0JzsKaW1wb3J0IHsgRm9ybSB9IGZyb20gJ3JlYWN0LWZpbmFsLWZvcm0nOwppbXBvcnQgeyBnZXRUcmFuc2xhdGUgfSBmcm9tICdyZWFjdC1sb2NhbGl6ZS1yZWR1eCc7CmltcG9ydCB7IGNvbm5lY3QgfSBmcm9tICdyZWFjdC1yZWR1eCc7CmltcG9ydCB7IHdpdGhSb3V0ZXIgfSBmcm9tICdyZWFjdC1yb3V0ZXItZG9tJzsKaW1wb3J0IHsgaGlkZVNwaW5uZXIsIHNob3dTcGlubmVyIH0gZnJvbSAnYWN0aW9ucyc7CmltcG9ydCBEYXRlRmllbGQgZnJvbSAnY29tcG9uZW50cy9mb3JtLWVsZW1lbnRzL0RhdGVGaWVsZCc7CmltcG9ydCBTZWxlY3RGaWVsZCBmcm9tICdjb21wb25lbnRzL2Zvcm0tZWxlbWVudHMvU2VsZWN0RmllbGQnOwppbXBvcnQgVGV4dEZpZWxkIGZyb20gJ2NvbXBvbmVudHMvZm9ybS1lbGVtZW50cy9UZXh0RmllbGQnOwppbXBvcnQgQWRkRGVzdGluYXRpb25Nb2RhbCBmcm9tICdjb21wb25lbnRzL3N0b2NrLW1vdmVtZW50LXdpemFyZC9tb2RhbHMvQWRkRGVzdGluYXRpb25Nb2RhbCc7CmltcG9ydCBhcGlDbGllbnQgZnJvbSAndXRpbHMvYXBpQ2xpZW50JzsKaW1wb3J0IHsgcmVuZGVyRm9ybUZpZWxkIH0gZnJvbSAndXRpbHMvZm9ybS11dGlscyc7CmltcG9ydCB7IGRlYm91bmNlTG9jYXRpb25zRmV0Y2gsIGRlYm91bmNlUGVvcGxlRmV0Y2ggfSBmcm9tICd1dGlscy9vcHRpb24tdXRpbHMnOwppbXBvcnQgVHJhbnNsYXRlLCB7IHRyYW5zbGF0ZVdpdGhEZWZhdWx0TWVzc2FnZSB9IGZyb20gJ3V0aWxzL1RyYW5zbGF0ZSc7CmltcG9ydCAncmVhY3QtY29uZmlybS1hbGVydC9zcmMvcmVhY3QtY29uZmlybS1hbGVydC5jc3MnOwpmdW5jdGlvbiB2YWxpZGF0ZSh2YWx1ZXMpIHsKICB2YXIgZXJyb3JzID0ge307CiAgaWYgKCF2YWx1ZXMuZGVzY3JpcHRpb24pIHsKICAgIGVycm9ycy5kZXNjcmlwdGlvbiA9ICdyZWFjdC5kZWZhdWx0LmVycm9yLnJlcXVpcmVkRmllbGQubGFiZWwnOwogIH0KICBpZiAoIXZhbHVlcy5vcmlnaW4pIHsKICAgIGVycm9ycy5vcmlnaW4gPSAncmVhY3QuZGVmYXVsdC5lcnJvci5yZXF1aXJlZEZpZWxkLmxhYmVsJzsKICB9CiAgaWYgKCF2YWx1ZXMuZGVzdGluYXRpb24pIHsKICAgIGVycm9ycy5kZXN0aW5hdGlvbiA9ICdyZWFjdC5kZWZhdWx0LmVycm9yLnJlcXVpcmVkRmllbGQubGFiZWwnOwogIH0KICBpZiAoIXZhbHVlcy5yZXF1ZXN0ZWRCeSkgewogICAgZXJyb3JzLnJlcXVlc3RlZEJ5ID0gJ3JlYWN0LmRlZmF1bHQuZXJyb3IucmVxdWlyZWRGaWVsZC5sYWJlbCc7CiAgfQogIGlmICghdmFsdWVzLnJlcXVlc3RUeXBlKSB7CiAgICBlcnJvcnMucmVxdWVzdFR5cGUgPSAncmVhY3QuZGVmYXVsdC5lcnJvci5yZXF1aXJlZEZpZWxkLmxhYmVsJzsKICB9CiAgaWYgKCF2YWx1ZXMuZGF0ZVJlcXVlc3RlZCkgewogICAgZXJyb3JzLmRhdGVSZXF1ZXN0ZWQgPSAncmVhY3QuZGVmYXVsdC5lcnJvci5yZXF1aXJlZEZpZWxkLmxhYmVsJzsKICB9IGVsc2UgewogICAgdmFyIGRhdGVSZXF1ZXN0ZWQgPSBtb21lbnQodmFsdWVzLmRhdGVSZXF1ZXN0ZWQsICdNTS9ERC9ZWVlZJyk7CiAgICBpZiAobW9tZW50KCkuZGlmZihkYXRlUmVxdWVzdGVkKSA8IDApIHsKICAgICAgZXJyb3JzLmRhdGVSZXF1ZXN0ZWQgPSAncmVhY3Quc3RvY2tNb3ZlbWVudC5lcnJvci5mdXR1cmVEYXRlLmxhYmVsJzsKICAgIH0KICB9CiAgcmV0dXJuIGVycm9yczsKfQp2YXIgRklFTERTID0gewogIGRlc2NyaXB0aW9uOiB7CiAgICB0eXBlOiBUZXh0RmllbGQsCiAgICBsYWJlbDogJ3JlYWN0LnN0b2NrTW92ZW1lbnQuZGVzY3JpcHRpb24ubGFiZWwnLAogICAgZGVmYXVsdE1lc3NhZ2U6ICdEZXNjcmlwdGlvbicsCiAgICBhdHRyaWJ1dGVzOiB7CiAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICBhdXRvRm9jdXM6IHRydWUKICAgIH0KICB9LAogIG9yaWdpbjogewogICAgdHlwZTogU2VsZWN0RmllbGQsCiAgICBsYWJlbDogJ3JlYWN0LnN0b2NrTW92ZW1lbnQub3JpZ2luLmxhYmVsJywKICAgIGRlZmF1bHRNZXNzYWdlOiAnT3JpZ2luJywKICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgIGFzeW5jOiB0cnVlLAogICAgICBzaG93VmFsdWVUb29sdGlwOiB0cnVlLAogICAgICBvcGVuT25DbGljazogZmFsc2UsCiAgICAgIGF1dG9sb2FkOiBmYWxzZSwKICAgICAgY2FjaGU6IGZhbHNlLAogICAgICBvcHRpb25zOiBbXSwKICAgICAgZmlsdGVyT3B0aW9uczogZnVuY3Rpb24gZmlsdGVyT3B0aW9ucyhvcHRpb25zKSB7CiAgICAgICAgcmV0dXJuIG9wdGlvbnM7CiAgICAgIH0KICAgIH0sCiAgICBnZXREeW5hbWljQXR0cjogZnVuY3Rpb24gZ2V0RHluYW1pY0F0dHIocHJvcHMpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBsb2FkT3B0aW9uczogcHJvcHMuZGVib3VuY2VkTG9jYXRpb25zRmV0Y2gsCiAgICAgICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKHZhbHVlKSB7CiAgICAgICAgICBpZiAodmFsdWUgJiYgcHJvcHMuZGVzdGluYXRpb24gJiYgcHJvcHMuZGVzdGluYXRpb24uaWQpIHsKICAgICAgICAgICAgcHJvcHMuZmV0Y2hTdG9ja0xpc3RzKHZhbHVlLCBwcm9wcy5kZXN0aW5hdGlvbik7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBkaXNhYmxlZDogIXByb3BzLmlzU3VwZXJ1c2VyCiAgICAgIH07CiAgICB9CiAgfSwKICBkZXN0aW5hdGlvbjogewogICAgdHlwZTogU2VsZWN0RmllbGQsCiAgICBsYWJlbDogJ3JlYWN0LnN0b2NrTW92ZW1lbnQuZGVzdGluYXRpb24ubGFiZWwnLAogICAgZGVmYXVsdE1lc3NhZ2U6ICdEZXN0aW5hdGlvbicsCiAgICBhdHRyaWJ1dGVzOiB7CiAgICAgIGNyZWF0ZU5ld0Zyb21Nb2RhbDogdHJ1ZSwKICAgICAgY3JlYXRlTmV3RnJvbU1vZGFsTGFiZWw6ICdyZWFjdC5zdG9ja01vdmVtZW50LmFkZERlc3RpbmF0aW9uLmxhYmVsJywKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdBZGQgRGVzdGluYXRpb24nLAogICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgYXN5bmM6IHRydWUsCiAgICAgIHNob3dWYWx1ZVRvb2x0aXA6IHRydWUsCiAgICAgIG9wZW5PbkNsaWNrOiBmYWxzZSwKICAgICAgYXV0b2xvYWQ6IGZhbHNlLAogICAgICBjYWNoZTogZmFsc2UsCiAgICAgIG9wdGlvbnM6IFtdLAogICAgICBmaWx0ZXJPcHRpb25zOiBmdW5jdGlvbiBmaWx0ZXJPcHRpb25zKG9wdGlvbnMpIHsKICAgICAgICByZXR1cm4gb3B0aW9uczsKICAgICAgfQogICAgfSwKICAgIGdldER5bmFtaWNBdHRyOiBmdW5jdGlvbiBnZXREeW5hbWljQXR0cihfcmVmKSB7CiAgICAgIHZhciBkZWJvdW5jZWRMb2NhdGlvbnNGZXRjaCA9IF9yZWYuZGVib3VuY2VkTG9jYXRpb25zRmV0Y2gsCiAgICAgICAgb3JpZ2luID0gX3JlZi5vcmlnaW4sCiAgICAgICAgZmV0Y2hTdG9ja0xpc3RzID0gX3JlZi5mZXRjaFN0b2NrTGlzdHMsCiAgICAgICAgb3Blbk5ld0xvY2F0aW9uTW9kYWwgPSBfcmVmLm9wZW5OZXdMb2NhdGlvbk1vZGFsLAogICAgICAgIGxvY2F0aW9uVHlwZXMgPSBfcmVmLmxvY2F0aW9uVHlwZXM7CiAgICAgIHJldHVybiB7CiAgICAgICAgbG9hZE9wdGlvbnM6IGRlYm91bmNlZExvY2F0aW9uc0ZldGNoLAogICAgICAgIG5ld09wdGlvbk1vZGFsT3Blbjogb3Blbk5ld0xvY2F0aW9uTW9kYWwsCiAgICAgICAgY3JlYXRlTmV3RnJvbU1vZGFsOiAhIWxvY2F0aW9uVHlwZXMubGVuZ3RoLAogICAgICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZSh2YWx1ZSkgewogICAgICAgICAgaWYgKHZhbHVlICYmIG9yaWdpbiAmJiBvcmlnaW4uaWQpIHsKICAgICAgICAgICAgZmV0Y2hTdG9ja0xpc3RzKG9yaWdpbiwgdmFsdWUpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9LAogIHJlcXVlc3RlZEJ5OiB7CiAgICB0eXBlOiBTZWxlY3RGaWVsZCwKICAgIGxhYmVsOiAncmVhY3Quc3RvY2tNb3ZlbWVudC5yZXF1ZXN0ZWRCeS5sYWJlbCcsCiAgICBkZWZhdWx0TWVzc2FnZTogJ1JlcXVlc3RlZCBieScsCiAgICBhdHRyaWJ1dGVzOiB7CiAgICAgIGFzeW5jOiB0cnVlLAogICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgc2hvd1ZhbHVlVG9vbHRpcDogdHJ1ZSwKICAgICAgb3Blbk9uQ2xpY2s6IGZhbHNlLAogICAgICBhdXRvbG9hZDogZmFsc2UsCiAgICAgIGNhY2hlOiBmYWxzZSwKICAgICAgb3B0aW9uczogW10sCiAgICAgIGxhYmVsS2V5OiAnbmFtZScsCiAgICAgIGZpbHRlck9wdGlvbnM6IGZ1bmN0aW9uIGZpbHRlck9wdGlvbnMob3B0aW9ucykgewogICAgICAgIHJldHVybiBvcHRpb25zOwogICAgICB9CiAgICB9LAogICAgZ2V0RHluYW1pY0F0dHI6IGZ1bmN0aW9uIGdldER5bmFtaWNBdHRyKHByb3BzKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgbG9hZE9wdGlvbnM6IHByb3BzLmRlYm91bmNlZFBlb3BsZUZldGNoCiAgICAgIH07CiAgICB9CiAgfSwKICBkYXRlUmVxdWVzdGVkOiB7CiAgICB0eXBlOiBEYXRlRmllbGQsCiAgICBsYWJlbDogJ3JlYWN0LnN0b2NrTW92ZW1lbnQuZGF0ZVJlcXVlc3RlZC5sYWJlbCcsCiAgICBkZWZhdWx0TWVzc2FnZTogJ0RhdGUgcmVxdWVzdGVkJywKICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgIGRhdGVGb3JtYXQ6ICdNTS9ERC9ZWVlZJywKICAgICAgYXV0b0NvbXBsZXRlOiAnb2ZmJwogICAgfQogIH0sCiAgcmVxdWVzdFR5cGU6IHsKICAgIHR5cGU6IFNlbGVjdEZpZWxkLAogICAgbGFiZWw6ICdyZWFjdC5zdG9ja01vdmVtZW50LnJlcXVlc3RUeXBlLmxhYmVsJywKICAgIGRlZmF1bHRNZXNzYWdlOiAnUmVxdWVzdCB0eXBlJywKICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgIHNob3dWYWx1ZVRvb2x0aXA6IHRydWUKICAgIH0sCiAgICBnZXREeW5hbWljQXR0cjogZnVuY3Rpb24gZ2V0RHluYW1pY0F0dHIoX3JlZjIpIHsKICAgICAgdmFyIHJlcXVlc3RUeXBlcyA9IF9yZWYyLnJlcXVlc3RUeXBlczsKICAgICAgcmV0dXJuIHsKICAgICAgICBvcHRpb25zOiByZXF1ZXN0VHlwZXMKICAgICAgfTsKICAgIH0KICB9LAogIHN0b2NrbGlzdDogewogICAgbGFiZWw6ICdyZWFjdC5zdG9ja01vdmVtZW50LnN0b2NrbGlzdC5sYWJlbCcsCiAgICBkZWZhdWx0TWVzc2FnZTogJ1N0b2NrbGlzdCcsCiAgICB0eXBlOiBTZWxlY3RGaWVsZCwKICAgIGdldER5bmFtaWNBdHRyOiBmdW5jdGlvbiBnZXREeW5hbWljQXR0cihfcmVmMykgewogICAgICB2YXIgb3JpZ2luID0gX3JlZjMub3JpZ2luLAogICAgICAgIGRlc3RpbmF0aW9uID0gX3JlZjMuZGVzdGluYXRpb24sCiAgICAgICAgc3RvY2tsaXN0cyA9IF9yZWYzLnN0b2NrbGlzdHMsCiAgICAgICAgc2V0UmVxdWVzdFR5cGUgPSBfcmVmMy5zZXRSZXF1ZXN0VHlwZSwKICAgICAgICB2YWx1ZXMgPSBfcmVmMy52YWx1ZXM7CiAgICAgIHJldHVybiB7CiAgICAgICAgZGlzYWJsZWQ6ICEob3JpZ2luICYmIGRlc3RpbmF0aW9uICYmIG9yaWdpbi5pZCAmJiBkZXN0aW5hdGlvbi5pZCksCiAgICAgICAgb3B0aW9uczogc3RvY2tsaXN0cywKICAgICAgICBzaG93VmFsdWVUb29sdGlwOiB0cnVlLAogICAgICAgIHZhbHVlS2V5OiAnaWQnLAogICAgICAgIGxhYmVsS2V5OiAnbmFtZScsCiAgICAgICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKHZhbHVlKSB7CiAgICAgICAgICBpZiAodmFsdWUpIHsKICAgICAgICAgICAgc2V0UmVxdWVzdFR5cGUodmFsdWVzLCB2YWx1ZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0KfTsKCi8qKiBUaGUgZmlyc3Qgc3RlcCBvZiBzdG9jayBtb3ZlbWVudCB3aGVyZSB1c2VyIGNhbiBhZGQgYWxsIHRoZSBiYXNpYyBpbmZvcm1hdGlvbi4gKi8KdmFyIENyZWF0ZVN0b2NrTW92ZW1lbnQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoQ3JlYXRlU3RvY2tNb3ZlbWVudCwgX0NvbXBvbmVudCk7CiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihDcmVhdGVTdG9ja01vdmVtZW50KTsKICBmdW5jdGlvbiBDcmVhdGVTdG9ja01vdmVtZW50KHByb3BzKSB7CiAgICB2YXIgX3RoaXM7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ3JlYXRlU3RvY2tNb3ZlbWVudCk7CiAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKTsKICAgIF90aGlzLnN0YXRlID0gewogICAgICBzdG9ja2xpc3RzOiBbXSwKICAgICAgc2V0SW5pdGlhbFZhbHVlczogdHJ1ZSwKICAgICAgdmFsdWVzOiBfdGhpcy5wcm9wcy5pbml0aWFsVmFsdWVzLAogICAgICByZXF1ZXN0VHlwZXM6IFtdLAogICAgICBzaG93RGVzdGluYXRpb25Nb2RhbDogZmFsc2UKICAgIH07CiAgICBfdGhpcy5mZXRjaFN0b2NrTGlzdHMgPSBfdGhpcy5mZXRjaFN0b2NrTGlzdHMuYmluZChfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSk7CiAgICBfdGhpcy5zZXRSZXF1ZXN0VHlwZSA9IF90aGlzLnNldFJlcXVlc3RUeXBlLmJpbmQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcykpOwogICAgX3RoaXMuZGVib3VuY2VkUGVvcGxlRmV0Y2ggPSBkZWJvdW5jZVBlb3BsZUZldGNoKF90aGlzLnByb3BzLmRlYm91bmNlVGltZSwgX3RoaXMucHJvcHMubWluU2VhcmNoTGVuZ3RoKTsKICAgIF90aGlzLmRlYm91bmNlZExvY2F0aW9uc0ZldGNoID0gZGVib3VuY2VMb2NhdGlvbnNGZXRjaChfdGhpcy5wcm9wcy5kZWJvdW5jZVRpbWUsIF90aGlzLnByb3BzLm1pblNlYXJjaExlbmd0aCk7CiAgICBfdGhpcy5vcGVuQWRkRGVzdGluYXRpb25Nb2RhbCA9IF90aGlzLm9wZW5BZGREZXN0aW5hdGlvbk1vZGFsLmJpbmQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcykpOwogICAgcmV0dXJuIF90aGlzOwogIH0KICBfY3JlYXRlQ2xhc3MoQ3JlYXRlU3RvY2tNb3ZlbWVudCwgW3sKICAgIGtleTogImNvbXBvbmVudERpZE1vdW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHsKICAgICAgaWYgKHRoaXMuc3RhdGUudmFsdWVzLm9yaWdpbiAmJiB0aGlzLnN0YXRlLnZhbHVlcy5kZXN0aW5hdGlvbikgewogICAgICAgIHRoaXMuZmV0Y2hTdG9ja0xpc3RzKHRoaXMuc3RhdGUudmFsdWVzLm9yaWdpbiwgdGhpcy5zdGF0ZS52YWx1ZXMuZGVzdGluYXRpb24pOwogICAgICB9CiAgICAgIHRoaXMuZmV0Y2hSZXF1aXNpdGlvblR5cGVzKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhuZXh0UHJvcHMpIHsKICAgICAgaWYgKCF0aGlzLnByb3BzLm1hdGNoLnBhcmFtcy5zdG9ja01vdmVtZW50SWQgJiYgdGhpcy5zdGF0ZS5zZXRJbml0aWFsVmFsdWVzICYmIG5leHRQcm9wcy5sb2NhdGlvbi5pZCkgewogICAgICAgIHRoaXMuc2V0SW5pdGlhbFZhbHVlcyhuZXh0UHJvcHMubG9jYXRpb24pOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0UmVxdWVzdFR5cGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldFJlcXVlc3RUeXBlKHZhbHVlcywgc3RvY2tsaXN0KSB7CiAgICAgIHZhciByZXF1ZXN0VHlwZSA9IF8uZmluZCh0aGlzLnN0YXRlLnJlcXVlc3RUeXBlcywgZnVuY3Rpb24gKHR5cGUpIHsKICAgICAgICByZXR1cm4gdHlwZS52YWx1ZSA9PT0gJ1NUT0NLJzsKICAgICAgfSk7CiAgICAgIHRoaXMuc2V0U3RhdGUoewogICAgICAgIHZhbHVlczogdXBkYXRlKHZhbHVlcywgewogICAgICAgICAgcmVxdWVzdFR5cGU6IHsKICAgICAgICAgICAgJHNldDogcmVxdWVzdFR5cGUKICAgICAgICAgIH0sCiAgICAgICAgICBzdG9ja2xpc3Q6IHsKICAgICAgICAgICAgJHNldDogc3RvY2tsaXN0CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0SW5pdGlhbFZhbHVlcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0SW5pdGlhbFZhbHVlcyhsb2NhdGlvbikgewogICAgICB2YXIgaWQgPSBsb2NhdGlvbi5pZCwKICAgICAgICBsb2NhdGlvblR5cGUgPSBsb2NhdGlvbi5sb2NhdGlvblR5cGUsCiAgICAgICAgbmFtZSA9IGxvY2F0aW9uLm5hbWU7CiAgICAgIHZhciB2YWx1ZXMgPSB7CiAgICAgICAgb3JpZ2luOiB7CiAgICAgICAgICBpZDogaWQsCiAgICAgICAgICB0eXBlOiBsb2NhdGlvblR5cGUgPyBsb2NhdGlvblR5cGUubG9jYXRpb25UeXBlQ29kZSA6IG51bGwsCiAgICAgICAgICBuYW1lOiBuYW1lLAogICAgICAgICAgbGFiZWw6ICIiLmNvbmNhdChuYW1lLCAiIFsiKS5jb25jYXQobG9jYXRpb25UeXBlID8gbG9jYXRpb25UeXBlLmRlc2NyaXB0aW9uIDogbnVsbCwgIl0iKQogICAgICAgIH0KICAgICAgfTsKICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgdmFsdWVzOiB2YWx1ZXMsCiAgICAgICAgc2V0SW5pdGlhbFZhbHVlczogZmFsc2UKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAib3BlbkFkZERlc3RpbmF0aW9uTW9kYWwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9wZW5BZGREZXN0aW5hdGlvbk1vZGFsKCkgewogICAgICB0aGlzLnNldFN0YXRlKHsKICAgICAgICBzaG93RGVzdGluYXRpb25Nb2RhbDogdHJ1ZQogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIEZldGNoZXMgYXZhaWxhYmxlIHNoaXBtZW50IHR5cGVzIGZyb20gQVBJLgogICAgICogQHB1YmxpYwogICAgICovCiAgfSwgewogICAga2V5OiAiZmV0Y2hSZXF1aXNpdGlvblR5cGVzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmZXRjaFJlcXVpc2l0aW9uVHlwZXMoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwogICAgICB2YXIgdXJsID0gJy9vcGVuYm94ZXMvYXBpL2dldFJlcXVlc3RUeXBlcyc7CiAgICAgIHJldHVybiBhcGlDbGllbnQuZ2V0KHVybCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICB2YXIgcmVxdWVzdFR5cGVzID0gXy5tYXAocmVzcG9uc2UuZGF0YS5kYXRhLCBmdW5jdGlvbiAodHlwZSkgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgdmFsdWU6IHR5cGUuaWQsCiAgICAgICAgICAgIGxhYmVsOiB0eXBlLm5hbWUKICAgICAgICAgIH07CiAgICAgICAgfSk7CiAgICAgICAgX3RoaXMyLnNldFN0YXRlKHsKICAgICAgICAgIHJlcXVlc3RUeXBlczogcmVxdWVzdFR5cGVzCiAgICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzMi5wcm9wcy5oaWRlU3Bpbm5lcigpOwogICAgICAgIH0pOwogICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMi5wcm9wcy5oaWRlU3Bpbm5lcigpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjaGVja1N0b2NrTW92ZW1lbnRDaGFuZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNoZWNrU3RvY2tNb3ZlbWVudENoYW5nZShuZXdWYWx1ZXMpIHsKICAgICAgdmFyIF90aGlzJHByb3BzJGluaXRpYWxWYSA9IHRoaXMucHJvcHMuaW5pdGlhbFZhbHVlcywKICAgICAgICBvcmlnaW4gPSBfdGhpcyRwcm9wcyRpbml0aWFsVmEub3JpZ2luLAogICAgICAgIGRlc3RpbmF0aW9uID0gX3RoaXMkcHJvcHMkaW5pdGlhbFZhLmRlc3RpbmF0aW9uLAogICAgICAgIHN0b2NrbGlzdCA9IF90aGlzJHByb3BzJGluaXRpYWxWYS5zdG9ja2xpc3Q7CiAgICAgIHZhciBvcmlnaW5Mb2NzID0gbmV3VmFsdWVzLm9yaWdpbiAmJiBvcmlnaW47CiAgICAgIHZhciBpc09sZFN1cHBsaWVyID0gb3JpZ2luICYmIG9yaWdpbi50eXBlID09PSAnU1VQUExJRVInOwogICAgICB2YXIgaXNOZXdTdXBwbGllciA9IG5ld1ZhbHVlcy5vcmlnaW4gJiYgbmV3VmFsdWVzLnR5cGUgPT09ICdTVVBQTElFUic7CiAgICAgIHZhciBjaGVja09yaWdpbiA9IG9yaWdpbkxvY3MgJiYgKCFpc09sZFN1cHBsaWVyIHx8IGlzT2xkU3VwcGxpZXIgJiYgIWlzTmV3U3VwcGxpZXIpID8gbmV3VmFsdWVzLm9yaWdpbi5pZCAhPT0gb3JpZ2luLmlkIDogZmFsc2U7CiAgICAgIHZhciBjaGVja0Rlc3QgPSBzdG9ja2xpc3QgJiYgbmV3VmFsdWVzLmRlc3RpbmF0aW9uICYmIGRlc3RpbmF0aW9uID8gbmV3VmFsdWVzLmRlc3RpbmF0aW9uLmlkICE9PSBkZXN0aW5hdGlvbi5pZCA6IGZhbHNlOwogICAgICB2YXIgY2hlY2tTdG9ja0xpc3QgPSBuZXdWYWx1ZXMuc3RvY2tNb3ZlbWVudElkID8gXy5nZXQobmV3VmFsdWVzLnN0b2NrbGlzdCwgJ2lkJywgbnVsbCkgIT09IF8uZ2V0KHN0b2NrbGlzdCwgJ2lkJywgbnVsbCkgOiBmYWxzZTsKICAgICAgcmV0dXJuIGNoZWNrT3JpZ2luIHx8IGNoZWNrRGVzdCB8fCBjaGVja1N0b2NrTGlzdDsKICAgIH0KCiAgICAvKioKICAgICAqIEZldGNoZXMgYXZhaWxhYmxlIHN0b2NrIGxpc3RzIGZyb20gQVBJIHdpdGggZ2l2ZW4gb3JpZ2luIGFuZCBkZXN0aW5hdGlvbi4KICAgICAqIEBwYXJhbSB7b2JqZWN0fSBvcmlnaW4KICAgICAqIEBwYXJhbSB7b2JqZWN0fSBkZXN0aW5hdGlvbgogICAgICogQHBhcmFtIHtmdW5jdGlvbn0gY2xlYXJTdG9ja2xpc3QKICAgICAqIEBwdWJsaWMKICAgICAqLwogIH0sIHsKICAgIGtleTogImZldGNoU3RvY2tMaXN0cyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZmV0Y2hTdG9ja0xpc3RzKG9yaWdpbiwgZGVzdGluYXRpb24sIGNsZWFyU3RvY2tsaXN0KSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwogICAgICB0aGlzLnByb3BzLnNob3dTcGlubmVyKCk7CiAgICAgIHZhciB1cmwgPSAiL29wZW5ib3hlcy9hcGkvc3RvY2tsaXN0cz9vcmlnaW49Ii5jb25jYXQob3JpZ2luLmlkLCAiJmRlc3RpbmF0aW9uPSIpLmNvbmNhdChkZXN0aW5hdGlvbi5pZCk7CiAgICAgIHJldHVybiBhcGlDbGllbnQuZ2V0KHVybCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICB2YXIgc3RvY2tsaXN0cyA9IF8ubWFwKHJlc3BvbnNlLmRhdGEuZGF0YSwgZnVuY3Rpb24gKHN0b2NrbGlzdCkgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgaWQ6IHN0b2NrbGlzdC5pZCwKICAgICAgICAgICAgbmFtZTogc3RvY2tsaXN0Lm5hbWUsCiAgICAgICAgICAgIHZhbHVlOiBzdG9ja2xpc3QuaWQsCiAgICAgICAgICAgIGxhYmVsOiBzdG9ja2xpc3QubmFtZQogICAgICAgICAgfTsKICAgICAgICB9KTsKICAgICAgICB2YXIgc3RvY2tsaXN0Q2hhbmdlZCA9ICFfLmZpbmQoc3RvY2tsaXN0cywgZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgIHJldHVybiBpdGVtLnZhbHVlLmlkID09PSBfLmdldChfdGhpczMuc3RhdGUudmFsdWVzLCAnc3RvY2tsaXN0LmlkJyk7CiAgICAgICAgfSk7CiAgICAgICAgaWYgKHN0b2NrbGlzdENoYW5nZWQgJiYgY2xlYXJTdG9ja2xpc3QpIHsKICAgICAgICAgIGNsZWFyU3RvY2tsaXN0KCk7CiAgICAgICAgfQogICAgICAgIF90aGlzMy5zZXRTdGF0ZSh7CiAgICAgICAgICBzdG9ja2xpc3RzOiBzdG9ja2xpc3RzCiAgICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzMy5wcm9wcy5oaWRlU3Bpbm5lcigpOwogICAgICAgIH0pOwogICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMy5wcm9wcy5oaWRlU3Bpbm5lcigpOwogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZXMgb3IgdXBkYXRlcyBzdG9jayBtb3ZlbWVudCB3aXRoIGdpdmVuIGRhdGEKICAgICAqIEBwYXJhbSB7b2JqZWN0fSB2YWx1ZXMKICAgICAqIEBwdWJsaWMKICAgICAqLwogIH0sIHsKICAgIGtleTogInNhdmVTdG9ja01vdmVtZW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzYXZlU3RvY2tNb3ZlbWVudCh2YWx1ZXMpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CiAgICAgIGlmICh2YWx1ZXMub3JpZ2luICYmIHZhbHVlcy5kZXN0aW5hdGlvbiAmJiB2YWx1ZXMucmVxdWVzdGVkQnkgJiYgdmFsdWVzLmRhdGVSZXF1ZXN0ZWQgJiYgdmFsdWVzLmRlc2NyaXB0aW9uKSB7CiAgICAgICAgdGhpcy5wcm9wcy5zaG93U3Bpbm5lcigpOwogICAgICAgIHZhciBzdG9ja01vdmVtZW50VXJsID0gJyc7CiAgICAgICAgaWYgKHZhbHVlcy5zdG9ja01vdmVtZW50SWQpIHsKICAgICAgICAgIHN0b2NrTW92ZW1lbnRVcmwgPSAiL29wZW5ib3hlcy9hcGkvc3RvY2tNb3ZlbWVudHMvIi5jb25jYXQodmFsdWVzLnN0b2NrTW92ZW1lbnRJZCwgIi91cGRhdGVSZXF1aXNpdGlvbiIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzdG9ja01vdmVtZW50VXJsID0gJy9vcGVuYm94ZXMvYXBpL3N0b2NrTW92ZW1lbnRzJzsKICAgICAgICB9CiAgICAgICAgdmFyIHBheWxvYWQgPSB7CiAgICAgICAgICBuYW1lOiAnJywKICAgICAgICAgIGRlc2NyaXB0aW9uOiB2YWx1ZXMuZGVzY3JpcHRpb24sCiAgICAgICAgICBkYXRlUmVxdWVzdGVkOiB2YWx1ZXMuZGF0ZVJlcXVlc3RlZCwKICAgICAgICAgICdvcmlnaW4uaWQnOiB2YWx1ZXMub3JpZ2luLmlkLAogICAgICAgICAgJ2Rlc3RpbmF0aW9uLmlkJzogdmFsdWVzLmRlc3RpbmF0aW9uLmlkLAogICAgICAgICAgJ3JlcXVlc3RlZEJ5LmlkJzogdmFsdWVzLnJlcXVlc3RlZEJ5LmlkLAogICAgICAgICAgJ3N0b2NrbGlzdC5pZCc6IF8uZ2V0KHZhbHVlcy5zdG9ja2xpc3QsICdpZCcpIHx8ICcnLAogICAgICAgICAgcmVxdWVzdFR5cGU6IHZhbHVlcy5yZXF1ZXN0VHlwZS52YWx1ZQogICAgICAgIH07CiAgICAgICAgYXBpQ2xpZW50LnBvc3Qoc3RvY2tNb3ZlbWVudFVybCwgcGF5bG9hZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhKSB7CiAgICAgICAgICAgIHZhciByZXNwID0gcmVzcG9uc2UuZGF0YS5kYXRhOwogICAgICAgICAgICBfdGhpczQucHJvcHMuaGlzdG9yeS5wdXNoKCIvb3BlbmJveGVzL3N0b2NrTW92ZW1lbnQvY3JlYXRlT3V0Ym91bmQvIi5jb25jYXQocmVzcC5pZCkpOwogICAgICAgICAgICBfdGhpczQucHJvcHMubmV4dFBhZ2UoX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCB2YWx1ZXMpLCB7fSwgewogICAgICAgICAgICAgIHN0b2NrTW92ZW1lbnRJZDogcmVzcC5pZCwKICAgICAgICAgICAgICBsaW5lSXRlbXM6IHJlc3AubGluZUl0ZW1zLAogICAgICAgICAgICAgIG1vdmVtZW50TnVtYmVyOiByZXNwLmlkZW50aWZpZXIsCiAgICAgICAgICAgICAgbmFtZTogcmVzcC5uYW1lLAogICAgICAgICAgICAgIHN0b2NrbGlzdDogcmVzcC5zdG9ja2xpc3QsCiAgICAgICAgICAgICAgcmVxdWVzdFR5cGU6IHsKICAgICAgICAgICAgICAgIG5hbWU6IHJlc3AucmVxdWVzdFR5cGUubmFtZSwKICAgICAgICAgICAgICAgIGxhYmVsOiByZXNwLnJlcXVlc3RUeXBlLm5hbWUKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pKTsKICAgICAgICAgIH0KICAgICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpczQucHJvcHMuaGlkZVNwaW5uZXIoKTsKICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoX3RoaXM0LnByb3BzLnRyYW5zbGF0ZSgncmVhY3Quc3RvY2tNb3ZlbWVudC5lcnJvci5jcmVhdGVTdG9ja01vdmVtZW50LmxhYmVsJywgJ0NvdWxkIG5vdCBjcmVhdGUgc3RvY2sgbW92ZW1lbnQnKSkpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAicmVzZXRUb0luaXRpYWxWYWx1ZXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlc2V0VG9Jbml0aWFsVmFsdWVzKCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgdmFsdWVzOiB7fQogICAgICB9LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIF90aGlzNS5zZXRTdGF0ZSh7CiAgICAgICAgICB2YWx1ZXM6IF90aGlzNS5wcm9wcy5pbml0aWFsVmFsdWVzCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogQ2FsbHMgbWV0aG9kIGNyZWF0aW5nIG9yIHNhdmluZyBzdG9jayBtb3ZlbWVudCBhbmQgbW92ZXMgdXNlciB0byB0aGUgbmV4dCBwYWdlLgogICAgICogQHBhcmFtIHtvYmplY3R9IHZhbHVlcwogICAgICogQHB1YmxpYwogICAgICovCiAgfSwgewogICAga2V5OiAibmV4dFBhZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG5leHRQYWdlKHZhbHVlcykgewogICAgICB2YXIgX3RoaXM2ID0gdGhpczsKICAgICAgdmFyIHNob3dNb2RhbCA9IHRoaXMuY2hlY2tTdG9ja01vdmVtZW50Q2hhbmdlKHZhbHVlcyk7CiAgICAgIGlmICghc2hvd01vZGFsKSB7CiAgICAgICAgdGhpcy5zYXZlU3RvY2tNb3ZlbWVudCh2YWx1ZXMpOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbmZpcm1BbGVydCh7CiAgICAgICAgICB0aXRsZTogdGhpcy5wcm9wcy50cmFuc2xhdGUoJ3JlYWN0LnN0b2NrTW92ZW1lbnQubWVzc2FnZS5jb25maXJtQ2hhbmdlLmxhYmVsJywgJ0NvbmZpcm0gY2hhbmdlJyksCiAgICAgICAgICBtZXNzYWdlOiB0aGlzLnByb3BzLnRyYW5zbGF0ZSgncmVhY3Quc3RvY2tNb3ZlbWVudC5jb25maXJtQ2hhbmdlLm1lc3NhZ2UnLCAnRG8geW91IHdhbnQgdG8gY2hhbmdlIHN0b2NrIG1vdmVtZW50IGRhdGE/IENoYW5naW5nIG9yaWdpbiwgZGVzdGluYXRpb24gb3Igc3RvY2sgbGlzdCBjYW4gY2F1c2UgbG9zcyBvZiB5b3VyIGN1cnJlbnQgd29yaycpLAogICAgICAgICAgYnV0dG9uczogW3sKICAgICAgICAgICAgbGFiZWw6IHRoaXMucHJvcHMudHJhbnNsYXRlKCdyZWFjdC5kZWZhdWx0Lm5vLmxhYmVsJywgJ05vJyksCiAgICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNi5yZXNldFRvSW5pdGlhbFZhbHVlcygpOwogICAgICAgICAgICB9CiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGxhYmVsOiB0aGlzLnByb3BzLnRyYW5zbGF0ZSgncmVhY3QuZGVmYXVsdC55ZXMubGFiZWwnLCAnWWVzJyksCiAgICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNi5zYXZlU3RvY2tNb3ZlbWVudCh2YWx1ZXMpOwogICAgICAgICAgICB9CiAgICAgICAgICB9XQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7CiAgICAgIHZhciBfdGhpczcgPSB0aGlzOwogICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRm9ybSwgewogICAgICAgIG9uU3VibWl0OiBmdW5jdGlvbiBvblN1Ym1pdCh2YWx1ZXMpIHsKICAgICAgICAgIHJldHVybiBfdGhpczcubmV4dFBhZ2UodmFsdWVzKTsKICAgICAgICB9LAogICAgICAgIHZhbGlkYXRlOiB2YWxpZGF0ZSwKICAgICAgICBpbml0aWFsVmFsdWVzOiB0aGlzLnN0YXRlLnZhbHVlcywKICAgICAgICBtdXRhdG9yczogewogICAgICAgICAgY2xlYXJTdG9ja2xpc3Q6IGZ1bmN0aW9uIGNsZWFyU3RvY2tsaXN0KGFyZ3MsIHN0YXRlLCB1dGlscykgewogICAgICAgICAgICB1dGlscy5jaGFuZ2VWYWx1ZShzdGF0ZSwgJ3N0b2NrbGlzdCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9LAogICAgICAgICAgc2V0RGVzdGluYXRpb25WYWx1ZXM6IGZ1bmN0aW9uIHNldERlc3RpbmF0aW9uVmFsdWVzKF9yZWY0LCBzdGF0ZSwgdXRpbHMpIHsKICAgICAgICAgICAgdmFyIF9yZWY1ID0gX3NsaWNlZFRvQXJyYXkoX3JlZjQsIDEpLAogICAgICAgICAgICAgIF9yZWY1JCA9IF9yZWY1WzBdLAogICAgICAgICAgICAgIGlkID0gX3JlZjUkLmlkLAogICAgICAgICAgICAgIG5hbWUgPSBfcmVmNSQubmFtZSwKICAgICAgICAgICAgICBsb2NhdGlvblR5cGUgPSBfcmVmNSQubG9jYXRpb25UeXBlOwogICAgICAgICAgICB2YXIgZGF0YSA9IHsKICAgICAgICAgICAgICBpZDogaWQsCiAgICAgICAgICAgICAgdmFsdWU6IGlkLAogICAgICAgICAgICAgIGxhYmVsOiAiIi5jb25jYXQobmFtZSwgIiBbIikuY29uY2F0KGxvY2F0aW9uVHlwZSA/IGxvY2F0aW9uVHlwZS5kZXNjcmlwdGlvbiA6IG51bGwsICJdIikKICAgICAgICAgICAgfTsKICAgICAgICAgICAgdXRpbHMuY2hhbmdlVmFsdWUoc3RhdGUsICdkZXN0aW5hdGlvbicsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByZXR1cm4gZGF0YTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcihfcmVmNikgewogICAgICAgICAgdmFyIG11dGF0b3JzID0gX3JlZjYuZm9ybS5tdXRhdG9ycywKICAgICAgICAgICAgaGFuZGxlU3VibWl0ID0gX3JlZjYuaGFuZGxlU3VibWl0LAogICAgICAgICAgICB2YWx1ZXMgPSBfcmVmNi52YWx1ZXM7CiAgICAgICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoUmVhY3QuRnJhZ21lbnQsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEFkZERlc3RpbmF0aW9uTW9kYWwsIHsKICAgICAgICAgICAgaXNPcGVuOiBfdGhpczcuc3RhdGUuc2hvd0Rlc3RpbmF0aW9uTW9kYWwsCiAgICAgICAgICAgIG9uQ2xvc2U6IGZ1bmN0aW9uIG9uQ2xvc2UoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBzaG93RGVzdGluYXRpb25Nb2RhbDogZmFsc2UKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb25SZXNwb25zZTogbXV0YXRvcnMuc2V0RGVzdGluYXRpb25WYWx1ZXMKICAgICAgICAgIH0pLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZm9ybSIsIHsKICAgICAgICAgICAgb25TdWJtaXQ6IGhhbmRsZVN1Ym1pdAogICAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICAgICAgY2xhc3NOYW1lOiAiY2xhc3NpYy1mb3JtIHdpdGgtZGVzY3JpcHRpb24iCiAgICAgICAgICB9LCBfLm1hcChGSUVMRFMsIGZ1bmN0aW9uIChmaWVsZENvbmZpZywgZmllbGROYW1lKSB7CiAgICAgICAgICAgIHJldHVybiByZW5kZXJGb3JtRmllbGQoZmllbGRDb25maWcsIGZpZWxkTmFtZSwgewogICAgICAgICAgICAgIHN0b2NrbGlzdHM6IF90aGlzNy5zdGF0ZS5zdG9ja2xpc3RzLAogICAgICAgICAgICAgIGZldGNoU3RvY2tMaXN0czogZnVuY3Rpb24gZmV0Y2hTdG9ja0xpc3RzKG9yaWdpbiwgZGVzdGluYXRpb24pIHsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczcuZmV0Y2hTdG9ja0xpc3RzKG9yaWdpbiwgZGVzdGluYXRpb24sIG11dGF0b3JzLmNsZWFyU3RvY2tsaXN0KTsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIG9yaWdpbjogdmFsdWVzLm9yaWdpbiwKICAgICAgICAgICAgICBkZXN0aW5hdGlvbjogdmFsdWVzLmRlc3RpbmF0aW9uLAogICAgICAgICAgICAgIGlzU3VwZXJ1c2VyOiBfdGhpczcucHJvcHMuaXNTdXBlcnVzZXIsCiAgICAgICAgICAgICAgZGVib3VuY2VkUGVvcGxlRmV0Y2g6IF90aGlzNy5kZWJvdW5jZWRQZW9wbGVGZXRjaCwKICAgICAgICAgICAgICBkZWJvdW5jZWRMb2NhdGlvbnNGZXRjaDogX3RoaXM3LmRlYm91bmNlZExvY2F0aW9uc0ZldGNoLAogICAgICAgICAgICAgIHJlcXVlc3RUeXBlczogX3RoaXM3LnN0YXRlLnJlcXVlc3RUeXBlcywKICAgICAgICAgICAgICBzZXRSZXF1ZXN0VHlwZTogX3RoaXM3LnNldFJlcXVlc3RUeXBlLAogICAgICAgICAgICAgIG9wZW5OZXdMb2NhdGlvbk1vZGFsOiBfdGhpczcub3BlbkFkZERlc3RpbmF0aW9uTW9kYWwsCiAgICAgICAgICAgICAgbG9jYXRpb25UeXBlczogX3RoaXM3LnByb3BzLmxvY2F0aW9uVHlwZXMsCiAgICAgICAgICAgICAgdmFsdWVzOiB2YWx1ZXMKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgICAgIGNsYXNzTmFtZTogInN1Ym1pdC1idXR0b25zIgogICAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIsIHsKICAgICAgICAgICAgdHlwZTogInN1Ym1pdCIsCiAgICAgICAgICAgIGNsYXNzTmFtZTogImJ0biBidG4tb3V0bGluZS1wcmltYXJ5IGZsb2F0LXJpZ2h0IGJ0bi14cyIKICAgICAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyYW5zbGF0ZSwgewogICAgICAgICAgICBpZDogInJlYWN0LmRlZmF1bHQuYnV0dG9uLm5leHQubGFiZWwiLAogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIk5leHQiCiAgICAgICAgICB9KSkpKSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIENyZWF0ZVN0b2NrTW92ZW1lbnQ7Cn0oQ29tcG9uZW50KTsKdmFyIG1hcFN0YXRlVG9Qcm9wcyA9IGZ1bmN0aW9uIG1hcFN0YXRlVG9Qcm9wcyhzdGF0ZSkgewogIHJldHVybiB7CiAgICBsb2NhdGlvbjogc3RhdGUuc2Vzc2lvbi5jdXJyZW50TG9jYXRpb24sCiAgICBpc1N1cGVydXNlcjogc3RhdGUuc2Vzc2lvbi5pc1N1cGVydXNlciwKICAgIHRyYW5zbGF0ZTogdHJhbnNsYXRlV2l0aERlZmF1bHRNZXNzYWdlKGdldFRyYW5zbGF0ZShzdGF0ZS5sb2NhbGl6ZSkpLAogICAgZGVib3VuY2VUaW1lOiBzdGF0ZS5zZXNzaW9uLnNlYXJjaENvbmZpZy5kZWJvdW5jZVRpbWUsCiAgICBtaW5TZWFyY2hMZW5ndGg6IHN0YXRlLnNlc3Npb24uc2VhcmNoQ29uZmlnLm1pblNlYXJjaExlbmd0aCwKICAgIGxvY2F0aW9uVHlwZXM6IHN0YXRlLmxvY2F0aW9uLmxvY2F0aW9uVHlwZXMKICB9Owp9OwpleHBvcnQgZGVmYXVsdCB3aXRoUm91dGVyKGNvbm5lY3QobWFwU3RhdGVUb1Byb3BzLCB7CiAgc2hvd1NwaW5uZXI6IHNob3dTcGlubmVyLAogIGhpZGVTcGlubmVyOiBoaWRlU3Bpbm5lcgp9KShDcmVhdGVTdG9ja01vdmVtZW50KSk7CkNyZWF0ZVN0b2NrTW92ZW1lbnQucHJvcFR5cGVzID0gewogIC8qKiBSZWFjdCByb3V0ZXIncyBvYmplY3Qgd2hpY2ggY29udGFpbnMgaW5mb3JtYXRpb24gYWJvdXQgdXJsIHZhcmFpYWJsZXMgYW5kIHBhcmFtcyAqLwogIG1hdGNoOiBQcm9wVHlwZXMuc2hhcGUoewogICAgcGFyYW1zOiBQcm9wVHlwZXMuc2hhcGUoewogICAgICBzdG9ja01vdmVtZW50SWQ6IFByb3BUeXBlcy5zdHJpbmcKICAgIH0pCiAgfSkuaXNSZXF1aXJlZCwKICAvKiogSW5pdGlhbCBjb21wb25lbnQncyBkYXRhICovCiAgaW5pdGlhbFZhbHVlczogUHJvcFR5cGVzLnNoYXBlKHsKICAgIG9yaWdpbjogUHJvcFR5cGVzLnNoYXBlKHsKICAgICAgaWQ6IFByb3BUeXBlcy5zdHJpbmcKICAgIH0pLAogICAgZGVzdGluYXRpb246IFByb3BUeXBlcy5zaGFwZSh7CiAgICAgIGlkOiBQcm9wVHlwZXMuc3RyaW5nCiAgICB9KSwKICAgIHN0b2NrbGlzdDogUHJvcFR5cGVzLnNoYXBlKHt9KQogIH0pLmlzUmVxdWlyZWQsCiAgLyoqIEZ1bmN0aW9uIGNhbGxlZCB3aGVuIGRhdGEgaXMgbG9hZGluZyAqLwogIHNob3dTcGlubmVyOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLAogIC8qKiBGdW5jdGlvbiBjYWxsZWQgd2hlbiBkYXRhIGhhcyBsb2FkZWQgKi8KICBoaWRlU3Bpbm5lcjogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCwKICAvKioKICAgKiBGdW5jdGlvbiBjYWxsZWQgd2l0aCB0aGUgZm9ybSBkYXRhIHdoZW4gdGhlIGhhbmRsZVN1Ym1pdCgpCiAgICogaXMgZmlyZWQgZnJvbSB3aXRoaW4gdGhlIGZvcm0gY29tcG9uZW50LgogICAqLwogIG5leHRQYWdlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLAogIC8qKiBSZWFjdCByb3V0ZXIncyBvYmplY3QgdXNlZCB0byBtYW5hZ2Ugc2Vzc2lvbiBoaXN0b3J5ICovCiAgaGlzdG9yeTogUHJvcFR5cGVzLnNoYXBlKHsKICAgIHB1c2g6IFByb3BUeXBlcy5mdW5jCiAgfSkuaXNSZXF1aXJlZCwKICAvKiogQ3VycmVudCBsb2NhdGlvbiAqLwogIGxvY2F0aW9uOiBQcm9wVHlwZXMuc2hhcGUoewogICAgbmFtZTogUHJvcFR5cGVzLnN0cmluZywKICAgIGlkOiBQcm9wVHlwZXMuc3RyaW5nLAogICAgbG9jYXRpb25UeXBlOiBQcm9wVHlwZXMuc2hhcGUoewogICAgICBkZXNjcmlwdGlvbjogUHJvcFR5cGVzLnN0cmluZywKICAgICAgbG9jYXRpb25UeXBlQ29kZTogUHJvcFR5cGVzLnN0cmluZwogICAgfSkKICB9KS5pc1JlcXVpcmVkLAogIC8qKiBSZXR1cm4gdHJ1ZSBpZiBjdXJyZW50IHVzZXIgaXMgc3VwZXJ1c2VyICovCiAgaXNTdXBlcnVzZXI6IFByb3BUeXBlcy5ib29sLmlzUmVxdWlyZWQsCiAgdHJhbnNsYXRlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLAogIGRlYm91bmNlVGltZTogUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkLAogIG1pblNlYXJjaExlbmd0aDogUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkLAogIGxvY2F0aW9uVHlwZXM6IFByb3BUeXBlcy5hcnJheU9mKFByb3BUeXBlcy5zaGFwZSh7fSkpLmlzUmVxdWlyZWQKfTs="},null]}