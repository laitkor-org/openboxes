{"remainingRequest":"/opt/MTOBS-BIKASH/node_modules/babel-loader/lib/index.js?presets[]=@babel/react&presets[]=@babel/env!/opt/MTOBS-BIKASH/node_modules/eslint-loader/dist/cjs.js!/opt/MTOBS-BIKASH/src/js/components/invoice/AddItemsPage.jsx","dependencies":[{"path":"/opt/MTOBS-BIKASH/src/js/components/invoice/AddItemsPage.jsx","mtime":1698037748000},{"path":"/opt/MTOBS-BIKASH/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/opt/MTOBS-BIKASH/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/opt/MTOBS-BIKASH/node_modules/eslint-loader/dist/cjs.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsgcmV0dXJuIF90eXBlb2YgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgInN5bWJvbCIgPT0gdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfSwgX3R5cGVvZihvYmopOyB9CmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBlbnVtZXJhYmxlT25seSAmJiAoc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7IH0pKSwga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBudWxsICE9IGFyZ3VtZW50c1tpXSA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpICUgMiA/IG93bktleXMoT2JqZWN0KHNvdXJjZSksICEwKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7IH0pIDogT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpIDogb3duS2V5cyhPYmplY3Qoc291cmNlKSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSByZXR1cm4gdGFyZ2V0OyB9CmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsga2V5ID0gX3RvUHJvcGVydHlLZXkoa2V5KTsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9CmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBfdG9Qcm9wZXJ0eUtleShkZXNjcmlwdG9yLmtleSksIGRlc2NyaXB0b3IpOyB9IH0KZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29uc3RydWN0b3IsICJwcm90b3R5cGUiLCB7IHdyaXRhYmxlOiBmYWxzZSB9KTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9CmZ1bmN0aW9uIF90b1Byb3BlcnR5S2V5KGFyZykgeyB2YXIga2V5ID0gX3RvUHJpbWl0aXZlKGFyZywgInN0cmluZyIpOyByZXR1cm4gX3R5cGVvZihrZXkpID09PSAic3ltYm9sIiA/IGtleSA6IFN0cmluZyhrZXkpOyB9CmZ1bmN0aW9uIF90b1ByaW1pdGl2ZShpbnB1dCwgaGludCkgeyBpZiAoX3R5cGVvZihpbnB1dCkgIT09ICJvYmplY3QiIHx8IGlucHV0ID09PSBudWxsKSByZXR1cm4gaW5wdXQ7IHZhciBwcmltID0gaW5wdXRbU3ltYm9sLnRvUHJpbWl0aXZlXTsgaWYgKHByaW0gIT09IHVuZGVmaW5lZCkgeyB2YXIgcmVzID0gcHJpbS5jYWxsKGlucHV0LCBoaW50IHx8ICJkZWZhdWx0Iik7IGlmIChfdHlwZW9mKHJlcykgIT09ICJvYmplY3QiKSByZXR1cm4gcmVzOyB0aHJvdyBuZXcgVHlwZUVycm9yKCJAQHRvUHJpbWl0aXZlIG11c3QgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlLiIpOyB9IHJldHVybiAoaGludCA9PT0gInN0cmluZyIgPyBTdHJpbmcgOiBOdW1iZXIpKGlucHV0KTsgfQpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzdWJDbGFzcywgInByb3RvdHlwZSIsIHsgd3JpdGFibGU6IGZhbHNlIH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfQpmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2YuYmluZCgpIDogZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfQpmdW5jdGlvbiBfY3JlYXRlU3VwZXIoRGVyaXZlZCkgeyB2YXIgaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCA9IF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKTsgcmV0dXJuIGZ1bmN0aW9uIF9jcmVhdGVTdXBlckludGVybmFsKCkgeyB2YXIgU3VwZXIgPSBfZ2V0UHJvdG90eXBlT2YoRGVyaXZlZCksIHJlc3VsdDsgaWYgKGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QpIHsgdmFyIE5ld1RhcmdldCA9IF9nZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3RvcjsgcmVzdWx0ID0gUmVmbGVjdC5jb25zdHJ1Y3QoU3VwZXIsIGFyZ3VtZW50cywgTmV3VGFyZ2V0KTsgfSBlbHNlIHsgcmVzdWx0ID0gU3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfSByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgcmVzdWx0KTsgfTsgfQpmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikpIHsgcmV0dXJuIGNhbGw7IH0gZWxzZSBpZiAoY2FsbCAhPT0gdm9pZCAwKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkRlcml2ZWQgY29uc3RydWN0b3JzIG1heSBvbmx5IHJldHVybiBvYmplY3Qgb3IgdW5kZWZpbmVkIik7IH0gcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7IH0KZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7IGlmIChzZWxmID09PSB2b2lkIDApIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsgfSByZXR1cm4gc2VsZjsgfQpmdW5jdGlvbiBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCkgeyBpZiAodHlwZW9mIFJlZmxlY3QgPT09ICJ1bmRlZmluZWQiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlOyBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlOyBpZiAodHlwZW9mIFByb3h5ID09PSAiZnVuY3Rpb24iKSByZXR1cm4gdHJ1ZTsgdHJ5IHsgQm9vbGVhbi5wcm90b3R5cGUudmFsdWVPZi5jYWxsKFJlZmxlY3QuY29uc3RydWN0KEJvb2xlYW4sIFtdLCBmdW5jdGlvbiAoKSB7fSkpOyByZXR1cm4gdHJ1ZTsgfSBjYXRjaCAoZSkgeyByZXR1cm4gZmFsc2U7IH0gfQpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YuYmluZCgpIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfQppbXBvcnQgUmVhY3QsIHsgQ29tcG9uZW50IH0gZnJvbSAncmVhY3QnOwppbXBvcnQgYXJyYXlNdXRhdG9ycyBmcm9tICdmaW5hbC1mb3JtLWFycmF5cyc7CmltcG9ydCB1cGRhdGUgZnJvbSAnaW1tdXRhYmlsaXR5LWhlbHBlcic7CmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7CmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7CmltcG9ydCB7IEZvcm0gfSBmcm9tICdyZWFjdC1maW5hbC1mb3JtJzsKaW1wb3J0IHsgY29ubmVjdCB9IGZyb20gJ3JlYWN0LXJlZHV4JzsKaW1wb3J0IHsgaGlkZVNwaW5uZXIsIHNob3dTcGlubmVyIH0gZnJvbSAnYWN0aW9ucyc7CmltcG9ydCBBcnJheUZpZWxkIGZyb20gJ2NvbXBvbmVudHMvZm9ybS1lbGVtZW50cy9BcnJheUZpZWxkJzsKaW1wb3J0IEJ1dHRvbkZpZWxkIGZyb20gJ2NvbXBvbmVudHMvZm9ybS1lbGVtZW50cy9CdXR0b25GaWVsZCc7CmltcG9ydCBMYWJlbEZpZWxkIGZyb20gJ2NvbXBvbmVudHMvZm9ybS1lbGVtZW50cy9MYWJlbEZpZWxkJzsKaW1wb3J0IFRleHRGaWVsZCBmcm9tICdjb21wb25lbnRzL2Zvcm0tZWxlbWVudHMvVGV4dEZpZWxkJzsKaW1wb3J0IEludm9pY2VJdGVtc01vZGFsIGZyb20gJ2NvbXBvbmVudHMvaW52b2ljZS9JbnZvaWNlSXRlbXNNb2RhbCc7CmltcG9ydCBhcGlDbGllbnQgZnJvbSAndXRpbHMvYXBpQ2xpZW50JzsKaW1wb3J0IHsgcmVuZGVyRm9ybUZpZWxkIH0gZnJvbSAndXRpbHMvZm9ybS11dGlscyc7CmltcG9ydCB7IGdldEludm9pY2VEZXNjcmlwdGlvbiB9IGZyb20gJ3V0aWxzL2Zvcm0tdmFsdWVzLXV0aWxzJzsKaW1wb3J0IGFjY291bnRpbmdGb3JtYXQgZnJvbSAndXRpbHMvbnVtYmVyLXV0aWxzJzsKaW1wb3J0IFRyYW5zbGF0ZSBmcm9tICd1dGlscy9UcmFuc2xhdGUnOwp2YXIgREVMRVRFX0JVVFRPTl9GSUVMRCA9IHsKICB0eXBlOiBCdXR0b25GaWVsZCwKICBsYWJlbDogJ3JlYWN0LmRlZmF1bHQuYnV0dG9uLmRlbGV0ZS5sYWJlbCcsCiAgZGVmYXVsdE1lc3NhZ2U6ICdEZWxldGUnLAogIGZsZXhXaWR0aDogJzEnLAogIGZpZWxkS2V5OiAnJywKICBidXR0b25MYWJlbDogJ3JlYWN0LmRlZmF1bHQuYnV0dG9uLmRlbGV0ZS5sYWJlbCcsCiAgYnV0dG9uRGVmYXVsdE1lc3NhZ2U6ICdEZWxldGUnLAogIGdldER5bmFtaWNBdHRyOiBmdW5jdGlvbiBnZXREeW5hbWljQXR0cihfcmVmKSB7CiAgICB2YXIgZmllbGRWYWx1ZSA9IF9yZWYuZmllbGRWYWx1ZSwKICAgICAgcmVtb3ZlSXRlbSA9IF9yZWYucmVtb3ZlSXRlbSwKICAgICAgdXBkYXRlVG90YWxDb3VudCA9IF9yZWYudXBkYXRlVG90YWxDb3VudCwKICAgICAgdmFsdWVzID0gX3JlZi52YWx1ZXMsCiAgICAgIHJvd0luZGV4ID0gX3JlZi5yb3dJbmRleDsKICAgIHJldHVybiB7CiAgICAgIG9uQ2xpY2s6IGZpZWxkVmFsdWUgJiYgZmllbGRWYWx1ZS5pZCA/IGZ1bmN0aW9uICgpIHsKICAgICAgICByZW1vdmVJdGVtKGZpZWxkVmFsdWUuaWQsIHZhbHVlcywgcm93SW5kZXgpOwogICAgICAgIHVwZGF0ZVRvdGFsQ291bnQoLTEpOwogICAgICB9IDogZnVuY3Rpb24gKCkgewogICAgICAgIHVwZGF0ZVRvdGFsQ291bnQoLTEpOwogICAgICB9CiAgICB9OwogIH0sCiAgYXR0cmlidXRlczogewogICAgY2xhc3NOYW1lOiAnYnRuIGJ0bi1vdXRsaW5lLWRhbmdlcicKICB9Cn07CnZhciBGSUVMRFMgPSB7CiAgaW52b2ljZUl0ZW1zOiB7CiAgICB0eXBlOiBBcnJheUZpZWxkLAogICAgdmlydHVhbGl6ZWQ6IHRydWUsCiAgICB0b3RhbENvdW50OiBmdW5jdGlvbiB0b3RhbENvdW50KF9yZWYyKSB7CiAgICAgIHZhciBfdG90YWxDb3VudCA9IF9yZWYyLnRvdGFsQ291bnQ7CiAgICAgIHJldHVybiBfdG90YWxDb3VudDsKICAgIH0sCiAgICBpc1Jvd0xvYWRlZDogZnVuY3Rpb24gaXNSb3dMb2FkZWQoX3JlZjMpIHsKICAgICAgdmFyIF9pc1Jvd0xvYWRlZCA9IF9yZWYzLmlzUm93TG9hZGVkOwogICAgICByZXR1cm4gX2lzUm93TG9hZGVkOwogICAgfSwKICAgIGxvYWRNb3JlUm93czogZnVuY3Rpb24gbG9hZE1vcmVSb3dzKF9yZWY0KSB7CiAgICAgIHZhciBfbG9hZE1vcmVSb3dzID0gX3JlZjQubG9hZE1vcmVSb3dzOwogICAgICByZXR1cm4gX2xvYWRNb3JlUm93cygpOwogICAgfSwKICAgIGlzRmlyc3RQYWdlTG9hZGVkOiBmdW5jdGlvbiBpc0ZpcnN0UGFnZUxvYWRlZChfcmVmNSkgewogICAgICB2YXIgX2lzRmlyc3RQYWdlTG9hZGVkID0gX3JlZjUuaXNGaXJzdFBhZ2VMb2FkZWQ7CiAgICAgIHJldHVybiBfaXNGaXJzdFBhZ2VMb2FkZWQ7CiAgICB9LAogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0L3Byb3AtdHlwZXMKICAgIGFkZEJ1dHRvbjogZnVuY3Rpb24gYWRkQnV0dG9uKF9yZWY2KSB7CiAgICAgIHZhciB2YWx1ZXMgPSBfcmVmNi52YWx1ZXMsCiAgICAgICAgbG9hZE1vcmVSb3dzID0gX3JlZjYubG9hZE1vcmVSb3dzLAogICAgICAgIHNhdmVJbnZvaWNlSXRlbXMgPSBfcmVmNi5zYXZlSW52b2ljZUl0ZW1zOwogICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoSW52b2ljZUl0ZW1zTW9kYWwsIHsKICAgICAgICBidG5PcGVuVGV4dDogInJlYWN0LmRlZmF1bHQuYnV0dG9uLmFkZExpbmVzLmxhYmVsIiwKICAgICAgICBidG5PcGVuRGVmYXVsdFRleHQ6ICJBZGQgbGluZXMiLAogICAgICAgIG9uT3BlbjogZnVuY3Rpb24gb25PcGVuKCkgewogICAgICAgICAgcmV0dXJuIHNhdmVJbnZvaWNlSXRlbXModmFsdWVzKTsKICAgICAgICB9LAogICAgICAgIGludm9pY2VJZDogdmFsdWVzLmlkLAogICAgICAgIG9uUmVzcG9uc2U6IGxvYWRNb3JlUm93cwogICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUcmFuc2xhdGUsIHsKICAgICAgICBpZDogInJlYWN0LmRlZmF1bHQuYnV0dG9uLmFkZExpbmUubGFiZWwiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiQWRkIGxpbmUiCiAgICAgIH0pKTsKICAgIH0sCiAgICBmaWVsZHM6IHsKICAgICAgb3JkZXJOdW1iZXI6IHsKICAgICAgICB0eXBlOiBMYWJlbEZpZWxkLAogICAgICAgIGxhYmVsOiAncmVhY3QuaW52b2ljZS5vcmRlck51bWJlci5sYWJlbCcsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdQTyBOdW1iZXInLAogICAgICAgIGZsZXhXaWR0aDogJzEnLAogICAgICAgIGdldER5bmFtaWNBdHRyOiBmdW5jdGlvbiBnZXREeW5hbWljQXR0cihfcmVmNykgewogICAgICAgICAgdmFyIHZhbHVlcyA9IF9yZWY3LnZhbHVlcywKICAgICAgICAgICAgcm93SW5kZXggPSBfcmVmNy5yb3dJbmRleDsKICAgICAgICAgIHZhciBvcmRlcklkID0gdmFsdWVzICYmIHZhbHVlcy5pbnZvaWNlSXRlbXMgJiYgdmFsdWVzLmludm9pY2VJdGVtc1tyb3dJbmRleF0gJiYgdmFsdWVzLmludm9pY2VJdGVtc1tyb3dJbmRleF0ub3JkZXJJZDsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHVybDogb3JkZXJJZCA/ICIvb3BlbmJveGVzL29yZGVyL3Nob3cvIi5jb25jYXQob3JkZXJJZCkgOiAnJwogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHNoaXBtZW50TnVtYmVyOiB7CiAgICAgICAgdHlwZTogTGFiZWxGaWVsZCwKICAgICAgICBsYWJlbDogJ3JlYWN0Lmludm9pY2Uuc2hpcG1lbnROdW1iZXIubGFiZWwnLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnU2hpcG1lbnQgTnVtYmVyJywKICAgICAgICBmbGV4V2lkdGg6ICcxJywKICAgICAgICBnZXREeW5hbWljQXR0cjogZnVuY3Rpb24gZ2V0RHluYW1pY0F0dHIoX3JlZjgpIHsKICAgICAgICAgIHZhciB2YWx1ZXMgPSBfcmVmOC52YWx1ZXMsCiAgICAgICAgICAgIHJvd0luZGV4ID0gX3JlZjgucm93SW5kZXg7CiAgICAgICAgICB2YXIgc2hpcG1lbnRJZCA9IHZhbHVlcyAmJiB2YWx1ZXMuaW52b2ljZUl0ZW1zICYmIHZhbHVlcy5pbnZvaWNlSXRlbXNbcm93SW5kZXhdICYmIHZhbHVlcy5pbnZvaWNlSXRlbXNbcm93SW5kZXhdLnNoaXBtZW50SWQ7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICB1cmw6IHNoaXBtZW50SWQgPyAiL29wZW5ib3hlcy9zdG9ja01vdmVtZW50L3Nob3cvIi5jb25jYXQoc2hpcG1lbnRJZCkgOiAnJwogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGJ1ZGdldENvZGU6IHsKICAgICAgICB0eXBlOiBMYWJlbEZpZWxkLAogICAgICAgIGxhYmVsOiAncmVhY3QuaW52b2ljZS5idWRnZXRDb2RlLmxhYmVsJywKICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0J1ZGdldCBDb2RlJywKICAgICAgICBmbGV4V2lkdGg6ICcxJwogICAgICB9LAogICAgICBnbENvZGU6IHsKICAgICAgICB0eXBlOiBMYWJlbEZpZWxkLAogICAgICAgIGxhYmVsOiAncmVhY3QuaW52b2ljZS5nbENvZGUubGFiZWwnLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnR0wgQ29kZScsCiAgICAgICAgZmxleFdpZHRoOiAnMScKICAgICAgfSwKICAgICAgcHJvZHVjdENvZGU6IHsKICAgICAgICB0eXBlOiBMYWJlbEZpZWxkLAogICAgICAgIGxhYmVsOiAncmVhY3QuaW52b2ljZS5pdGVtTm8ubGFiZWwnLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnSXRlbSBObycsCiAgICAgICAgZmxleFdpZHRoOiAnMScKICAgICAgfSwKICAgICAgZGVzY3JpcHRpb246IHsKICAgICAgICB0eXBlOiBMYWJlbEZpZWxkLAogICAgICAgIGxhYmVsOiAncmVhY3QuaW52b2ljZS5kZXNjcmlwdGlvbi5sYWJlbCcsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdEZXNjcmlwdGlvbicsCiAgICAgICAgZmxleFdpZHRoOiAnNScsCiAgICAgICAgYXR0cmlidXRlczogewogICAgICAgICAgY2xhc3NOYW1lOiAndGV4dC1sZWZ0JwogICAgICAgIH0sCiAgICAgICAgZ2V0RHluYW1pY0F0dHI6IGZ1bmN0aW9uIGdldER5bmFtaWNBdHRyKHBhcmFtcykgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgZm9ybWF0VmFsdWU6IGZ1bmN0aW9uIGZvcm1hdFZhbHVlKCkgewogICAgICAgICAgICAgIHZhciBfdmFsdWVzJGludm9pY2VJdGVtczsKICAgICAgICAgICAgICB2YXIgdmFsdWVzID0gcGFyYW1zLnZhbHVlcywKICAgICAgICAgICAgICAgIHJvd0luZGV4ID0gcGFyYW1zLnJvd0luZGV4OwogICAgICAgICAgICAgIHZhciByb3dWYWx1ZSA9IHZhbHVlcyA9PT0gbnVsbCB8fCB2YWx1ZXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfdmFsdWVzJGludm9pY2VJdGVtcyA9IHZhbHVlcy5pbnZvaWNlSXRlbXMpID09PSBudWxsIHx8IF92YWx1ZXMkaW52b2ljZUl0ZW1zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdmFsdWVzJGludm9pY2VJdGVtc1tyb3dJbmRleF07CiAgICAgICAgICAgICAgLy8gSWYgaXQncyBub3QgYW4gYWRqdXN0bWVudCwgYnV0IHByb2R1Y3QsIGFuZCBpdCBoYXMgYSBzeW5vbnltLCBkaXNwbGF5IGl0CiAgICAgICAgICAgICAgLy8gd2l0aCBhIHRvb2x0aXAgd2l0aCB0aGUgb3JpZ2luYWwgbmFtZSBvZiB0aGUgcHJvZHVjdAogICAgICAgICAgICAgIHJldHVybiBnZXRJbnZvaWNlRGVzY3JpcHRpb24ocm93VmFsdWUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgcXVhbnRpdHk6IHsKICAgICAgICB0eXBlOiBUZXh0RmllbGQsCiAgICAgICAgbGFiZWw6ICdyZWFjdC5pbnZvaWNlLnF0eS5sYWJlbCcsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdRdHknLAogICAgICAgIGZsZXhXaWR0aDogJzEnLAogICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICAgIHR5cGU6ICdudW1iZXInLAogICAgICAgICAgc2hvd0Vycm9yOiB0cnVlCiAgICAgICAgfSwKICAgICAgICBnZXREeW5hbWljQXR0cjogZnVuY3Rpb24gZ2V0RHluYW1pY0F0dHIoX3JlZjkpIHsKICAgICAgICAgIHZhciByb3dJbmRleCA9IF9yZWY5LnJvd0luZGV4LAogICAgICAgICAgICB2YWx1ZXMgPSBfcmVmOS52YWx1ZXMsCiAgICAgICAgICAgIHVwZGF0ZVJvdyA9IF9yZWY5LnVwZGF0ZVJvdzsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIG9uQmx1cjogZnVuY3Rpb24gb25CbHVyKCkgewogICAgICAgICAgICAgIHJldHVybiB1cGRhdGVSb3codmFsdWVzLCByb3dJbmRleCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9LAogICAgICB1b206IHsKICAgICAgICB0eXBlOiBMYWJlbEZpZWxkLAogICAgICAgIGxhYmVsOiAncmVhY3QuaW52b2ljZS51b20ubGFiZWwnLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVU9NJywKICAgICAgICBmbGV4V2lkdGg6ICcxJwogICAgICB9LAogICAgICB1bml0UHJpY2U6IHsKICAgICAgICB0eXBlOiBMYWJlbEZpZWxkLAogICAgICAgIGxhYmVsOiAncmVhY3QuaW52b2ljZS51bml0UHJpY2UubGFiZWwnLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVW5pdCBQcmljZScsCiAgICAgICAgZmxleFdpZHRoOiAnMScsCiAgICAgICAgYXR0cmlidXRlczogewogICAgICAgICAgZm9ybWF0VmFsdWU6IGZ1bmN0aW9uIGZvcm1hdFZhbHVlKHZhbHVlKSB7CiAgICAgICAgICAgIHJldHVybiB2YWx1ZSA/IGFjY291bnRpbmdGb3JtYXQodmFsdWUpIDogdmFsdWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICB0b3RhbEFtb3VudDogewogICAgICAgIHR5cGU6IExhYmVsRmllbGQsCiAgICAgICAgbGFiZWw6ICdyZWFjdC5pbnZvaWNlLnRvdGFsUHJpY2UubGFiZWwnLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVG90YWwgUHJpY2UnLAogICAgICAgIGZsZXhXaWR0aDogJzEnLAogICAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICAgIGZvcm1hdFZhbHVlOiBmdW5jdGlvbiBmb3JtYXRWYWx1ZSh2YWx1ZSkgewogICAgICAgICAgICByZXR1cm4gdmFsdWUgPyBhY2NvdW50aW5nRm9ybWF0KHZhbHVlKSA6IHZhbHVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgZGVsZXRlQnV0dG9uOiBERUxFVEVfQlVUVE9OX0ZJRUxECiAgICB9CiAgfQp9Owp2YXIgQWRkSXRlbXNQYWdlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29tcG9uZW50KSB7CiAgX2luaGVyaXRzKEFkZEl0ZW1zUGFnZSwgX0NvbXBvbmVudCk7CiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihBZGRJdGVtc1BhZ2UpOwogIGZ1bmN0aW9uIEFkZEl0ZW1zUGFnZShwcm9wcykgewogICAgdmFyIF90aGlzOwogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEFkZEl0ZW1zUGFnZSk7CiAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKTsKICAgIF90aGlzLnN0YXRlID0gewogICAgICB2YWx1ZXM6IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgX3RoaXMucHJvcHMuaW5pdGlhbFZhbHVlcyksIHt9LCB7CiAgICAgICAgaW52b2ljZUl0ZW1zOiBbXSwKICAgICAgICB0b3RhbFZhbHVlOiAwCiAgICAgIH0pLAogICAgICBpc0ZpcnN0UGFnZUxvYWRlZDogZmFsc2UKICAgIH07CiAgICBfdGhpcy5pc1Jvd0xvYWRlZCA9IF90aGlzLmlzUm93TG9hZGVkLmJpbmQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcykpOwogICAgX3RoaXMubG9hZE1vcmVSb3dzID0gX3RoaXMubG9hZE1vcmVSb3dzLmJpbmQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcykpOwogICAgX3RoaXMudXBkYXRlVG90YWxDb3VudCA9IF90aGlzLnVwZGF0ZVRvdGFsQ291bnQuYmluZChfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSk7CiAgICBfdGhpcy5yZW1vdmVJdGVtID0gX3RoaXMucmVtb3ZlSXRlbS5iaW5kKF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpKTsKICAgIF90aGlzLnVwZGF0ZVJvdyA9IF90aGlzLnVwZGF0ZVJvdy5iaW5kKF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpKTsKICAgIF90aGlzLnNhdmVJbnZvaWNlSXRlbXMgPSBfdGhpcy5zYXZlSW52b2ljZUl0ZW1zLmJpbmQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcykpOwogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgLyoqCiAgICogU2V0cyBzdGF0ZSBvZiBpbnZvaWNlIGl0ZW1zIGFmdGVyIGZldGNoIGFuZCBjYWxscyBtZXRob2QgdG8gZmV0Y2ggbmV4dCBpdGVtcwogICAqIEBwYXJhbSB7c3RyaW5nfSBzdGFydEluZGV4CiAgICogQHB1YmxpYwogICAqLwogIF9jcmVhdGVDbGFzcyhBZGRJdGVtc1BhZ2UsIFt7CiAgICBrZXk6ICJzZXRJbnZvaWNlSXRlbXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldEludm9pY2VJdGVtcyhyZXNwb25zZSwgc3RhcnRJbmRleCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKICAgICAgdGhpcy5wcm9wcy5zaG93U3Bpbm5lcigpOwogICAgICB2YXIgX3Jlc3BvbnNlJGRhdGEgPSByZXNwb25zZS5kYXRhLAogICAgICAgIGRhdGEgPSBfcmVzcG9uc2UkZGF0YS5kYXRhLAogICAgICAgIHRvdGFsQ291bnQgPSBfcmVzcG9uc2UkZGF0YS50b3RhbENvdW50OwogICAgICB2YXIgaW52b2ljZUl0ZW1zID0gXy5pc051bGwoc3RhcnRJbmRleCkgfHwgc3RhcnRJbmRleCA9PT0gMCA/IGRhdGEgOiBfLnVuaXFCeShfLmNvbmNhdCh0aGlzLnN0YXRlLnZhbHVlcy5pbnZvaWNlSXRlbXMsIGRhdGEpLCAnaWQnKTsKICAgICAgdmFyIHRvdGFsVmFsdWUgPSBfLnJlZHVjZShpbnZvaWNlSXRlbXMsIGZ1bmN0aW9uIChzdW0sIHZhbCkgewogICAgICAgIHJldHVybiBzdW0gKyAodmFsLnRvdGFsQW1vdW50ID8gcGFyc2VGbG9hdCh2YWwudG90YWxBbW91bnQpIDogMC4wKTsKICAgICAgfSwgMCk7CiAgICAgIHRoaXMuc2V0U3RhdGUoewogICAgICAgIHZhbHVlczogX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCB0aGlzLnN0YXRlLnZhbHVlcyksIHt9LCB7CiAgICAgICAgICBpbnZvaWNlSXRlbXM6IGludm9pY2VJdGVtcywKICAgICAgICAgIHRvdGFsQ291bnQ6IHRvdGFsQ291bnQsCiAgICAgICAgICB0b3RhbFZhbHVlOiB0b3RhbFZhbHVlCiAgICAgICAgfSkKICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgIGlmICghXy5pc051bGwoc3RhcnRJbmRleCkgJiYgX3RoaXMyLnN0YXRlLnZhbHVlcy5pbnZvaWNlSXRlbXMubGVuZ3RoICE9PSBfdGhpczIuc3RhdGUudmFsdWVzLnRvdGFsQ291bnQpIHsKICAgICAgICAgIF90aGlzMi5sb2FkTW9yZVJvd3MoewogICAgICAgICAgICBzdGFydEluZGV4OiBzdGFydEluZGV4ICsgX3RoaXMyLnByb3BzLnBhZ2VTaXplCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgX3RoaXMyLnByb3BzLmhpZGVTcGlubmVyKCk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogQ2hlY2tzIGlmIHJvdyBpcyBsb2FkZWQsIG5lZWRlZCBmb3IgcGFnaW5hdGlvbgogICAgICogQHBhcmFtIHtzdHJpbmd9IGluZGV4CiAgICAgKiBAcHVibGljCiAgICAgKi8KICB9LCB7CiAgICBrZXk6ICJpc1Jvd0xvYWRlZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaXNSb3dMb2FkZWQoX3JlZjEwKSB7CiAgICAgIHZhciBpbmRleCA9IF9yZWYxMC5pbmRleDsKICAgICAgcmV0dXJuICEhdGhpcy5zdGF0ZS52YWx1ZXMuaW52b2ljZUl0ZW1zW2luZGV4XTsKICAgIH0KCiAgICAvKioKICAgICAqIExvYWRzIG1vcmUgcm93cywgbmVlZGVkIGZvciBwYWdpbmF0aW9uCiAgICAgKiBAcGFyYW0ge2luZGV4fSBzdGFydEluZGV4CiAgICAgKiBAcHVibGljCiAgICAgKi8KICB9LCB7CiAgICBrZXk6ICJsb2FkTW9yZVJvd3MiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWRNb3JlUm93cyhfcmVmMTEpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CiAgICAgIHZhciBzdGFydEluZGV4ID0gX3JlZjExLnN0YXJ0SW5kZXg7CiAgICAgIHRoaXMuc2V0U3RhdGUoewogICAgICAgIGlzRmlyc3RQYWdlTG9hZGVkOiB0cnVlCiAgICAgIH0pOwogICAgICB2YXIgdXJsID0gIi9vcGVuYm94ZXMvYXBpL2ludm9pY2VzLyIuY29uY2F0KHRoaXMuc3RhdGUudmFsdWVzLmlkLCAiL2l0ZW1zP29mZnNldD0iKS5jb25jYXQoc3RhcnRJbmRleCwgIiZtYXg9IikuY29uY2F0KHRoaXMucHJvcHMucGFnZVNpemUpOwogICAgICBhcGlDbGllbnQuZ2V0KHVybCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpczMuc2V0SW52b2ljZUl0ZW1zKHJlc3BvbnNlLCBzdGFydEluZGV4KTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBVcGRhdGVzIHRvdGFsIGNvdW50IG9mIGl0ZW1zIGFmdGVyIHJlbW92aW5nIGl0ZW0KICAgICAqIEBwYXJhbSB7aW50ZWdlcn0gdmFsdWUKICAgICAqIEBwdWJsaWMKICAgICAqLwogIH0sIHsKICAgIGtleTogInVwZGF0ZVRvdGFsQ291bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZVRvdGFsQ291bnQodmFsdWUpIHsKICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgdmFsdWVzOiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHRoaXMuc3RhdGUudmFsdWVzKSwge30sIHsKICAgICAgICAgIHRvdGFsQ291bnQ6IHRoaXMuc3RhdGUudmFsdWVzLnRvdGFsQ291bnQgKyB2YWx1ZQogICAgICAgIH0pCiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogVXBkYXRlcyByb3cgYWZ0ZXIgY2hhbmdpbmcgdmFsdWUKICAgICAqIEBwYXJhbSB7aW50ZWdlcn0gdmFsdWUKICAgICAqIEBwYXJhbSB7c3RyaW5nfSBpbmRleAogICAgICogQHB1YmxpYwogICAgICovCiAgfSwgewogICAga2V5OiAidXBkYXRlUm93IiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVSb3codmFsdWVzLCBpbmRleCkgewogICAgICB2YXIgaXRlbSA9IHZhbHVlcy5pbnZvaWNlSXRlbXNbaW5kZXhdOwogICAgICB0aGlzLnNldFN0YXRlKHsKICAgICAgICB2YWx1ZXM6IHVwZGF0ZSh2YWx1ZXMsIHsKICAgICAgICAgIGludm9pY2VJdGVtczogX2RlZmluZVByb3BlcnR5KHt9LCBpbmRleCwgewogICAgICAgICAgICAkc2V0OiBpdGVtCiAgICAgICAgICB9KQogICAgICAgIH0pCiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogU2F2ZXMgaW52b2ljZSBpdGVtcwogICAgICogQHBhcmFtIHtvYmplY3R9IHZhbHVlcwogICAgICogQHB1YmxpYwogICAgICovCiAgfSwgewogICAga2V5OiAic2F2ZUludm9pY2VJdGVtcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2F2ZUludm9pY2VJdGVtcyh2YWx1ZXMpIHsKICAgICAgdmFyIHVybCA9ICIvb3BlbmJveGVzL2FwaS9pbnZvaWNlcy8iLmNvbmNhdCh0aGlzLnN0YXRlLnZhbHVlcy5pZCwgIi9pdGVtcyIpOwogICAgICB2YXIgcGF5bG9hZCA9IHsKICAgICAgICBpZDogdmFsdWVzLmlkLAogICAgICAgIGludm9pY2VJdGVtczogXy5tYXAodmFsdWVzLmludm9pY2VJdGVtcywgZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGlkOiBpdGVtLmlkLAogICAgICAgICAgICBxdWFudGl0eTogXy50b0ludGVnZXIoaXRlbS5xdWFudGl0eSkKICAgICAgICAgIH07CiAgICAgICAgfSkKICAgICAgfTsKICAgICAgaWYgKHBheWxvYWQuaW52b2ljZUl0ZW1zLmxlbmd0aCkgewogICAgICAgIHJldHVybiBhcGlDbGllbnQucG9zdCh1cmwsIHBheWxvYWQpWyJjYXRjaCJdKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ3JlYWN0Lmludm9pY2UuZXJyb3Iuc2F2ZUludm9pY2VJdGVtcy5sYWJlbCcpKTsKICAgICAgICB9KTsKICAgICAgfQogICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTYXZlcyBpbnZvaWNlcyBpdGVtcyBhbmQgZ29lcyB0byB0aGUgbmV4dCBzdGVwLgogICAgICogQHBhcmFtIHtvYmplY3R9IHZhbHVlcwogICAgICogQHB1YmxpYwogICAgICovCiAgfSwgewogICAga2V5OiAibmV4dFBhZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG5leHRQYWdlKHZhbHVlcykgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKICAgICAgdGhpcy5zYXZlSW52b2ljZUl0ZW1zKHZhbHVlcykudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXM0LnByb3BzLm5leHRQYWdlKHZhbHVlcyk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogU2F2ZXMgaW52b2ljZXMgaXRlbXMgYW5kIGdvZXMgdG8gdGhlIHByZXZpb3VzIHN0ZXAuCiAgICAgKiBAcGFyYW0ge29iamVjdH0gdmFsdWVzCiAgICAgKiBAcHVibGljCiAgICAgKi8KICB9LCB7CiAgICBrZXk6ICJwcmV2aW91c1BhZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHByZXZpb3VzUGFnZSh2YWx1ZXMpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CiAgICAgIHRoaXMuc2F2ZUludm9pY2VJdGVtcyh2YWx1ZXMpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzNS5wcm9wcy5wcmV2aW91c1BhZ2UodmFsdWVzKTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZW1vdmVzIGNob3NlbiBpdGVtIGZyb20gaXRlbXMgbGlzdC4KICAgICAqIEBwYXJhbSB7c3RyaW5nfSBpdGVtSWQKICAgICAqIEBwdWJsaWMKICAgICAqLwogIH0sIHsKICAgIGtleTogInJlbW92ZUl0ZW0iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZUl0ZW0oaXRlbUlkLCB2YWx1ZXMsIGluZGV4KSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwogICAgICB2YXIgcmVtb3ZlSXRlbXNVcmwgPSAiL29wZW5ib3hlcy9hcGkvaW52b2ljZXMvIi5jb25jYXQoaXRlbUlkLCAiL3JlbW92ZUl0ZW0iKTsKICAgICAgdmFyIGl0ZW0gPSB2YWx1ZXMuaW52b2ljZUl0ZW1zW2luZGV4XTsKICAgICAgdmFyIG5ld1RvdGFsVmFsdWUgPSBwYXJzZUZsb2F0KHRoaXMuc3RhdGUudmFsdWVzLnRvdGFsVmFsdWUpIC0gcGFyc2VGbG9hdChpdGVtLnRvdGFsQW1vdW50KTsKICAgICAgcmV0dXJuIGFwaUNsaWVudFsiZGVsZXRlIl0ocmVtb3ZlSXRlbXNVcmwpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzNi5zZXRTdGF0ZSh7CiAgICAgICAgICB2YWx1ZXM6IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgX3RoaXM2LnN0YXRlLnZhbHVlcyksIHt9LCB7CiAgICAgICAgICAgIGludm9pY2VJdGVtczogdXBkYXRlKF90aGlzNi5zdGF0ZS52YWx1ZXMuaW52b2ljZUl0ZW1zLCB7CiAgICAgICAgICAgICAgJHNwbGljZTogW1tpbmRleCwgMV1dCiAgICAgICAgICAgIH0pLAogICAgICAgICAgICB0b3RhbFZhbHVlOiBuZXdUb3RhbFZhbHVlCiAgICAgICAgICB9KQogICAgICAgIH0pOwogICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXM2LnByb3BzLmhpZGVTcGlubmVyKCk7CiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcigncmVhY3QuaW52b2ljZS5lcnJvci5kZWxldGVJbnZvaWNlSXRlbS5sYWJlbCcpKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAic2F2ZUFuZEV4aXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNhdmVBbmRFeGl0KGZvcm1WYWx1ZXMpIHsKICAgICAgdmFyIF90aGlzNyA9IHRoaXM7CiAgICAgIHRoaXMuc2F2ZUludm9pY2VJdGVtcyhmb3JtVmFsdWVzKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICB3aW5kb3cubG9jYXRpb24gPSAiL29wZW5ib3hlcy9pbnZvaWNlL3Nob3cvIi5jb25jYXQoZm9ybVZhbHVlcy5pZCk7CiAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gX3RoaXM3LnByb3BzLmhpZGVTcGlubmVyKCk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkgewogICAgICB2YXIgX3RoaXM4ID0gdGhpczsKICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEZvcm0sIHsKICAgICAgICBvblN1Ym1pdDogZnVuY3Rpb24gb25TdWJtaXQoKSB7fSwKICAgICAgICBtdXRhdG9yczogX29iamVjdFNwcmVhZCh7fSwgYXJyYXlNdXRhdG9ycyksCiAgICAgICAgaW5pdGlhbFZhbHVlczogdGhpcy5zdGF0ZS52YWx1ZXMsCiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoX3JlZjEyKSB7CiAgICAgICAgICB2YXIgaGFuZGxlU3VibWl0ID0gX3JlZjEyLmhhbmRsZVN1Ym1pdCwKICAgICAgICAgICAgdmFsdWVzID0gX3JlZjEyLnZhbHVlczsKICAgICAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgICBjbGFzc05hbWU6ICJkLWZsZXggZmxleC1jb2x1bW4iCiAgICAgICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIHsKICAgICAgICAgICAgY2xhc3NOYW1lOiAiYnV0dG9ucy1jb250YWluZXIiCiAgICAgICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiYnV0dG9uIiwgewogICAgICAgICAgICB0eXBlOiAiYnV0dG9uIiwKICAgICAgICAgICAgY2xhc3NOYW1lOiAiYnRuIGJ0bi1vdXRsaW5lLXNlY29uZGFyeSBmbG9hdC1yaWdodCBidG4tZm9ybSBidG4teHMiLAogICAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICAgIHJldHVybiBfdGhpczguc2F2ZUFuZEV4aXQodmFsdWVzKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiaSIsIHsKICAgICAgICAgICAgY2xhc3NOYW1lOiAiZmEgZmEtc2lnbi1vdXQgcHItMiIKICAgICAgICAgIH0pLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUcmFuc2xhdGUsIHsKICAgICAgICAgICAgaWQ6ICJyZWFjdC5kZWZhdWx0LmJ1dHRvbi5zYXZlQW5kRXhpdC5sYWJlbCIsCiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiU2F2ZSBhbmQgZXhpdCIKICAgICAgICAgIH0pKSkpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZm9ybSIsIHsKICAgICAgICAgICAgb25TdWJtaXQ6IGhhbmRsZVN1Ym1pdAogICAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICAgICAgY2xhc3NOYW1lOiAidGFibGUtZm9ybSIKICAgICAgICAgIH0sIF8ubWFwKEZJRUxEUywgZnVuY3Rpb24gKGZpZWxkQ29uZmlnLCBmaWVsZE5hbWUpIHsKICAgICAgICAgICAgcmV0dXJuIHJlbmRlckZvcm1GaWVsZChmaWVsZENvbmZpZywgZmllbGROYW1lLCB7CiAgICAgICAgICAgICAgdmFsdWVzOiB2YWx1ZXMsCiAgICAgICAgICAgICAgdG90YWxDb3VudDogX3RoaXM4LnN0YXRlLnZhbHVlcy50b3RhbENvdW50LAogICAgICAgICAgICAgIGxvYWRNb3JlUm93czogX3RoaXM4LmxvYWRNb3JlUm93cywKICAgICAgICAgICAgICBpc1Jvd0xvYWRlZDogX3RoaXM4LmlzUm93TG9hZGVkLAogICAgICAgICAgICAgIGlzRmlyc3RQYWdlTG9hZGVkOiBfdGhpczguc3RhdGUuaXNGaXJzdFBhZ2VMb2FkZWQsCiAgICAgICAgICAgICAgdXBkYXRlVG90YWxDb3VudDogX3RoaXM4LnVwZGF0ZVRvdGFsQ291bnQsCiAgICAgICAgICAgICAgcmVtb3ZlSXRlbTogX3RoaXM4LnJlbW92ZUl0ZW0sCiAgICAgICAgICAgICAgdXBkYXRlUm93OiBfdGhpczgudXBkYXRlUm93LAogICAgICAgICAgICAgIHNhdmVJbnZvaWNlSXRlbXM6IF90aGlzOC5zYXZlSW52b2ljZUl0ZW1zCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSkpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgICBjbGFzc05hbWU6ICJmb250LXdlaWdodC1ib2xkIGZsb2F0LXJpZ2h0IG1yLTVlciBlIG10LTEiCiAgICAgICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUcmFuc2xhdGUsIHsKICAgICAgICAgICAgaWQ6ICJyZWFjdC5kZWZhdWx0LnRvdGFsLmxhYmVsIiwKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJUb3RhbCIKICAgICAgICAgIH0pLCAiOlx4QTAiLCBfdGhpczguc3RhdGUudmFsdWVzLnRvdGFsVmFsdWUudG9Mb2NhbGVTdHJpbmcoJ2VuLVVTJywgewogICAgICAgICAgICBtaW5pbXVtRnJhY3Rpb25EaWdpdHM6IDIsCiAgICAgICAgICAgIG1heGltdW1GcmFjdGlvbkRpZ2l0czogMgogICAgICAgICAgfSksICIgIiwgX3RoaXM4LnN0YXRlLnZhbHVlcy5jdXJyZW5jeVVvbS5jb2RlKSwgIlx4QTAiLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgICBjbGFzc05hbWU6ICJzdWJtaXQtYnV0dG9ucyIKICAgICAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJidXR0b24iLCB7CiAgICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzOC5wcmV2aW91c1BhZ2UodmFsdWVzKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgY2xhc3NOYW1lOiAiYnRuIGJ0bi1vdXRsaW5lLXByaW1hcnkgYnRuLWZvcm0gYnRuLXhzIgogICAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoVHJhbnNsYXRlLCB7CiAgICAgICAgICAgIGlkOiAicmVhY3QuZGVmYXVsdC5idXR0b24ucHJldmlvdXMubGFiZWwiLAogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlByZXZpb3VzIgogICAgICAgICAgfSkpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiYnV0dG9uIiwgewogICAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICAgIHJldHVybiBfdGhpczgubmV4dFBhZ2UodmFsdWVzKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgY2xhc3NOYW1lOiAiYnRuIGJ0bi1vdXRsaW5lLXByaW1hcnkgYnRuLWZvcm0gZmxvYXQtcmlnaHQgYnRuLXhzIgogICAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoVHJhbnNsYXRlLCB7CiAgICAgICAgICAgIGlkOiAicmVhY3QuZGVmYXVsdC5idXR0b24ubmV4dC5sYWJlbCIsCiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiTmV4dCIKICAgICAgICAgIH0pKSkpKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH1dKTsKICByZXR1cm4gQWRkSXRlbXNQYWdlOwp9KENvbXBvbmVudCk7CnZhciBtYXBTdGF0ZVRvUHJvcHMgPSBmdW5jdGlvbiBtYXBTdGF0ZVRvUHJvcHMoc3RhdGUpIHsKICByZXR1cm4gewogICAgcGFnZVNpemU6IHN0YXRlLnNlc3Npb24ucGFnZVNpemUKICB9Owp9OwpleHBvcnQgZGVmYXVsdCBjb25uZWN0KG1hcFN0YXRlVG9Qcm9wcywgewogIHNob3dTcGlubmVyOiBzaG93U3Bpbm5lciwKICBoaWRlU3Bpbm5lcjogaGlkZVNwaW5uZXIKfSkoQWRkSXRlbXNQYWdlKTsKQWRkSXRlbXNQYWdlLnByb3BUeXBlcyA9IHsKICAvKiogSW5pdGlhbCBjb21wb25lbnQncyBkYXRhICovCiAgaW5pdGlhbFZhbHVlczogUHJvcFR5cGVzLnNoYXBlKHt9KS5pc1JlcXVpcmVkLAogIC8qKiBGdW5jdGlvbiByZXR1cm5pbmcgdXNlciB0byB0aGUgcHJldmlvdXMgcGFnZSAqLwogIHByZXZpb3VzUGFnZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCwKICAvKiogRnVuY3Rpb24gdGFraW5nIHVzZXIgdG8gdGhlIG5leHQgcGFnZSAqLwogIG5leHRQYWdlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLAogIC8qKiBOdW1iZXIgb2YgcGFnZSBzaXplIG5lZWRlZCBmb3IgcGFnaW5hdGlvbiAqLwogIHBhZ2VTaXplOiBQcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWQsCiAgLyoqIEZ1bmN0aW9uIGNhbGxlZCB3aGVuIGRhdGEgaXMgbG9hZGluZyAqLwogIHNob3dTcGlubmVyOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLAogIC8qKiBGdW5jdGlvbiBjYWxsZWQgd2hlbiBkYXRhIGhhcyBsb2FkZWQgKi8KICBoaWRlU3Bpbm5lcjogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZAp9Ow=="},null]}