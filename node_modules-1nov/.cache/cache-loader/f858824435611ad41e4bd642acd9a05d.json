{"remainingRequest":"/opt/MTOBS-BIKASH/node_modules/babel-loader/lib/index.js?presets[]=@babel/react&presets[]=@babel/env!/opt/MTOBS-BIKASH/node_modules/eslint-loader/dist/cjs.js!/opt/MTOBS-BIKASH/src/js/components/put-away/PutAwayPage.jsx","dependencies":[{"path":"/opt/MTOBS-BIKASH/src/js/components/put-away/PutAwayPage.jsx","mtime":1698037749000},{"path":"/opt/MTOBS-BIKASH/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/opt/MTOBS-BIKASH/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/opt/MTOBS-BIKASH/node_modules/eslint-loader/dist/cjs.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsgcmV0dXJuIF90eXBlb2YgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgInN5bWJvbCIgPT0gdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfSwgX3R5cGVvZihvYmopOyB9CmZ1bmN0aW9uIF9leHRlbmRzKCkgeyBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gPyBPYmplY3QuYXNzaWduLmJpbmQoKSA6IGZ1bmN0aW9uICh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXTsgZm9yICh2YXIga2V5IGluIHNvdXJjZSkgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkgeyB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOyB9IH0gfSByZXR1cm4gdGFyZ2V0OyB9OyByZXR1cm4gX2V4dGVuZHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfQpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsgZW51bWVyYWJsZU9ubHkgJiYgKHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KSksIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsgfSByZXR1cm4ga2V5czsgfQpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gbnVsbCAhPSBhcmd1bWVudHNbaV0gPyBhcmd1bWVudHNbaV0gOiB7fTsgaSAlIDIgPyBvd25LZXlzKE9iamVjdChzb3VyY2UpLCAhMCkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KSA6IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKSA6IG93bktleXMoT2JqZWN0KHNvdXJjZSkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsgfSk7IH0gcmV0dXJuIHRhcmdldDsgfQpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7IHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7IH0KZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC4iKTsgfQpmdW5jdGlvbiBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobywgbWluTGVuKSB7IGlmICghbykgcmV0dXJuOyBpZiAodHlwZW9mIG8gPT09ICJzdHJpbmciKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpOyBpZiAobiA9PT0gIk9iamVjdCIgJiYgby5jb25zdHJ1Y3RvcikgbiA9IG8uY29uc3RydWN0b3IubmFtZTsgaWYgKG4gPT09ICJNYXAiIHx8IG4gPT09ICJTZXQiKSByZXR1cm4gQXJyYXkuZnJvbShvKTsgaWYgKG4gPT09ICJBcmd1bWVudHMiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgfQpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5KGl0ZXIpIHsgaWYgKHR5cGVvZiBTeW1ib2wgIT09ICJ1bmRlZmluZWQiICYmIGl0ZXJbU3ltYm9sLml0ZXJhdG9yXSAhPSBudWxsIHx8IGl0ZXJbIkBAaXRlcmF0b3IiXSAhPSBudWxsKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTsgfQpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShhcnIpOyB9CmZ1bmN0aW9uIF9hcnJheUxpa2VUb0FycmF5KGFyciwgbGVuKSB7IGlmIChsZW4gPT0gbnVsbCB8fCBsZW4gPiBhcnIubGVuZ3RoKSBsZW4gPSBhcnIubGVuZ3RoOyBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShsZW4pOyBpIDwgbGVuOyBpKyspIHsgYXJyMltpXSA9IGFycltpXTsgfSByZXR1cm4gYXJyMjsgfQpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgX3RvUHJvcGVydHlLZXkoZGVzY3JpcHRvci5rZXkpLCBkZXNjcmlwdG9yKTsgfSB9CmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbnN0cnVjdG9yLCAicHJvdG90eXBlIiwgeyB3cml0YWJsZTogZmFsc2UgfSk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzdWJDbGFzcywgInByb3RvdHlwZSIsIHsgd3JpdGFibGU6IGZhbHNlIH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfQpmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2YuYmluZCgpIDogZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfQpmdW5jdGlvbiBfY3JlYXRlU3VwZXIoRGVyaXZlZCkgeyB2YXIgaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCA9IF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKTsgcmV0dXJuIGZ1bmN0aW9uIF9jcmVhdGVTdXBlckludGVybmFsKCkgeyB2YXIgU3VwZXIgPSBfZ2V0UHJvdG90eXBlT2YoRGVyaXZlZCksIHJlc3VsdDsgaWYgKGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QpIHsgdmFyIE5ld1RhcmdldCA9IF9nZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3RvcjsgcmVzdWx0ID0gUmVmbGVjdC5jb25zdHJ1Y3QoU3VwZXIsIGFyZ3VtZW50cywgTmV3VGFyZ2V0KTsgfSBlbHNlIHsgcmVzdWx0ID0gU3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfSByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgcmVzdWx0KTsgfTsgfQpmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikpIHsgcmV0dXJuIGNhbGw7IH0gZWxzZSBpZiAoY2FsbCAhPT0gdm9pZCAwKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkRlcml2ZWQgY29uc3RydWN0b3JzIG1heSBvbmx5IHJldHVybiBvYmplY3Qgb3IgdW5kZWZpbmVkIik7IH0gcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7IH0KZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7IGlmIChzZWxmID09PSB2b2lkIDApIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsgfSByZXR1cm4gc2VsZjsgfQpmdW5jdGlvbiBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCkgeyBpZiAodHlwZW9mIFJlZmxlY3QgPT09ICJ1bmRlZmluZWQiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlOyBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlOyBpZiAodHlwZW9mIFByb3h5ID09PSAiZnVuY3Rpb24iKSByZXR1cm4gdHJ1ZTsgdHJ5IHsgQm9vbGVhbi5wcm90b3R5cGUudmFsdWVPZi5jYWxsKFJlZmxlY3QuY29uc3RydWN0KEJvb2xlYW4sIFtdLCBmdW5jdGlvbiAoKSB7fSkpOyByZXR1cm4gdHJ1ZTsgfSBjYXRjaCAoZSkgeyByZXR1cm4gZmFsc2U7IH0gfQpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YuYmluZCgpIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfQpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7IGtleSA9IF90b1Byb3BlcnR5S2V5KGtleSk7IGlmIChrZXkgaW4gb2JqKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgeyB2YWx1ZTogdmFsdWUsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7IH0gZWxzZSB7IG9ialtrZXldID0gdmFsdWU7IH0gcmV0dXJuIG9iajsgfQpmdW5jdGlvbiBfdG9Qcm9wZXJ0eUtleShhcmcpIHsgdmFyIGtleSA9IF90b1ByaW1pdGl2ZShhcmcsICJzdHJpbmciKTsgcmV0dXJuIF90eXBlb2Yoa2V5KSA9PT0gInN5bWJvbCIgPyBrZXkgOiBTdHJpbmcoa2V5KTsgfQpmdW5jdGlvbiBfdG9QcmltaXRpdmUoaW5wdXQsIGhpbnQpIHsgaWYgKF90eXBlb2YoaW5wdXQpICE9PSAib2JqZWN0IiB8fCBpbnB1dCA9PT0gbnVsbCkgcmV0dXJuIGlucHV0OyB2YXIgcHJpbSA9IGlucHV0W1N5bWJvbC50b1ByaW1pdGl2ZV07IGlmIChwcmltICE9PSB1bmRlZmluZWQpIHsgdmFyIHJlcyA9IHByaW0uY2FsbChpbnB1dCwgaGludCB8fCAiZGVmYXVsdCIpOyBpZiAoX3R5cGVvZihyZXMpICE9PSAib2JqZWN0IikgcmV0dXJuIHJlczsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQEB0b1ByaW1pdGl2ZSBtdXN0IHJldHVybiBhIHByaW1pdGl2ZSB2YWx1ZS4iKTsgfSByZXR1cm4gKGhpbnQgPT09ICJzdHJpbmciID8gU3RyaW5nIDogTnVtYmVyKShpbnB1dCk7IH0KaW1wb3J0IFJlYWN0LCB7IENvbXBvbmVudCB9IGZyb20gJ3JlYWN0JzsKaW1wb3J0IF8gZnJvbSAnbG9kYXNoJzsKaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJzsKaW1wb3J0IHsgY29ubmVjdCB9IGZyb20gJ3JlYWN0LXJlZHV4JzsKaW1wb3J0IHsgd2l0aFJvdXRlciB9IGZyb20gJ3JlYWN0LXJvdXRlci1kb20nOwppbXBvcnQgUmVhY3RUYWJsZSBmcm9tICdyZWFjdC10YWJsZSc7CmltcG9ydCBzZWxlY3RUYWJsZUhPQyBmcm9tICdyZWFjdC10YWJsZS9saWIvaG9jL3NlbGVjdFRhYmxlJzsKaW1wb3J0IHsgaGlkZVNwaW5uZXIsIHNob3dTcGlubmVyIH0gZnJvbSAnYWN0aW9ucyc7CmltcG9ydCBhcGlDbGllbnQsIHsgZmxhdHRlblJlcXVlc3QsIHBhcnNlUmVzcG9uc2UgfSBmcm9tICd1dGlscy9hcGlDbGllbnQnOwppbXBvcnQgY3VzdG9tVHJlZVRhYmxlSE9DIGZyb20gJ3V0aWxzL0N1c3RvbVRyZWVUYWJsZSc7CmltcG9ydCBGaWx0ZXIgZnJvbSAndXRpbHMvRmlsdGVyJzsKaW1wb3J0IFNlbGVjdCBmcm9tICd1dGlscy9TZWxlY3QnOwppbXBvcnQgVHJhbnNsYXRlIGZyb20gJ3V0aWxzL1RyYW5zbGF0ZSc7CmltcG9ydCAncmVhY3QtdGFibGUvcmVhY3QtdGFibGUuY3NzJzsKdmFyIFNlbGVjdFRyZWVUYWJsZSA9IHNlbGVjdFRhYmxlSE9DKGN1c3RvbVRyZWVUYWJsZUhPQyhSZWFjdFRhYmxlKSk7CgovKiBlc2xpbnQtZGlzYWJsZSBuby11bmRlcnNjb3JlLWRhbmdsZSAqLwoKZnVuY3Rpb24gZ2V0Tm9kZXMoZGF0YSkgewogIHZhciBub2RlID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBbXTsKICBkYXRhLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoaXRlbSwgJ19zdWJSb3dzJykgJiYgaXRlbS5fc3ViUm93cykgewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ24KICAgICAgbm9kZSA9IGdldE5vZGVzKGl0ZW0uX3N1YlJvd3MsIG5vZGUpOwogICAgfSBlbHNlIHsKICAgICAgbm9kZS5wdXNoKGl0ZW0uX29yaWdpbmFsKTsKICAgIH0KICB9KTsKICByZXR1cm4gbm9kZTsKfQoKLyoqCiAqIFRoZSBmaXJzdCBwYWdlIG9mIHB1dC1hd2F5IHdoaWNoIHNob3dzIGV2ZXJ5dGhpbmcgdGhhdCBpcyBjdXJyZW50bHkgaW4gcmVjZWl2aW5nIGJpbi4KICogVXNlciBpcyBhYmxlIHRvIHNvcnQgZWl0aGVyIGJ5IHNoaXBtZW50IG9yIGJ5IHByb2R1Y3QuIEJ5IGRlZmF1bHQgaXQgaXMgbm90CiAqIGF2YWlsYWJsZSB0byBzZWUgbGluZXMgaW4gcGVuZGluZyBwdXQgYXdheXMgYnV0IGl0IGNhbiBiZSBjaGFuZ2VkLiBVc2VyIGNhbiBjaG9vc2UKICogb25lIG9yIG11bHRpcGxlIHNoaXBtZW50cyB0byB2aWV3LgogKi8KdmFyIFB1dEF3YXlQYWdlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29tcG9uZW50KSB7CiAgX2luaGVyaXRzKFB1dEF3YXlQYWdlLCBfQ29tcG9uZW50KTsKICB2YXIgX3N1cGVyID0gX2NyZWF0ZVN1cGVyKFB1dEF3YXlQYWdlKTsKICBmdW5jdGlvbiBQdXRBd2F5UGFnZShfcHJvcHMpIHsKICAgIHZhciBfdGhpczsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQdXRBd2F5UGFnZSk7CiAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIF9wcm9wcyk7CiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvbkV4cGFuZGVkQ2hhbmdlIiwgZnVuY3Rpb24gKGV4cGFuZGVkKSB7CiAgICAgIHZhciBleHBhbmRlZFJlY29yZHNJZHMgPSBbXTsKICAgICAgXy5mb3JFYWNoKGV4cGFuZGVkLCBmdW5jdGlvbiAodmFsdWUsIGtleSkgewogICAgICAgIGlmICh2YWx1ZSkgewogICAgICAgICAgZXhwYW5kZWRSZWNvcmRzSWRzLnB1c2gocGFyc2VJbnQoa2V5LCAxMCkpOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBleHBhbmRlZDogZXhwYW5kZWQKICAgICAgfSk7CiAgICB9KTsKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImdldENvbHVtbnMiLCBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBbewogICAgICAgIEhlYWRlcjogLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoVHJhbnNsYXRlLCB7CiAgICAgICAgICBpZDogInJlYWN0LnB1dEF3YXkuY29kZS5sYWJlbCIsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkNvZGUiCiAgICAgICAgfSksCiAgICAgICAgYWNjZXNzb3I6ICdwcm9kdWN0LnByb2R1Y3RDb2RlJywKICAgICAgICBzdHlsZTogewogICAgICAgICAgd2hpdGVTcGFjZTogJ25vcm1hbCcKICAgICAgICB9LAogICAgICAgIEZpbHRlcjogRmlsdGVyCiAgICAgIH0sIHsKICAgICAgICBIZWFkZXI6IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyYW5zbGF0ZSwgewogICAgICAgICAgaWQ6ICJyZWFjdC5wdXRBd2F5Lm5hbWUubGFiZWwiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJOYW1lIgogICAgICAgIH0pLAogICAgICAgIGFjY2Vzc29yOiAncHJvZHVjdC5uYW1lJywKICAgICAgICBzdHlsZTogewogICAgICAgICAgd2hpdGVTcGFjZTogJ25vcm1hbCcKICAgICAgICB9LAogICAgICAgIEZpbHRlcjogRmlsdGVyCiAgICAgIH0sIHsKICAgICAgICBIZWFkZXI6IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyYW5zbGF0ZSwgewogICAgICAgICAgaWQ6ICJyZWFjdC5wdXRBd2F5LmxvdFNlcmlhbE5vLmxhYmVsIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiTG90L1NlcmlhbCBOby4iCiAgICAgICAgfSksCiAgICAgICAgYWNjZXNzb3I6ICdpbnZlbnRvcnlJdGVtLmxvdE51bWJlcicsCiAgICAgICAgc3R5bGU6IHsKICAgICAgICAgIHdoaXRlU3BhY2U6ICdub3JtYWwnCiAgICAgICAgfSwKICAgICAgICBGaWx0ZXI6IEZpbHRlcgogICAgICB9LCB7CiAgICAgICAgSGVhZGVyOiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUcmFuc2xhdGUsIHsKICAgICAgICAgIGlkOiAicmVhY3QucHV0QXdheS5leHBpcnkubGFiZWwiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJFeHBpcnkiCiAgICAgICAgfSksCiAgICAgICAgYWNjZXNzb3I6ICdpbnZlbnRvcnlJdGVtLmV4cGlyYXRpb25EYXRlJywKICAgICAgICBzdHlsZTogewogICAgICAgICAgd2hpdGVTcGFjZTogJ25vcm1hbCcKICAgICAgICB9LAogICAgICAgIEZpbHRlcjogRmlsdGVyCiAgICAgIH0sIHsKICAgICAgICBIZWFkZXI6IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyYW5zbGF0ZSwgewogICAgICAgICAgaWQ6ICJyZWFjdC5wdXRBd2F5LnJlY2lwaWVudC5sYWJlbCIsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlJlY2lwaWVudCIKICAgICAgICB9KSwKICAgICAgICBhY2Nlc3NvcjogJ3JlY2lwaWVudC5uYW1lJywKICAgICAgICBzdHlsZTogewogICAgICAgICAgd2hpdGVTcGFjZTogJ25vcm1hbCcKICAgICAgICB9LAogICAgICAgIEZpbHRlcjogRmlsdGVyCiAgICAgIH0sIHsKICAgICAgICBIZWFkZXI6IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyYW5zbGF0ZSwgewogICAgICAgICAgaWQ6ICJyZWFjdC5wdXRBd2F5LnF0eVJlY2VpdmluZy5sYWJlbCIsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlF0eSBpbiByZWNlaXZpbmciCiAgICAgICAgfSksCiAgICAgICAgYWNjZXNzb3I6ICdxdWFudGl0eScsCiAgICAgICAgc3R5bGU6IHsKICAgICAgICAgIHdoaXRlU3BhY2U6ICdub3JtYWwnCiAgICAgICAgfSwKICAgICAgICBDZWxsOiBmdW5jdGlvbiBDZWxsKHByb3BzKSB7CiAgICAgICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLCBwcm9wcy52YWx1ZSA/IHByb3BzLnZhbHVlLnRvTG9jYWxlU3RyaW5nKCdlbi1VUycpIDogcHJvcHMudmFsdWUpOwogICAgICAgIH0sCiAgICAgICAgRmlsdGVyOiBGaWx0ZXIKICAgICAgfSwgewogICAgICAgIEhlYWRlcjogLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoVHJhbnNsYXRlLCB7CiAgICAgICAgICBpZDogInJlYWN0LnB1dEF3YXkuc3RvY2tNb3ZlbWVudC5sYWJlbCIsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlN0b2NrIE1vdmVtZW50IgogICAgICAgIH0pLAogICAgICAgIGFjY2Vzc29yOiAnc3RvY2tNb3ZlbWVudC5uYW1lJywKICAgICAgICBzdHlsZTogewogICAgICAgICAgd2hpdGVTcGFjZTogJ25vcm1hbCcKICAgICAgICB9LAogICAgICAgIEV4cGFuZGVyOiBmdW5jdGlvbiBFeHBhbmRlcihfcmVmKSB7CiAgICAgICAgICB2YXIgcm93ID0gX3JlZi5yb3csCiAgICAgICAgICAgIGlzRXhwYW5kZWQgPSBfcmVmLmlzRXhwYW5kZWQ7CiAgICAgICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCB7CiAgICAgICAgICAgIGNsYXNzTmFtZTogIm1sLTIiCiAgICAgICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiaW5wdXQiLCB7CiAgICAgICAgICAgIHR5cGU6ICJjaGVja2JveCIsCiAgICAgICAgICAgIG5hbWU6ICJhZ2dyZWdhdGlvbkNoZWNrYm94IiwKICAgICAgICAgICAgY2hlY2tlZDogX3RoaXMuY2hlY2tTZWxlY3RlZChyb3cpLAogICAgICAgICAgICB2YWx1ZTogcm93Ll9zdWJSb3dzWzBdLl9vcmlnaW5hbC5zdG9ja01vdmVtZW50LmlkLAogICAgICAgICAgICByZWY6IGZ1bmN0aW9uIHJlZihlbGVtKSB7CiAgICAgICAgICAgICAgaWYgKGVsZW0pIHsKICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnbgogICAgICAgICAgICAgICAgZWxlbS5pbmRldGVybWluYXRlID0gX3RoaXMuY2hlY2tJbmRldGVybWluYXRlKHJvdyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICBvbkNoYW5nZTogX3RoaXMudG9nZ2xlU2VsZWN0aW9uc0J5U3RvY2tNb3ZlbWVudAogICAgICAgICAgfSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgICAgIGNsYXNzTmFtZTogInJ0LWV4cGFuZGVyICIuY29uY2F0KGlzRXhwYW5kZWQgJiYgJy1vcGVuJykKICAgICAgICAgIH0sICJcdTIwMjIiKSk7CiAgICAgICAgfSwKICAgICAgICBmaWx0ZXJhYmxlOiB0cnVlLAogICAgICAgIEZpbHRlcjogRmlsdGVyCiAgICAgIH1dOwogICAgfSk7CiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJkYXRhRmV0Y2hlZCIsIGZhbHNlKTsKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInRvZ2dsZVNlbGVjdGlvbnNCeVN0b2NrTW92ZW1lbnQiLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldDsKICAgICAgdmFyIGNoZWNrZWQgPSB0YXJnZXQuY2hlY2tlZCwKICAgICAgICB2YWx1ZSA9IHRhcmdldC52YWx1ZTsKICAgICAgdmFyIGl0ZW1zVG9Ub2dnbGUgPSBfLm1hcChfLmZpbHRlcihfdGhpcy5zdGF0ZS5wdXRhd2F5SXRlbXMsIGZ1bmN0aW9uIChwcm9kdWN0KSB7CiAgICAgICAgcmV0dXJuIHByb2R1Y3Quc3RvY2tNb3ZlbWVudC5pZCA9PT0gdmFsdWUgJiYgcHJvZHVjdC5wdXRhd2F5U3RhdHVzID09PSAnUkVBRFknOwogICAgICB9KSwgZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gaXRlbS5faWQ7CiAgICAgIH0pOwogICAgICBfdGhpcy50b2dnbGVTZWxlY3Rpb24oaXRlbXNUb1RvZ2dsZSwgY2hlY2tlZCk7CiAgICB9KTsKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInRvZ2dsZUFsbCIsIGZ1bmN0aW9uICgpIHsKICAgICAgLyoKICAgICAgICBTZWxlY3QgQUxMIHRoZSByZWNvcmRzIHRoYXQgYXJlIGluIHRoZSBjdXJyZW50IGZpbHRlcmVkIGRhdGEKICAgICAgKi8KICAgICAgdmFyIHNlbGVjdEFsbCA9ICFfdGhpcy5zdGF0ZS5zZWxlY3RBbGw7CiAgICAgIHZhciBzZWxlY3Rpb24gPSBbXTsKICAgICAgLy8gd2UgbmVlZCB0byBnZXQgYXQgdGhlIGludGVybmFscyBvZiBSZWFjdFRhYmxlCiAgICAgIHZhciB3cmFwcGVkSW5zdGFuY2UgPSBfdGhpcy5zZWxlY3RUYWJsZS5nZXRXcmFwcGVkSW5zdGFuY2UoKTsKICAgICAgLy8gdGhlICdzb3J0ZWREYXRhJyBwcm9wZXJ0eSBjb250YWlucyB0aGUgY3VycmVudGx5IGFjY2Vzc2libGUKICAgICAgLy8gcmVjb3JkcyBiYXNlZCBvbiB0aGUgZmlsdGVyIGFuZCBzb3J0CiAgICAgIHZhciBjdXJyZW50UmVjb3JkcyA9IHdyYXBwZWRJbnN0YW5jZS5nZXRSZXNvbHZlZFN0YXRlKCkuc29ydGVkRGF0YTsKICAgICAgLy8gd2UgbmVlZCB0byBnZXQgYWxsIHRoZSAncmVhbCcgKG9yaWdpbmFsKSByZWNvcmRzIG91dCB0byBnZXQgYXQgdGhlaXIgSURzCiAgICAgIHZhciBub2RlcyA9IGdldE5vZGVzKGN1cnJlbnRSZWNvcmRzKTsKICAgICAgLy8gd2UganVzdCBwdXNoIGFsbCB0aGUgSURzIG9udG8gdGhlIHNlbGVjdGlvbiBhcnJheQogICAgICBub2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgaWYgKGl0ZW0ucHV0YXdheVN0YXR1cyA9PT0gJ1JFQURZJykgewogICAgICAgICAgc2VsZWN0aW9uLnB1c2goaXRlbS5faWQpOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIF90aGlzLnRvZ2dsZVNlbGVjdGlvbihzZWxlY3Rpb24sIHNlbGVjdEFsbCk7CiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBzZWxlY3RBbGw6IHNlbGVjdEFsbAogICAgICB9KTsKICAgIH0pOwogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAidG9nZ2xlVHJlZSIsIGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKF90aGlzLnN0YXRlLnBpdm90QnkubGVuZ3RoKSB7CiAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgcGl2b3RCeTogW10sCiAgICAgICAgICBleHBhbmRlZDoge30KICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICBwaXZvdEJ5OiBbJ3N0b2NrTW92ZW1lbnQubmFtZSddLAogICAgICAgICAgZXhwYW5kZWQ6IHt9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0pOwogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiaXNTZWxlY3RlZCIsIGZ1bmN0aW9uIChrZXkpIHsKICAgICAgcmV0dXJuIF8uaW5jbHVkZXMoX3RvQ29uc3VtYWJsZUFycmF5KF90aGlzLnN0YXRlLnNlbGVjdGlvbiksIGtleSk7CiAgICB9KTsKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInRvZ2dsZVNlbGVjdGlvbiIsIGZ1bmN0aW9uIChrZXlzLCBjaGVja2VkKSB7CiAgICAgIHZhciBzZWxlY3Rpb24gPSBuZXcgU2V0KF90aGlzLnN0YXRlLnNlbGVjdGlvbik7CiAgICAgIGlmIChBcnJheS5pc0FycmF5KGtleXMpKSB7CiAgICAgICAgaWYgKGNoZWNrZWQpIHsKICAgICAgICAgIF8uZm9yRWFjaChrZXlzLCBmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICBzZWxlY3Rpb24uYWRkKGl0ZW0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF8uZm9yRWFjaChrZXlzLCBmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICBzZWxlY3Rpb25bImRlbGV0ZSJdKGl0ZW0pOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHNlbGVjdGlvbi5oYXMoa2V5cykpIHsKICAgICAgICBzZWxlY3Rpb25bImRlbGV0ZSJdKGtleXMpOwogICAgICB9IGVsc2UgaWYgKCFzZWxlY3Rpb24uaGFzKGtleXMpKSB7CiAgICAgICAgc2VsZWN0aW9uLmFkZChrZXlzKTsKICAgICAgfQogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgc2VsZWN0aW9uOiBzZWxlY3Rpb24KICAgICAgfSk7CiAgICB9KTsKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImZpbHRlck1ldGhvZCIsIGZ1bmN0aW9uIChmaWx0ZXIsIHJvdykgewogICAgICByZXR1cm4gcm93Ll9hZ2dyZWdhdGVkIHx8IHJvdy5fZ3JvdXBlZEJ5UGl2b3QgfHwgXy50b1N0cmluZyhyb3dbZmlsdGVyLmlkXSkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhmaWx0ZXIudmFsdWUudG9Mb3dlckNhc2UoKSk7CiAgICB9KTsKICAgIHZhciBjb2x1bW5zID0gX3RoaXMuZ2V0Q29sdW1ucygpOwogICAgX3RoaXMuc3RhdGUgPSB7CiAgICAgIHBlbmRpbmdQdXRBd2F5czogW10sCiAgICAgIHJlYWR5UHV0QXdheXM6IFtdLAogICAgICBwdXRhd2F5SXRlbXM6IFtdLAogICAgICBjb2x1bW5zOiBjb2x1bW5zLAogICAgICBzZWxlY3Rpb246IG5ldyBTZXQoKSwKICAgICAgc2VsZWN0QWxsOiBmYWxzZSwKICAgICAgc2VsZWN0VHlwZTogJ2NoZWNrYm94JywKICAgICAgcGl2b3RCeTogWydzdG9ja01vdmVtZW50Lm5hbWUnXSwKICAgICAgZXhwYW5kZWQ6IHt9CiAgICB9OwogICAgcmV0dXJuIF90aGlzOwogIH0KICBfY3JlYXRlQ2xhc3MoUHV0QXdheVBhZ2UsIFt7CiAgICBrZXk6ICJjb21wb25lbnREaWRNb3VudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7CiAgICAgIGlmICh0aGlzLnByb3BzLnB1dEF3YXlUcmFuc2xhdGlvbnNGZXRjaGVkKSB7CiAgICAgICAgdGhpcy5kYXRhRmV0Y2hlZCA9IHRydWU7CiAgICAgICAgdGhpcy5mZXRjaFB1dEF3YXlDYW5kaWRhdGVzKHRoaXMucHJvcHMubG9jYXRpb25JZCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wcykgewogICAgICBpZiAobmV4dFByb3BzLnB1dEF3YXlUcmFuc2xhdGlvbnNGZXRjaGVkKSB7CiAgICAgICAgaWYgKCF0aGlzLmRhdGFGZXRjaGVkKSB7CiAgICAgICAgICB0aGlzLmRhdGFGZXRjaGVkID0gdHJ1ZTsKICAgICAgICAgIHRoaXMuZmV0Y2hQdXRBd2F5Q2FuZGlkYXRlcyh0aGlzLnByb3BzLmxvY2F0aW9uSWQpOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy5sb2NhdGlvbklkICE9PSBuZXh0UHJvcHMubG9jYXRpb25JZCkgewogICAgICAgICAgdGhpcy5mZXRjaFB1dEF3YXlDYW5kaWRhdGVzKG5leHRQcm9wcy5sb2NhdGlvbklkKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIENhbGxlZCB3aGVuIGV4cGFuZGVyIGlzIGNsaWNrZWQuIENoZWNrcyBleHBhbmRlZCByb3dzIGFuZCBjb3VudHMgdGhlaXIgbnVtYmVyLgogICAgICogQHBhcmFtIHtvYmplY3R9IGV4cGFuZGVkCiAgICAgKiBAcHVibGljCiAgICAgKi8KICB9LCB7CiAgICBrZXk6ICJmZXRjaFB1dEF3YXlDYW5kaWRhdGVzIiwKICAgIHZhbHVlOgogICAgLyoqCiAgICAgKiBGZXRjaGVzIGF2YWlsYWJsZSBpdGVtcyB0byBwdXQgYXdheSBmcm9tIEFQSS4KICAgICAqIEBwdWJsaWMKICAgICAqLwogICAgZnVuY3Rpb24gZmV0Y2hQdXRBd2F5Q2FuZGlkYXRlcyhsb2NhdGlvbklkKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwogICAgICB0aGlzLnByb3BzLnNob3dTcGlubmVyKCk7CiAgICAgIHZhciB1cmwgPSAiL29wZW5ib3hlcy9hcGkvcHV0YXdheXM/bG9jYXRpb24uaWQ9Ii5jb25jYXQobG9jYXRpb25JZCk7CiAgICAgIHJldHVybiBhcGlDbGllbnQuZ2V0KHVybCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICB2YXIgcHV0QXdheUNhbmRpZGF0ZXMgPSBwYXJzZVJlc3BvbnNlKHJlc3BvbnNlLmRhdGEuZGF0YSkubWFwKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBpdGVtKSwge30sIHsKICAgICAgICAgICAgX2lkOiBfLnVuaXF1ZUlkKCdpdGVtXycpCiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgICB2YXIgcGVuZGluZ1B1dEF3YXlzID0gcHV0QXdheUNhbmRpZGF0ZXMuZmlsdGVyKGZ1bmN0aW9uIChfcmVmMikgewogICAgICAgICAgdmFyIHB1dGF3YXlTdGF0dXMgPSBfcmVmMi5wdXRhd2F5U3RhdHVzOwogICAgICAgICAgcmV0dXJuIHB1dGF3YXlTdGF0dXMgIT09ICdSRUFEWSc7CiAgICAgICAgfSk7CiAgICAgICAgdmFyIHJlYWR5UHV0QXdheXMgPSBwdXRBd2F5Q2FuZGlkYXRlcy5maWx0ZXIoZnVuY3Rpb24gKF9yZWYzKSB7CiAgICAgICAgICB2YXIgcHV0YXdheVN0YXR1cyA9IF9yZWYzLnB1dGF3YXlTdGF0dXM7CiAgICAgICAgICByZXR1cm4gcHV0YXdheVN0YXR1cyA9PT0gJ1JFQURZJzsKICAgICAgICB9KS5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIGl0ZW0pLCB7fSwgewogICAgICAgICAgICBwdXRhd2F5RmFjaWxpdHk6IHsKICAgICAgICAgICAgICBpZDogaXRlbS5jdXJyZW50RmFjaWxpdHkgPyBpdGVtLmN1cnJlbnRGYWNpbGl0eS5pZCA6IG51bGwKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgICAgX3RoaXMyLnNldFN0YXRlKHsKICAgICAgICAgIHB1dGF3YXlJdGVtczogcmVhZHlQdXRBd2F5cywKICAgICAgICAgIHBlbmRpbmdQdXRBd2F5czogcGVuZGluZ1B1dEF3YXlzLAogICAgICAgICAgcmVhZHlQdXRBd2F5czogcmVhZHlQdXRBd2F5cwogICAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBfdGhpczIucHJvcHMuaGlkZVNwaW5uZXIoKTsKICAgICAgICB9KTsKICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBfdGhpczIucHJvcHMuaGlkZVNwaW5uZXIoKTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZW5kcyBhbGwgY2hhbmdlcyBtYWRlIGJ5IHVzZXIgaW4gdGhpcyBzdGVwIG9mIHB1dC1hd2F5IHRvIEFQSSBhbmQgdXBkYXRlcyBkYXRhLgogICAgICogQHB1YmxpYwogICAgICovCiAgfSwgewogICAga2V5OiAiY3JlYXRlUHV0QXdheSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlUHV0QXdheSgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CiAgICAgIHRoaXMucHJvcHMuc2hvd1NwaW5uZXIoKTsKICAgICAgdmFyIHVybCA9ICIvb3BlbmJveGVzL2FwaS9wdXRhd2F5cz9sb2NhdGlvbi5pZD0iLmNvbmNhdCh0aGlzLnByb3BzLmxvY2F0aW9uSWQpOwogICAgICB2YXIgaXRlbXMgPSBfLmZpbHRlcih0aGlzLnN0YXRlLnB1dGF3YXlJdGVtcywgZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gXy5pbmNsdWRlcyhfdG9Db25zdW1hYmxlQXJyYXkoX3RoaXMzLnN0YXRlLnNlbGVjdGlvbiksIGl0ZW0uX2lkKTsKICAgICAgfSk7CiAgICAgIHZhciBwYXlsb2FkID0gewogICAgICAgIHB1dGF3YXlOdW1iZXI6ICcnLAogICAgICAgICdwdXRhd2F5QXNzaWduZWUuaWQnOiAnJywKICAgICAgICBwdXRhd2F5U3RhdHVzOiAnUEVORElORycsCiAgICAgICAgcHV0YXdheURhdGU6ICcnLAogICAgICAgIHB1dGF3YXlJdGVtczogXy5tYXAoaXRlbXMsIGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBpdGVtKSwge30sIHsKICAgICAgICAgICAgcHV0YXdheVN0YXR1czogJ1BFTkRJTkcnCiAgICAgICAgICB9KTsKICAgICAgICB9KQogICAgICB9OwogICAgICByZXR1cm4gYXBpQ2xpZW50LnBvc3QodXJsLCBmbGF0dGVuUmVxdWVzdChwYXlsb2FkKSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICB2YXIgcHV0QXdheSA9IHBhcnNlUmVzcG9uc2UocmVzcG9uc2UuZGF0YS5kYXRhKTsKICAgICAgICBfdGhpczMucHJvcHMuaGlkZVNwaW5uZXIoKTsKICAgICAgICB2YXIgZXhwYW5kZWQgPSB7fTsKICAgICAgICBpZiAoX3RoaXMzLnN0YXRlLnBpdm90QnkubGVuZ3RoKSB7CiAgICAgICAgICBfLmZvckVhY2goX3RoaXMzLnN0YXRlLnB1dGF3YXlJdGVtcywgZnVuY3Rpb24gKGl0ZW0sIGluZGV4KSB7CiAgICAgICAgICAgIGV4cGFuZGVkW2luZGV4XSA9IHRydWU7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgX3RoaXMzLnByb3BzLmhpc3RvcnkucHVzaCgiL29wZW5ib3hlcy9wdXRBd2F5L2NyZWF0ZS8iLmNvbmNhdChwdXRBd2F5LmlkKSk7CiAgICAgICAgX3RoaXMzLnByb3BzLm5leHRQYWdlKHsKICAgICAgICAgIHB1dEF3YXk6IHB1dEF3YXksCiAgICAgICAgICBwaXZvdEJ5OiBfdGhpczMuc3RhdGUucGl2b3RCeSwKICAgICAgICAgIGV4cGFuZGVkOiBleHBhbmRlZAogICAgICAgIH0pOwogICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMy5wcm9wcy5oaWRlU3Bpbm5lcigpOwogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIEZpbHRlcnMgcHV0IGF3YXkgaXRlbXMgZGVwZW5kaW5nIG9uIHVzZXIgcHJlZmVyZW5jZXMgLSBpZiB0aGV5IHdhbnQgdG8gaW5jbHVkZSBwZW5kaW5nIG9uZQogICAgICogb3Igbm90LgogICAgICogQHBhcmFtIHtib29sZWFufSBpbmNsdWRlUGVuZGluZwogICAgICogQHB1YmxpYwogICAgICovCiAgfSwgewogICAga2V5OiAiZmlsdGVyUHV0QXdheXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpbHRlclB1dEF3YXlzKGluY2x1ZGVQZW5kaW5nKSB7CiAgICAgIGlmIChpbmNsdWRlUGVuZGluZykgewogICAgICAgIHRoaXMuc2V0U3RhdGUoewogICAgICAgICAgcHV0YXdheUl0ZW1zOiBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KHRoaXMuc3RhdGUucmVhZHlQdXRBd2F5cyksIF90b0NvbnN1bWFibGVBcnJheSh0aGlzLnN0YXRlLnBlbmRpbmdQdXRBd2F5cykpLAogICAgICAgICAgZXhwYW5kZWQ6IHt9CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICBwdXRhd2F5SXRlbXM6IF90b0NvbnN1bWFibGVBcnJheSh0aGlzLnN0YXRlLnJlYWR5UHV0QXdheXMpLAogICAgICAgICAgZXhwYW5kZWQ6IHt9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGVyZSBhcmUgc29tZSBzZWxlY3RlZCByb3dzIGJ1dCBhbHNvIHNvbWUgdW5zZWxlY3RlZCBvbmVzLiBOZWVkZWQgaW4gb3JkZXIKICAgICAqIHRvIG1ha2Ugc3RvY2sgbW92ZW1lbnRzJyBjaGVja2JveCBpbmRldGVybWluYXRlLgogICAgICogQHBhcmFtIHtvYmplY3R9IHJvdwogICAgICogQHB1YmxpYwogICAgICovCiAgfSwgewogICAga2V5OiAiY2hlY2tJbmRldGVybWluYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjaGVja0luZGV0ZXJtaW5hdGUocm93KSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwogICAgICByZXR1cm4gXy5zb21lKHJvdy5fc3ViUm93cywgZnVuY3Rpb24gKHN1YlJvdykgewogICAgICAgIHJldHVybiAhXy5pbmNsdWRlcyhfdG9Db25zdW1hYmxlQXJyYXkoX3RoaXM0LnN0YXRlLnNlbGVjdGlvbiksIHN1YlJvdy5fb3JpZ2luYWwuX2lkKTsKICAgICAgfSkgJiYgXy5zb21lKHJvdy5fc3ViUm93cywgZnVuY3Rpb24gKHN1YlJvdykgewogICAgICAgIHJldHVybiBfLmluY2x1ZGVzKF90b0NvbnN1bWFibGVBcnJheShfdGhpczQuc3RhdGUuc2VsZWN0aW9uKSwgc3ViUm93Ll9vcmlnaW5hbC5faWQpOwogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgdHJ1ZSBpZiBldmVyeSByb3cgb2Ygc3RvY2sgbW92ZW1lbnQgaXMgc2VsZWN0ZWQuIE5lZWRlZCBpbiBvcmRlciB0byBtYWtlIHN0b2NrCiAgICAgKiBtb3ZlbWVudHMnIGNoZWNrYm94IGNoZWNrZWQuCiAgICAgKiBAcGFyYW0ge29iamVjdH0gcm93CiAgICAgKiBAcHVibGljCiAgICAgKi8KICB9LCB7CiAgICBrZXk6ICJjaGVja1NlbGVjdGVkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjaGVja1NlbGVjdGVkKHJvdykgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKICAgICAgcmV0dXJuIF8uZXZlcnkocm93Ll9zdWJSb3dzLCBmdW5jdGlvbiAoc3ViUm93KSB7CiAgICAgICAgcmV0dXJuIF8uaW5jbHVkZXMoX3RvQ29uc3VtYWJsZUFycmF5KF90aGlzNS5zdGF0ZS5zZWxlY3Rpb24pLCBzdWJSb3cuX29yaWdpbmFsLl9pZCk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogRmlsdGVycyBpdGVtcyB0byB0b2dnbGUgYnkgc3RvY2sgbW92ZW1lbnQgYW5kIHRoZW4gY2FsbHMgdG9nZ2xlU2VsZWN0aW9uIG1ldGhvZC4KICAgICAqICBAcGFyYW0ge29iamVjdH0gZXZlbnQKICAgICAqIEBwdWJsaWMKICAgICAqLwogIH0sIHsKICAgIGtleTogInJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkgewogICAgICB2YXIgX3RoaXM2ID0gdGhpczsKICAgICAgdmFyIHRvZ2dsZVNlbGVjdGlvbiA9IHRoaXMudG9nZ2xlU2VsZWN0aW9uLAogICAgICAgIHRvZ2dsZUFsbCA9IHRoaXMudG9nZ2xlQWxsLAogICAgICAgIGlzU2VsZWN0ZWQgPSB0aGlzLmlzU2VsZWN0ZWQsCiAgICAgICAgb25FeHBhbmRlZENoYW5nZSA9IHRoaXMub25FeHBhbmRlZENoYW5nZSwKICAgICAgICB0b2dnbGVUcmVlID0gdGhpcy50b2dnbGVUcmVlOwogICAgICB2YXIgX3RoaXMkc3RhdGUgPSB0aGlzLnN0YXRlLAogICAgICAgIHB1dGF3YXlJdGVtcyA9IF90aGlzJHN0YXRlLnB1dGF3YXlJdGVtcywKICAgICAgICBjb2x1bW5zID0gX3RoaXMkc3RhdGUuY29sdW1ucywKICAgICAgICBzZWxlY3RBbGwgPSBfdGhpcyRzdGF0ZS5zZWxlY3RBbGwsCiAgICAgICAgc2VsZWN0VHlwZSA9IF90aGlzJHN0YXRlLnNlbGVjdFR5cGUsCiAgICAgICAgcGl2b3RCeSA9IF90aGlzJHN0YXRlLnBpdm90QnksCiAgICAgICAgZXhwYW5kZWQgPSBfdGhpcyRzdGF0ZS5leHBhbmRlZDsKICAgICAgdmFyIGV4dHJhUHJvcHMgPSB7CiAgICAgICAgc2VsZWN0QWxsOiBzZWxlY3RBbGwsCiAgICAgICAgaXNTZWxlY3RlZDogaXNTZWxlY3RlZCwKICAgICAgICB0b2dnbGVBbGw6IHRvZ2dsZUFsbCwKICAgICAgICB0b2dnbGVTZWxlY3Rpb246IHRvZ2dsZVNlbGVjdGlvbiwKICAgICAgICBzZWxlY3RUeXBlOiBzZWxlY3RUeXBlLAogICAgICAgIHBpdm90Qnk6IHBpdm90QnksCiAgICAgICAgZXhwYW5kZWQ6IGV4cGFuZGVkLAogICAgICAgIG9uRXhwYW5kZWRDaGFuZ2U6IG9uRXhwYW5kZWRDaGFuZ2UKICAgICAgfTsKICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgY2xhc3NOYW1lOiAicHV0YXdheSIKICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBjbGFzc05hbWU6ICJkLWZsZXgganVzdGlmeS1jb250ZW50LWJldHdlZW4gbWItMiBwdXRhd2F5LWJ1dHRvbnMiCiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCBudWxsLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUcmFuc2xhdGUsIHsKICAgICAgICBpZDogInJlYWN0LnB1dEF3YXkuc2hvd0J5LmxhYmVsIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlNob3cgYnkiCiAgICAgIH0pLCAiOiIsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJidXR0b24iLCB7CiAgICAgICAgY2xhc3NOYW1lOiAiYnRuIGJ0bi1wcmltYXJ5IG1sLTIgYnRuLXhzIiwKICAgICAgICAiZGF0YS10b2dnbGUiOiAiYnV0dG9uIiwKICAgICAgICAiYXJpYS1wcmVzc2VkIjogImZhbHNlIiwKICAgICAgICBvbkNsaWNrOiB0b2dnbGVUcmVlCiAgICAgIH0sIHBpdm90QnkgJiYgcGl2b3RCeS5sZW5ndGggPyAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUcmFuc2xhdGUsIHsKICAgICAgICBpZDogInJlYWN0LnB1dEF3YXkuc3RvY2tNb3ZlbWVudC5sYWJlbCIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJTdG9jayBNb3ZlbWVudCIKICAgICAgfSkgOiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUcmFuc2xhdGUsIHsKICAgICAgICBpZDogInJlYWN0LnB1dEF3YXkucHJvZHVjdC5sYWJlbCIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJQcm9kdWN0IgogICAgICB9KSkpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIGNsYXNzTmFtZTogInJvdyBiZC1oaWdobGlnaHQiCiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgY2xhc3NOYW1lOiAibXItMSIKICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoVHJhbnNsYXRlLCB7CiAgICAgICAgaWQ6ICJyZWFjdC5wdXRBd2F5LmxpbmVzLmxhYmVsIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkxpbmVzIGluIHBlbmRpbmcgcHV0YXdheXMiCiAgICAgIH0pLCAiOiIpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIHN0eWxlOiB7CiAgICAgICAgICB3aWR0aDogJzE1MHB4JwogICAgICAgIH0KICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoU2VsZWN0LCB7CiAgICAgICAgb3B0aW9uczogW3sKICAgICAgICAgIHZhbHVlOiBmYWxzZSwKICAgICAgICAgIGxhYmVsOiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUcmFuc2xhdGUsIHsKICAgICAgICAgICAgaWQ6ICJyZWFjdC5wdXRBd2F5LmV4Y2x1ZGUubGFiZWwiLAogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkV4Y2x1ZGUiCiAgICAgICAgICB9KQogICAgICAgIH0sIHsKICAgICAgICAgIHZhbHVlOiB0cnVlLAogICAgICAgICAgbGFiZWw6IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyYW5zbGF0ZSwgewogICAgICAgICAgICBpZDogInJlYWN0LnB1dEF3YXkuaW5jbHVkZS5sYWJlbCIsCiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiSW5jbHVkZSIKICAgICAgICAgIH0pCiAgICAgICAgfV0sCiAgICAgICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKHZhbCkgewogICAgICAgICAgcmV0dXJuIF90aGlzNi5maWx0ZXJQdXRBd2F5cyh2YWwudmFsdWUpOwogICAgICAgIH0sCiAgICAgICAgaW5pdGlhbFZhbHVlOiB7CiAgICAgICAgICB2YWx1ZTogZmFsc2UsCiAgICAgICAgICBsYWJlbDogLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoVHJhbnNsYXRlLCB7CiAgICAgICAgICAgIGlkOiAicmVhY3QucHV0QXdheS5leGNsdWRlLmxhYmVsIiwKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJFeGNsdWRlIgogICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIGNsZWFyYWJsZTogZmFsc2UsCiAgICAgICAgY2xhc3NOYW1lOiAic2VsZWN0LXhzIgogICAgICB9KSkpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiYnV0dG9uIiwgewogICAgICAgIHR5cGU6ICJidXR0b24iLAogICAgICAgIGRpc2FibGVkOiB0aGlzLnN0YXRlLnNlbGVjdGlvbi5zaXplIDwgMSwKICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzNi5jcmVhdGVQdXRBd2F5KCk7CiAgICAgICAgfSwKICAgICAgICBjbGFzc05hbWU6ICJidG4gYnRuLW91dGxpbmUtcHJpbWFyeSBidG4tZm9ybSBmbG9hdC1yaWdodCBidG4teHMiCiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyYW5zbGF0ZSwgewogICAgICAgIGlkOiAicmVhY3QucHV0QXdheS5zdGFydFB1dEF3YXkubGFiZWwiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiU3RhcnQgUHV0YXdheSIKICAgICAgfSkpKSwgcHV0YXdheUl0ZW1zID8gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoU2VsZWN0VHJlZVRhYmxlLCBfZXh0ZW5kcyh7CiAgICAgICAgZGF0YTogcHV0YXdheUl0ZW1zLAogICAgICAgIGNvbHVtbnM6IGNvbHVtbnMsCiAgICAgICAgcmVmOiBmdW5jdGlvbiByZWYocikgewogICAgICAgICAgX3RoaXM2LnNlbGVjdFRhYmxlID0gcjsKICAgICAgICB9LAogICAgICAgIGNsYXNzTmFtZTogIi1zdHJpcGVkIC1oaWdobGlnaHQiCiAgICAgIH0sIGV4dHJhUHJvcHMsIHsKICAgICAgICBkZWZhdWx0UGFnZVNpemU6IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSLAogICAgICAgIG1pblJvd3M6IDAsCiAgICAgICAgc2hvd1BhZ2luYXRpb25Cb3R0b206IGZhbHNlLAogICAgICAgIGZpbHRlcmFibGU6IHRydWUsCiAgICAgICAgZGVmYXVsdEZpbHRlck1ldGhvZDogdGhpcy5maWx0ZXJNZXRob2QsCiAgICAgICAgZnJlZXplV2hlbkV4cGFuZGVkOiB0cnVlLAogICAgICAgIFNlbGVjdElucHV0Q29tcG9uZW50OiBmdW5jdGlvbiBTZWxlY3RJbnB1dENvbXBvbmVudChfcmVmNCkgewogICAgICAgICAgdmFyIGlkID0gX3JlZjQuaWQsCiAgICAgICAgICAgIGNoZWNrZWQgPSBfcmVmNC5jaGVja2VkLAogICAgICAgICAgICBfb25DbGljayA9IF9yZWY0Lm9uQ2xpY2ssCiAgICAgICAgICAgIHJvdyA9IF9yZWY0LnJvdzsKICAgICAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiaW5wdXQiLCB7CiAgICAgICAgICAgIHR5cGU6IHNlbGVjdFR5cGUsCiAgICAgICAgICAgIGNoZWNrZWQ6IGNoZWNrZWQsCiAgICAgICAgICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZSgpIHt9LAogICAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKGUpIHsKICAgICAgICAgICAgICB2YXIgc2hpZnRLZXkgPSBlLnNoaWZ0S2V5OwogICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgICAgX29uQ2xpY2soaWQsIHNoaWZ0S2V5LCByb3cpOwogICAgICAgICAgICB9LAogICAgICAgICAgICBkaXNhYmxlZDogcm93LnB1dGF3YXlTdGF0dXMgIT09ICdSRUFEWScKICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgZ2V0VGRQcm9wczogZnVuY3Rpb24gZ2V0VGRQcm9wcyhzdGF0ZSwgcm93SW5mbykgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgc3R5bGU6IHsKICAgICAgICAgICAgICBjb2xvcjogXy5nZXQocm93SW5mbywgJ29yaWdpbmFsLnB1dGF3YXlTdGF0dXMnKSA9PT0gJ1JFQURZJyB8fCByb3dJbmZvLmFnZ3JlZ2F0ZWQgPyAnYmxhY2snIDogJ2dyYXknCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soZXZlbnQsIGhhbmRsZU9yaWdpbmFsKSB7CiAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldDsKICAgICAgICAgICAgICAvLyBGaXJlIHRoZSBvcmlnaW5hbCBvbkNsaWNrIGhhbmRsZXIsIGlmIHRoZSBvdGhlciBwYXJ0IG9mIHJvdyBpcyBjbGlja2VkIG9uCiAgICAgICAgICAgICAgaWYgKGhhbmRsZU9yaWdpbmFsICYmIHRhcmdldC5uYW1lICE9PSAnYWdncmVnYXRpb25DaGVja2JveCcpIHsKICAgICAgICAgICAgICAgIGhhbmRsZU9yaWdpbmFsKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSkpIDogbnVsbCwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBjbGFzc05hbWU6ICJzdWJtaXQtYnV0dG9ucyIKICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIsIHsKICAgICAgICB0eXBlOiAiYnV0dG9uIiwKICAgICAgICBkaXNhYmxlZDogdGhpcy5zdGF0ZS5zZWxlY3Rpb24uc2l6ZSA8IDEsCiAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgIHJldHVybiBfdGhpczYuY3JlYXRlUHV0QXdheSgpOwogICAgICAgIH0sCiAgICAgICAgY2xhc3NOYW1lOiAiYnRuIGJ0bi1vdXRsaW5lLXByaW1hcnkgYnRuLWZvcm0gZmxvYXQtcmlnaHQgYnRuLXhzIgogICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUcmFuc2xhdGUsIHsKICAgICAgICBpZDogInJlYWN0LnB1dEF3YXkuc3RhcnRQdXRBd2F5LmxhYmVsIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlN0YXJ0IFB1dGF3YXkiCiAgICAgIH0pKSkpOwogICAgfQogIH1dKTsKICByZXR1cm4gUHV0QXdheVBhZ2U7Cn0oQ29tcG9uZW50KTsKdmFyIG1hcFN0YXRlVG9Qcm9wcyA9IGZ1bmN0aW9uIG1hcFN0YXRlVG9Qcm9wcyhzdGF0ZSkgewogIHJldHVybiB7CiAgICBwdXRBd2F5VHJhbnNsYXRpb25zRmV0Y2hlZDogc3RhdGUuc2Vzc2lvbi5mZXRjaGVkVHJhbnNsYXRpb25zLnB1dEF3YXkKICB9Owp9OwpleHBvcnQgZGVmYXVsdCB3aXRoUm91dGVyKGNvbm5lY3QobWFwU3RhdGVUb1Byb3BzLCB7CiAgc2hvd1NwaW5uZXI6IHNob3dTcGlubmVyLAogIGhpZGVTcGlubmVyOiBoaWRlU3Bpbm5lcgp9KShQdXRBd2F5UGFnZSkpOwpQdXRBd2F5UGFnZS5wcm9wVHlwZXMgPSB7CiAgLyoqIEZ1bmN0aW9uIGNhbGxlZCB3aGVuIGRhdGEgaXMgbG9hZGluZyAqLwogIHNob3dTcGlubmVyOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLAogIC8qKiBGdW5jdGlvbiBjYWxsZWQgd2hlbiBkYXRhIGhhcyBsb2FkZWQgKi8KICBoaWRlU3Bpbm5lcjogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCwKICAvKiogRnVuY3Rpb24gdGFraW5nIHVzZXIgdG8gdGhlIG5leHQgcGFnZSAqLwogIG5leHRQYWdlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLAogIC8qKiBMb2NhdGlvbiBJRCAoY3VycmVudGx5IGNob3NlbikuIFRvIGJlIHVzZWQgaW4gcHV0YXdheXMgcmVxdWVzdHMuICovCiAgbG9jYXRpb25JZDogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLAogIC8qKiBSZWFjdCByb3V0ZXIncyBvYmplY3QgdXNlZCB0byBtYW5hZ2Ugc2Vzc2lvbiBoaXN0b3J5ICovCiAgaGlzdG9yeTogUHJvcFR5cGVzLnNoYXBlKHsKICAgIHB1c2g6IFByb3BUeXBlcy5mdW5jCiAgfSkuaXNSZXF1aXJlZCwKICBwdXRBd2F5VHJhbnNsYXRpb25zRmV0Y2hlZDogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZAp9Ow=="},null]}