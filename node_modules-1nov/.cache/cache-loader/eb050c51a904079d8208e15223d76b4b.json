{"remainingRequest":"/opt/MTOBS-BIKASH/node_modules/babel-loader/lib/index.js?presets[]=@babel/react&presets[]=@babel/env!/opt/MTOBS-BIKASH/node_modules/eslint-loader/dist/cjs.js!/opt/MTOBS-BIKASH/src/js/components/put-away/PutAwaySecondPage.jsx","dependencies":[{"path":"/opt/MTOBS-BIKASH/src/js/components/put-away/PutAwaySecondPage.jsx","mtime":1698037749000},{"path":"/opt/MTOBS-BIKASH/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/opt/MTOBS-BIKASH/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/opt/MTOBS-BIKASH/node_modules/eslint-loader/dist/cjs.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsgcmV0dXJuIF90eXBlb2YgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgInN5bWJvbCIgPT0gdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfSwgX3R5cGVvZihvYmopOyB9CmZ1bmN0aW9uIF9leHRlbmRzKCkgeyBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gPyBPYmplY3QuYXNzaWduLmJpbmQoKSA6IGZ1bmN0aW9uICh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXTsgZm9yICh2YXIga2V5IGluIHNvdXJjZSkgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkgeyB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOyB9IH0gfSByZXR1cm4gdGFyZ2V0OyB9OyByZXR1cm4gX2V4dGVuZHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfQpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7IHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7IH0KZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC4iKTsgfQpmdW5jdGlvbiBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobywgbWluTGVuKSB7IGlmICghbykgcmV0dXJuOyBpZiAodHlwZW9mIG8gPT09ICJzdHJpbmciKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpOyBpZiAobiA9PT0gIk9iamVjdCIgJiYgby5jb25zdHJ1Y3RvcikgbiA9IG8uY29uc3RydWN0b3IubmFtZTsgaWYgKG4gPT09ICJNYXAiIHx8IG4gPT09ICJTZXQiKSByZXR1cm4gQXJyYXkuZnJvbShvKTsgaWYgKG4gPT09ICJBcmd1bWVudHMiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgfQpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5KGl0ZXIpIHsgaWYgKHR5cGVvZiBTeW1ib2wgIT09ICJ1bmRlZmluZWQiICYmIGl0ZXJbU3ltYm9sLml0ZXJhdG9yXSAhPSBudWxsIHx8IGl0ZXJbIkBAaXRlcmF0b3IiXSAhPSBudWxsKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTsgfQpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShhcnIpOyB9CmZ1bmN0aW9uIF9hcnJheUxpa2VUb0FycmF5KGFyciwgbGVuKSB7IGlmIChsZW4gPT0gbnVsbCB8fCBsZW4gPiBhcnIubGVuZ3RoKSBsZW4gPSBhcnIubGVuZ3RoOyBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShsZW4pOyBpIDwgbGVuOyBpKyspIHsgYXJyMltpXSA9IGFycltpXTsgfSByZXR1cm4gYXJyMjsgfQpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsgZW51bWVyYWJsZU9ubHkgJiYgKHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KSksIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsgfSByZXR1cm4ga2V5czsgfQpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gbnVsbCAhPSBhcmd1bWVudHNbaV0gPyBhcmd1bWVudHNbaV0gOiB7fTsgaSAlIDIgPyBvd25LZXlzKE9iamVjdChzb3VyY2UpLCAhMCkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KSA6IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKSA6IG93bktleXMoT2JqZWN0KHNvdXJjZSkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsgfSk7IH0gcmV0dXJuIHRhcmdldDsgfQpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgX3RvUHJvcGVydHlLZXkoZGVzY3JpcHRvci5rZXkpLCBkZXNjcmlwdG9yKTsgfSB9CmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbnN0cnVjdG9yLCAicHJvdG90eXBlIiwgeyB3cml0YWJsZTogZmFsc2UgfSk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzdWJDbGFzcywgInByb3RvdHlwZSIsIHsgd3JpdGFibGU6IGZhbHNlIH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfQpmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2YuYmluZCgpIDogZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfQpmdW5jdGlvbiBfY3JlYXRlU3VwZXIoRGVyaXZlZCkgeyB2YXIgaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCA9IF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKTsgcmV0dXJuIGZ1bmN0aW9uIF9jcmVhdGVTdXBlckludGVybmFsKCkgeyB2YXIgU3VwZXIgPSBfZ2V0UHJvdG90eXBlT2YoRGVyaXZlZCksIHJlc3VsdDsgaWYgKGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QpIHsgdmFyIE5ld1RhcmdldCA9IF9nZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3RvcjsgcmVzdWx0ID0gUmVmbGVjdC5jb25zdHJ1Y3QoU3VwZXIsIGFyZ3VtZW50cywgTmV3VGFyZ2V0KTsgfSBlbHNlIHsgcmVzdWx0ID0gU3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfSByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgcmVzdWx0KTsgfTsgfQpmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikpIHsgcmV0dXJuIGNhbGw7IH0gZWxzZSBpZiAoY2FsbCAhPT0gdm9pZCAwKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkRlcml2ZWQgY29uc3RydWN0b3JzIG1heSBvbmx5IHJldHVybiBvYmplY3Qgb3IgdW5kZWZpbmVkIik7IH0gcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7IH0KZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7IGlmIChzZWxmID09PSB2b2lkIDApIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsgfSByZXR1cm4gc2VsZjsgfQpmdW5jdGlvbiBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCkgeyBpZiAodHlwZW9mIFJlZmxlY3QgPT09ICJ1bmRlZmluZWQiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlOyBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlOyBpZiAodHlwZW9mIFByb3h5ID09PSAiZnVuY3Rpb24iKSByZXR1cm4gdHJ1ZTsgdHJ5IHsgQm9vbGVhbi5wcm90b3R5cGUudmFsdWVPZi5jYWxsKFJlZmxlY3QuY29uc3RydWN0KEJvb2xlYW4sIFtdLCBmdW5jdGlvbiAoKSB7fSkpOyByZXR1cm4gdHJ1ZTsgfSBjYXRjaCAoZSkgeyByZXR1cm4gZmFsc2U7IH0gfQpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YuYmluZCgpIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfQpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7IGtleSA9IF90b1Byb3BlcnR5S2V5KGtleSk7IGlmIChrZXkgaW4gb2JqKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgeyB2YWx1ZTogdmFsdWUsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7IH0gZWxzZSB7IG9ialtrZXldID0gdmFsdWU7IH0gcmV0dXJuIG9iajsgfQpmdW5jdGlvbiBfdG9Qcm9wZXJ0eUtleShhcmcpIHsgdmFyIGtleSA9IF90b1ByaW1pdGl2ZShhcmcsICJzdHJpbmciKTsgcmV0dXJuIF90eXBlb2Yoa2V5KSA9PT0gInN5bWJvbCIgPyBrZXkgOiBTdHJpbmcoa2V5KTsgfQpmdW5jdGlvbiBfdG9QcmltaXRpdmUoaW5wdXQsIGhpbnQpIHsgaWYgKF90eXBlb2YoaW5wdXQpICE9PSAib2JqZWN0IiB8fCBpbnB1dCA9PT0gbnVsbCkgcmV0dXJuIGlucHV0OyB2YXIgcHJpbSA9IGlucHV0W1N5bWJvbC50b1ByaW1pdGl2ZV07IGlmIChwcmltICE9PSB1bmRlZmluZWQpIHsgdmFyIHJlcyA9IHByaW0uY2FsbChpbnB1dCwgaGludCB8fCAiZGVmYXVsdCIpOyBpZiAoX3R5cGVvZihyZXMpICE9PSAib2JqZWN0IikgcmV0dXJuIHJlczsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQEB0b1ByaW1pdGl2ZSBtdXN0IHJldHVybiBhIHByaW1pdGl2ZSB2YWx1ZS4iKTsgfSByZXR1cm4gKGhpbnQgPT09ICJzdHJpbmciID8gU3RyaW5nIDogTnVtYmVyKShpbnB1dCk7IH0KaW1wb3J0IFJlYWN0LCB7IENvbXBvbmVudCB9IGZyb20gJ3JlYWN0JzsKaW1wb3J0IHVwZGF0ZSBmcm9tICdpbW11dGFiaWxpdHktaGVscGVyJzsKaW1wb3J0IGZpbGVEb3dubG9hZCBmcm9tICdqcy1maWxlLWRvd25sb2FkJzsKaW1wb3J0IF8gZnJvbSAnbG9kYXNoJzsKaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJzsKaW1wb3J0IHF1ZXJ5U3RyaW5nIGZyb20gJ3F1ZXJ5LXN0cmluZyc7CmltcG9ydCB7IGNvbmZpcm1BbGVydCB9IGZyb20gJ3JlYWN0LWNvbmZpcm0tYWxlcnQnOwppbXBvcnQgeyBnZXRUcmFuc2xhdGUgfSBmcm9tICdyZWFjdC1sb2NhbGl6ZS1yZWR1eCc7CmltcG9ydCB7IGNvbm5lY3QgfSBmcm9tICdyZWFjdC1yZWR1eCc7CmltcG9ydCBSZWFjdFRhYmxlIGZyb20gJ3JlYWN0LXRhYmxlJzsKaW1wb3J0IHsgVG9vbHRpcCB9IGZyb20gJ3JlYWN0LXRpcHB5JzsKaW1wb3J0IHsgaGlkZVNwaW5uZXIsIHNob3dTcGlubmVyIH0gZnJvbSAnYWN0aW9ucyc7CmltcG9ydCBTcGxpdExpbmVNb2RhbCBmcm9tICdjb21wb25lbnRzL3B1dC1hd2F5L1NwbGl0TGluZU1vZGFsJzsKaW1wb3J0IGFwaUNsaWVudCwgeyBmbGF0dGVuUmVxdWVzdCwgcGFyc2VSZXNwb25zZSB9IGZyb20gJ3V0aWxzL2FwaUNsaWVudCc7CmltcG9ydCBjdXN0b21UcmVlVGFibGVIT0MgZnJvbSAndXRpbHMvQ3VzdG9tVHJlZVRhYmxlJzsKaW1wb3J0IEZpbHRlciBmcm9tICd1dGlscy9GaWx0ZXInOwppbXBvcnQgc2hvd0xvY2F0aW9uQ2hhbmdlZEFsZXJ0IGZyb20gJ3V0aWxzL2xvY2F0aW9uLWNoYW5nZS1hbGVydCc7CmltcG9ydCBTZWxlY3QgZnJvbSAndXRpbHMvU2VsZWN0JzsKaW1wb3J0IFRyYW5zbGF0ZSwgeyB0cmFuc2xhdGVXaXRoRGVmYXVsdE1lc3NhZ2UgfSBmcm9tICd1dGlscy9UcmFuc2xhdGUnOwppbXBvcnQgJ3JlYWN0LXRhYmxlL3JlYWN0LXRhYmxlLmNzcyc7CnZhciBTZWxlY3RUcmVlVGFibGUgPSBjdXN0b21UcmVlVGFibGVIT0MoUmVhY3RUYWJsZSk7CmZ1bmN0aW9uIGhhc1ZhbGlkYXRpb25FcnJvcihxdWFudGl0eSwgcXVhbnRpdHlBdmFpbGFibGUpIHsKICByZXR1cm4gcXVhbnRpdHkgPiBxdWFudGl0eUF2YWlsYWJsZSB8fCBxdWFudGl0eSA8IDE7Cn0KCi8qKgogKiBUaGUgc2Vjb25kIHBhZ2Ugb2YgcHV0LWF3YXkgd2hlcmUgdXNlciBjYW4gY2hvb3NlIHB1dC1hd2F5IGJpbiwgc3BsaXQgYSBsaW5lCiAqIG9yIGdlbmVyYXRlIHB1dC1hd2F5IGxpc3QocGRmKS4gSXQgY2FuIGJlIHNvcnRlZCBlaXRoZXIgYnkgc2hpcG1lbnQgb3IgYnkgcHJvZHVjdC4KICovCnZhciBQdXRBd2F5U2Vjb25kUGFnZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0NvbXBvbmVudCkgewogIF9pbmhlcml0cyhQdXRBd2F5U2Vjb25kUGFnZSwgX0NvbXBvbmVudCk7CiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihQdXRBd2F5U2Vjb25kUGFnZSk7CiAgZnVuY3Rpb24gUHV0QXdheVNlY29uZFBhZ2UoX3Byb3BzKSB7CiAgICB2YXIgX3RoaXM7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUHV0QXdheVNlY29uZFBhZ2UpOwogICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBfcHJvcHMpOwogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAib25FeHBhbmRlZENoYW5nZSIsIGZ1bmN0aW9uIChleHBhbmRlZCkgewogICAgICB2YXIgZXhwYW5kZWRSZWNvcmRzSWRzID0gW107CiAgICAgIF8uZm9yRWFjaChleHBhbmRlZCwgZnVuY3Rpb24gKHZhbHVlLCBrZXkpIHsKICAgICAgICBpZiAodmFsdWUpIHsKICAgICAgICAgIGV4cGFuZGVkUmVjb3Jkc0lkcy5wdXNoKHBhcnNlSW50KGtleSwgMTApKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgZXhwYW5kZWQ6IGV4cGFuZGVkCiAgICAgIH0pOwogICAgfSk7CiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJnZXRDb2x1bW5zIiwgZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gW3sKICAgICAgICBIZWFkZXI6IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyYW5zbGF0ZSwgewogICAgICAgICAgaWQ6ICJyZWFjdC5wdXRBd2F5LmNvZGUubGFiZWwiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJDb2RlIgogICAgICAgIH0pLAogICAgICAgIGFjY2Vzc29yOiAncHJvZHVjdC5wcm9kdWN0Q29kZScsCiAgICAgICAgc3R5bGU6IHsKICAgICAgICAgIHdoaXRlU3BhY2U6ICdub3JtYWwnCiAgICAgICAgfSwKICAgICAgICBGaWx0ZXI6IEZpbHRlcgogICAgICB9LCB7CiAgICAgICAgSGVhZGVyOiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUcmFuc2xhdGUsIHsKICAgICAgICAgIGlkOiAicmVhY3QucHV0QXdheS5uYW1lLmxhYmVsIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiTmFtZSIKICAgICAgICB9KSwKICAgICAgICBhY2Nlc3NvcjogJ3Byb2R1Y3QubmFtZScsCiAgICAgICAgc3R5bGU6IHsKICAgICAgICAgIHdoaXRlU3BhY2U6ICdub3JtYWwnCiAgICAgICAgfSwKICAgICAgICBGaWx0ZXI6IEZpbHRlcgogICAgICB9LCB7CiAgICAgICAgSGVhZGVyOiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUcmFuc2xhdGUsIHsKICAgICAgICAgIGlkOiAicmVhY3QucHV0QXdheS5sb3RTZXJpYWxOby5sYWJlbCIsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkxvdC9TZXJpYWwgTm8uIgogICAgICAgIH0pLAogICAgICAgIGFjY2Vzc29yOiAnaW52ZW50b3J5SXRlbS5sb3ROdW1iZXInLAogICAgICAgIHN0eWxlOiB7CiAgICAgICAgICB3aGl0ZVNwYWNlOiAnbm9ybWFsJwogICAgICAgIH0sCiAgICAgICAgRmlsdGVyOiBGaWx0ZXIKICAgICAgfSwgewogICAgICAgIEhlYWRlcjogLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoVHJhbnNsYXRlLCB7CiAgICAgICAgICBpZDogInJlYWN0LnB1dEF3YXkuZXhwaXJ5LmxhYmVsIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiRXhwaXJ5IgogICAgICAgIH0pLAogICAgICAgIGFjY2Vzc29yOiAnaW52ZW50b3J5SXRlbS5leHBpcmF0aW9uRGF0ZScsCiAgICAgICAgc3R5bGU6IHsKICAgICAgICAgIHdoaXRlU3BhY2U6ICdub3JtYWwnCiAgICAgICAgfSwKICAgICAgICBGaWx0ZXI6IEZpbHRlcgogICAgICB9LCB7CiAgICAgICAgSGVhZGVyOiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUcmFuc2xhdGUsIHsKICAgICAgICAgIGlkOiAicmVhY3QucHV0QXdheS5yZWNpcGllbnQubGFiZWwiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJSZWNpcGllbnQiCiAgICAgICAgfSksCiAgICAgICAgYWNjZXNzb3I6ICdyZWNpcGllbnQubmFtZScsCiAgICAgICAgc3R5bGU6IHsKICAgICAgICAgIHdoaXRlU3BhY2U6ICdub3JtYWwnCiAgICAgICAgfSwKICAgICAgICBGaWx0ZXI6IEZpbHRlcgogICAgICB9LCB7CiAgICAgICAgSGVhZGVyOiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUcmFuc2xhdGUsIHsKICAgICAgICAgIGlkOiAicmVhY3QucHV0QXdheS5xdHkubGFiZWwiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJRVFkiCiAgICAgICAgfSksCiAgICAgICAgYWNjZXNzb3I6ICdxdWFudGl0eScsCiAgICAgICAgc3R5bGU6IHsKICAgICAgICAgIHdoaXRlU3BhY2U6ICdub3JtYWwnCiAgICAgICAgfSwKICAgICAgICBDZWxsOiBmdW5jdGlvbiBDZWxsKHByb3BzKSB7CiAgICAgICAgICB2YXIgX3Byb3BzJG9yaWdpbmFsLCBfcHJvcHMkb3JpZ2luYWwzOwogICAgICAgICAgdmFyIGl0ZW1JbmRleCA9IHByb3BzLmluZGV4OwogICAgICAgICAgdmFyIGVkaXQgPSBfLmdldChfdGhpcy5zdGF0ZS5wdXRBd2F5LnB1dGF3YXlJdGVtcywgIlsiLmNvbmNhdChpdGVtSW5kZXgsICJdLmVkaXQiKSk7CiAgICAgICAgICB2YXIgZGlzYWJsZWRNZXNzYWdlOwogICAgICAgICAgaWYgKChwcm9wcyA9PT0gbnVsbCB8fCBwcm9wcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogcHJvcHMudmFsdWUpIDwgMSkgewogICAgICAgICAgICBkaXNhYmxlZE1lc3NhZ2UgPSBfdGhpcy5wcm9wcy50cmFuc2xhdGUoJ3JlYWN0LnB1dEF3YXkubmVnYXRpdmVRdWFudGl0eS5sYWJlbCcsICdRdWFudGl0eSBjYW5ub3QgYmUgbGVzcyB0aGFuIDEnKTsKICAgICAgICAgIH0KICAgICAgICAgIGlmICgocHJvcHMgPT09IG51bGwgfHwgcHJvcHMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHByb3BzLnZhbHVlKSA+ICgoX3Byb3BzJG9yaWdpbmFsID0gcHJvcHMub3JpZ2luYWwpID09PSBudWxsIHx8IF9wcm9wcyRvcmlnaW5hbCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3Byb3BzJG9yaWdpbmFsLnF1YW50aXR5QXZhaWxhYmxlKSkgewogICAgICAgICAgICBkaXNhYmxlZE1lc3NhZ2UgPSBfdGhpcy5wcm9wcy50cmFuc2xhdGUoJ3JlYWN0LnB1dEF3YXkuaGlnaGVyUXVhbnRpdHkubGFiZWwnLCAnUXVhbnRpdHkgY2Fubm90IGJlIGdyZWF0ZXIgdGhhbiBvcmlnaW5hbCBwdXRhd2F5IGl0ZW0gcXVhbnRpdHknKTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChlZGl0KSB7CiAgICAgICAgICAgIHZhciBfcHJvcHMkb3JpZ2luYWwyOwogICAgICAgICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoVG9vbHRpcCwgewogICAgICAgICAgICAgIGh0bWw6IGRpc2FibGVkTWVzc2FnZSwKICAgICAgICAgICAgICBkaXNhYmxlZDogIWRpc2FibGVkTWVzc2FnZSwKICAgICAgICAgICAgICB0aGVtZTogInRyYW5zcGFyZW50IiwKICAgICAgICAgICAgICBhcnJvdzogInRydWUiLAogICAgICAgICAgICAgIGRlbGF5OiAiMTUwIiwKICAgICAgICAgICAgICBkdXJhdGlvbjogIjI1MCIsCiAgICAgICAgICAgICAgaGlkZURlbGF5OiAiNTAiCiAgICAgICAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgICAgICAgY2xhc3NOYW1lOiBoYXNWYWxpZGF0aW9uRXJyb3IocHJvcHMgPT09IG51bGwgfHwgcHJvcHMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHByb3BzLnZhbHVlLCAoX3Byb3BzJG9yaWdpbmFsMiA9IHByb3BzLm9yaWdpbmFsKSA9PT0gbnVsbCB8fCBfcHJvcHMkb3JpZ2luYWwyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfcHJvcHMkb3JpZ2luYWwyLnF1YW50aXR5QXZhaWxhYmxlKSA/ICdoYXMtZXJyb3InIDogJycKICAgICAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImlucHV0IiwgewogICAgICAgICAgICAgIHR5cGU6ICJudW1iZXIiLAogICAgICAgICAgICAgIGNsYXNzTmFtZTogImZvcm0tY29udHJvbCBmb3JtLWNvbnRyb2wteHMiLAogICAgICAgICAgICAgIHZhbHVlOiBwcm9wcy52YWx1ZSwKICAgICAgICAgICAgICBvbkNoYW5nZTogZnVuY3Rpb24gb25DaGFuZ2UoZXZlbnQpIHsKICAgICAgICAgICAgICAgIHZhciBwdXRBd2F5ID0gdXBkYXRlKF90aGlzLnN0YXRlLnB1dEF3YXksIHsKICAgICAgICAgICAgICAgICAgcHV0YXdheUl0ZW1zOiBfZGVmaW5lUHJvcGVydHkoe30sIGl0ZW1JbmRleCwgewogICAgICAgICAgICAgICAgICAgIHF1YW50aXR5OiB7CiAgICAgICAgICAgICAgICAgICAgICAkc2V0OiBldmVudC50YXJnZXQudmFsdWUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIF90aGlzLmNoYW5nZVB1dEF3YXkocHV0QXdheSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KSkpOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRvb2x0aXAsIHsKICAgICAgICAgICAgaHRtbDogZGlzYWJsZWRNZXNzYWdlLAogICAgICAgICAgICBkaXNhYmxlZDogIWRpc2FibGVkTWVzc2FnZSwKICAgICAgICAgICAgdGhlbWU6ICJ0cmFuc3BhcmVudCIsCiAgICAgICAgICAgIGFycm93OiAidHJ1ZSIsCiAgICAgICAgICAgIGRlbGF5OiAiMTUwIiwKICAgICAgICAgICAgZHVyYXRpb246ICIyNTAiLAogICAgICAgICAgICBoaWRlRGVsYXk6ICI1MCIKICAgICAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgICAgIGNsYXNzTmFtZTogaGFzVmFsaWRhdGlvbkVycm9yKHByb3BzLnZhbHVlLCAoX3Byb3BzJG9yaWdpbmFsMyA9IHByb3BzLm9yaWdpbmFsKSA9PT0gbnVsbCB8fCBfcHJvcHMkb3JpZ2luYWwzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfcHJvcHMkb3JpZ2luYWwzLnF1YW50aXR5QXZhaWxhYmxlKSA/ICdoYXMtZXJyb3InIDogJycKICAgICAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwgcHJvcHMudmFsdWUgPyBwcm9wcy52YWx1ZS50b0xvY2FsZVN0cmluZygnZW4tVVMnKSA6IHByb3BzLnZhbHVlKSkpOwogICAgICAgIH0sCiAgICAgICAgRmlsdGVyOiBGaWx0ZXIKICAgICAgfSwgewogICAgICAgIEhlYWRlcjogLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoVHJhbnNsYXRlLCB7CiAgICAgICAgICBpZDogInJlYWN0LnB1dEF3YXkucHJlZmVycmVkQmluLmxhYmVsIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiUHJlZmVycmVkIGJpbiIKICAgICAgICB9KSwKICAgICAgICBhY2Nlc3NvcjogJ3ByZWZlcnJlZEJpbicsCiAgICAgICAgc3R5bGU6IHsKICAgICAgICAgIHdoaXRlU3BhY2U6ICdub3JtYWwnCiAgICAgICAgfSwKICAgICAgICBDZWxsOiBmdW5jdGlvbiBDZWxsKHByb3BzKSB7CiAgICAgICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIG51bGwsIHByb3BzLnZhbHVlICYmIHByb3BzLnZhbHVlLnpvbmVOYW1lID8gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIG51bGwsIHByb3BzLnZhbHVlLnpvbmVOYW1lLCAiOlx4QTAiKSA6ICcnLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgbnVsbCwgcHJvcHMudmFsdWUgPyBwcm9wcy52YWx1ZS5uYW1lIDogJycpKTsKICAgICAgICB9LAogICAgICAgIEZpbHRlcjogRmlsdGVyCiAgICAgIH0sIHsKICAgICAgICBIZWFkZXI6IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyYW5zbGF0ZSwgewogICAgICAgICAgaWQ6ICJyZWFjdC5wdXRBd2F5LmN1cnJlbnRCaW4ubGFiZWwiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJDdXJyZW50IGJpbiIKICAgICAgICB9KSwKICAgICAgICBhY2Nlc3NvcjogJ2N1cnJlbnRCaW5zJywKICAgICAgICBzdHlsZTogewogICAgICAgICAgd2hpdGVTcGFjZTogJ25vcm1hbCcKICAgICAgICB9LAogICAgICAgIEZpbHRlcjogRmlsdGVyCiAgICAgIH0sIHsKICAgICAgICBIZWFkZXI6IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyYW5zbGF0ZSwgewogICAgICAgICAgaWQ6ICJyZWFjdC5wdXRBd2F5LnN0b2NrTW92ZW1lbnQubGFiZWwiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJTdG9jayBNb3ZlbWVudCIKICAgICAgICB9KSwKICAgICAgICBhY2Nlc3NvcjogJ3N0b2NrTW92ZW1lbnQubmFtZScsCiAgICAgICAgc3R5bGU6IHsKICAgICAgICAgIHdoaXRlU3BhY2U6ICdub3JtYWwnCiAgICAgICAgfSwKICAgICAgICBFeHBhbmRlcjogZnVuY3Rpb24gRXhwYW5kZXIoX3JlZikgewogICAgICAgICAgdmFyIGlzRXhwYW5kZWQgPSBfcmVmLmlzRXhwYW5kZWQ7CiAgICAgICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCB7CiAgICAgICAgICAgIGNsYXNzTmFtZTogIm1sLTIiCiAgICAgICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgICBjbGFzc05hbWU6ICJydC1leHBhbmRlciAiLmNvbmNhdChpc0V4cGFuZGVkICYmICctb3BlbicpCiAgICAgICAgICB9LCAiXHUyMDIyIikpOwogICAgICAgIH0sCiAgICAgICAgZmlsdGVyYWJsZTogdHJ1ZSwKICAgICAgICBGaWx0ZXI6IEZpbHRlcgogICAgICB9LCB7CiAgICAgICAgSGVhZGVyOiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUcmFuc2xhdGUsIHsKICAgICAgICAgIGlkOiAicmVhY3QucHV0QXdheS5wdXRBd2F5QmluLmxhYmVsIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiUHV0YXdheSBCaW4iCiAgICAgICAgfSksCiAgICAgICAgYWNjZXNzb3I6ICdwdXRhd2F5TG9jYXRpb24nLAogICAgICAgIENlbGw6IGZ1bmN0aW9uIENlbGwoY2VsbEluZm8pIHsKICAgICAgICAgIHZhciBzcGxpdEl0ZW1zID0gXy5nZXQoX3RoaXMuc3RhdGUucHV0QXdheS5wdXRhd2F5SXRlbXMsICJbIi5jb25jYXQoY2VsbEluZm8uaW5kZXgsICJdLnNwbGl0SXRlbXMiKSk7CiAgICAgICAgICBpZiAoc3BsaXRJdGVtcyAmJiBzcGxpdEl0ZW1zLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyYW5zbGF0ZSwgewogICAgICAgICAgICAgIGlkOiAicmVhY3QucHV0QXdheS5zcGxpdExpbmUubGFiZWwiLAogICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiU3BsaXQgbGluZSIKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoU2VsZWN0LCB7CiAgICAgICAgICAgIG9wdGlvbnM6IF90aGlzLnN0YXRlLmJpbnMsCiAgICAgICAgICAgIHZhbHVlS2V5OiAiaWQiLAogICAgICAgICAgICBsYWJlbEtleTogIm5hbWUiLAogICAgICAgICAgICB2YWx1ZTogXy5nZXQoX3RoaXMuc3RhdGUucHV0QXdheS5wdXRhd2F5SXRlbXMsICJbIi5jb25jYXQoY2VsbEluZm8uaW5kZXgsICJdLiIpLmNvbmNhdChjZWxsSW5mby5jb2x1bW4uaWQpKSB8fCBudWxsLAogICAgICAgICAgICBvbkNoYW5nZTogZnVuY3Rpb24gb25DaGFuZ2UodmFsdWUpIHsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuY2hhbmdlUHV0QXdheSh1cGRhdGUoX3RoaXMuc3RhdGUucHV0QXdheSwgewogICAgICAgICAgICAgICAgcHV0YXdheUl0ZW1zOiBfZGVmaW5lUHJvcGVydHkoe30sIGNlbGxJbmZvLmluZGV4LCB7CiAgICAgICAgICAgICAgICAgIHB1dGF3YXlMb2NhdGlvbjogewogICAgICAgICAgICAgICAgICAgICRzZXQ6IHZhbHVlCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICB9LAogICAgICAgICAgICBjbGFzc05hbWU6ICJzZWxlY3QteHMiCiAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIEZpbHRlcjogRmlsdGVyCiAgICAgIH0sIHsKICAgICAgICBIZWFkZXI6ICcnLAogICAgICAgIGFjY2Vzc29yOiAnc3BsaXRJdGVtcycsCiAgICAgICAgQ2VsbDogZnVuY3Rpb24gQ2VsbChjZWxsSW5mbykgewogICAgICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgICAgIGNsYXNzTmFtZTogImQtZmxleCBmbGV4LXJvdyBmbGV4LXdyYXAiCiAgICAgICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChTcGxpdExpbmVNb2RhbCwgewogICAgICAgICAgICBwdXRhd2F5SXRlbTogX3RoaXMuc3RhdGUucHV0QXdheS5wdXRhd2F5SXRlbXNbY2VsbEluZm8uaW5kZXhdLAogICAgICAgICAgICBzcGxpdEl0ZW1zOiBfLmdldChfdGhpcy5zdGF0ZS5wdXRBd2F5LnB1dGF3YXlJdGVtcywgIlsiLmNvbmNhdChjZWxsSW5mby5pbmRleCwgIl0uIikuY29uY2F0KGNlbGxJbmZvLmNvbHVtbi5pZCkpLAogICAgICAgICAgICBzYXZlU3BsaXRJdGVtczogZnVuY3Rpb24gc2F2ZVNwbGl0SXRlbXMoc3BsaXRJdGVtcykgewogICAgICAgICAgICAgIF90aGlzLnNhdmVTcGxpdEl0ZW1zKHNwbGl0SXRlbXMsIGNlbGxJbmZvLmluZGV4KTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgYmluczogX3RoaXMuc3RhdGUuYmlucwogICAgICAgICAgfSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJidXR0b24iLCB7CiAgICAgICAgICAgIGNsYXNzTmFtZTogImJ0biBidG4tb3V0bGluZS1wcmltYXJ5IGJ0bi14cyBtci0xIG1iLTEiLAogICAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICAgIHJldHVybiBfdGhpcy5lZGl0SXRlbShjZWxsSW5mby5pbmRleCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyYW5zbGF0ZSwgewogICAgICAgICAgICBpZDogInJlYWN0LmRlZmF1bHQuYnV0dG9uLmVkaXQubGFiZWwiLAogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkVkaXQiCiAgICAgICAgICB9KSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJidXR0b24iLCB7CiAgICAgICAgICAgIGNsYXNzTmFtZTogImJ0biBidG4tb3V0bGluZS1kYW5nZXIgYnRuLXhzIG1iLTEiLAogICAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICAgIHJldHVybiBfdGhpcy5kZWxldGVJdGVtKGNlbGxJbmZvLmluZGV4KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoVHJhbnNsYXRlLCB7CiAgICAgICAgICAgIGlkOiAicmVhY3QuZGVmYXVsdC5idXR0b24uZGVsZXRlLmxhYmVsIiwKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJEZWxldGUiCiAgICAgICAgICB9KSkpOwogICAgICAgIH0sCiAgICAgICAgZmlsdGVyYWJsZTogZmFsc2UKICAgICAgfV07CiAgICB9KTsKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImRhdGFGZXRjaGVkIiwgZmFsc2UpOwogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAidG9nZ2xlVHJlZSIsIGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKF90aGlzLnN0YXRlLnBpdm90QnkubGVuZ3RoKSB7CiAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgcGl2b3RCeTogW10sCiAgICAgICAgICBleHBhbmRlZDoge30KICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICBwaXZvdEJ5OiBbJ3N0b2NrTW92ZW1lbnQubmFtZSddLAogICAgICAgICAgZXhwYW5kZWQ6IHt9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0pOwogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZmlsdGVyTWV0aG9kIiwgZnVuY3Rpb24gKGZpbHRlciwgcm93KSB7CiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bmRlcnNjb3JlLWRhbmdsZQogICAgICBpZiAocm93Ll9hZ2dyZWdhdGVkIHx8IHJvdy5fZ3JvdXBlZEJ5UGl2b3QpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgICB2YXIgdmFsID0gcm93W2ZpbHRlci5pZF07CiAgICAgIGlmIChmaWx0ZXIuaWQgPT09ICdwdXRhd2F5TG9jYXRpb24nKSB7CiAgICAgICAgdmFsID0gXy5nZXQodmFsLCAnbmFtZScpOwogICAgICB9CiAgICAgIHJldHVybiBfLnRvU3RyaW5nKHZhbCkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhmaWx0ZXIudmFsdWUudG9Mb3dlckNhc2UoKSk7CiAgICB9KTsKICAgIF90aGlzLmdldENvbHVtbnMgPSBfdGhpcy5nZXRDb2x1bW5zLmJpbmQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcykpOwogICAgX3RoaXMuZmV0Y2hJdGVtcyA9IF90aGlzLmZldGNoSXRlbXMuYmluZChfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSk7CiAgICBfdGhpcy5lZGl0SXRlbSA9IF90aGlzLmVkaXRJdGVtLmJpbmQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcykpOwogICAgdmFyIGNvbHVtbnMgPSBfdGhpcy5nZXRDb2x1bW5zKCk7CiAgICB2YXIgX3RoaXMkcHJvcHMkaW5pdGlhbFZhID0gX3RoaXMucHJvcHMuaW5pdGlhbFZhbHVlcywKICAgICAgX3B1dEF3YXkgPSBfdGhpcyRwcm9wcyRpbml0aWFsVmEucHV0QXdheSwKICAgICAgcGl2b3RCeSA9IF90aGlzJHByb3BzJGluaXRpYWxWYS5waXZvdEJ5LAogICAgICBfZXhwYW5kZWQgPSBfdGhpcyRwcm9wcyRpbml0aWFsVmEuZXhwYW5kZWQ7CiAgICBfdGhpcy5zdGF0ZSA9IHsKICAgICAgcHV0QXdheTogX3B1dEF3YXkgfHwge30sCiAgICAgIGNvbHVtbnM6IGNvbHVtbnMsCiAgICAgIHBpdm90Qnk6IHBpdm90QnkgfHwgWydzdG9ja01vdmVtZW50Lm5hbWUnXSwKICAgICAgZXhwYW5kZWQ6IF9leHBhbmRlZCwKICAgICAgYmluczogW10sCiAgICAgIGxvY2F0aW9uOiBfdGhpcy5wcm9wcy5sb2NhdGlvbiwKICAgICAgc29ydEJ5OiBfcHV0QXdheSAmJiBfcHV0QXdheS5zb3J0QnkKICAgIH07CiAgICByZXR1cm4gX3RoaXM7CiAgfQogIF9jcmVhdGVDbGFzcyhQdXRBd2F5U2Vjb25kUGFnZSwgW3sKICAgIGtleTogImNvbXBvbmVudERpZE1vdW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHsKICAgICAgaWYgKHRoaXMucHJvcHMucHV0QXdheVRyYW5zbGF0aW9uc0ZldGNoZWQpIHsKICAgICAgICB0aGlzLmRhdGFGZXRjaGVkID0gdHJ1ZTsKICAgICAgICB0aGlzLmZldGNoQmlucygpOwogICAgICB9CiAgICAgIHRoaXMuZmV0Y2hQdXRBd2F5KCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhuZXh0UHJvcHMpIHsKICAgICAgc2hvd0xvY2F0aW9uQ2hhbmdlZEFsZXJ0KHRoaXMucHJvcHMudHJhbnNsYXRlLCB0aGlzLnN0YXRlLmxvY2F0aW9uLCBuZXh0UHJvcHMubG9jYXRpb24sIGZ1bmN0aW9uICgpIHsKICAgICAgICB3aW5kb3cubG9jYXRpb24gPSAnL29wZW5ib3hlcy9vcmRlci9saXN0P29yZGVyVHlwZT1QVVRBV0FZX09SREVSJnN0YXR1cz1QRU5ESU5HJzsKICAgICAgfSk7CiAgICAgIHZhciBsb2NhdGlvbiA9IHRoaXMuc3RhdGUubG9jYXRpb24uaWQgPyB0aGlzLnN0YXRlLmxvY2F0aW9uIDogbmV4dFByb3BzLmxvY2F0aW9uOwogICAgICB0aGlzLnNldFN0YXRlKHsKICAgICAgICBsb2NhdGlvbjogbG9jYXRpb24KICAgICAgfSk7CiAgICAgIGlmIChuZXh0UHJvcHMucHV0QXdheVRyYW5zbGF0aW9uc0ZldGNoZWQgJiYgIXRoaXMuZGF0YUZldGNoZWQpIHsKICAgICAgICB0aGlzLmRhdGFGZXRjaGVkID0gdHJ1ZTsKICAgICAgICB0aGlzLmZldGNoQmlucygpOwogICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBDYWxsZWQgd2hlbiBhbiBleHBhbmRlciBpcyBjbGlja2VkLiBDaGVja3MgZXhwYW5kZWQgcm93cyBhbmQgY291bnRzIHRoZWlyIG51bWJlci4KICAgICAqIEBwYXJhbSB7b2JqZWN0fSBleHBhbmRlZAogICAgICogQHB1YmxpYwogICAgICovCiAgfSwgewogICAga2V5OiAiZmV0Y2hQdXRBd2F5IiwKICAgIHZhbHVlOgogICAgLyoqCiAgICAgKiBGZXRjaGVzIHB1dGF3YXkgaXRlbXMgYW5kIHNldHMgdGhlbSBpbiByZWR1eCBmb3JtIGFuZCBpbgogICAgICogc3RhdGUgYXMgY3VycmVudCBsaW5lIGl0ZW1zLgogICAgICogQHB1YmxpYwogICAgICovCgogICAgZnVuY3Rpb24gZmV0Y2hQdXRBd2F5KCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKICAgICAgaWYgKHRoaXMucHJvcHMubWF0Y2gucGFyYW1zLnB1dEF3YXlJZCkgewogICAgICAgIHRoaXMucHJvcHMuc2hvd1NwaW5uZXIoKTsKICAgICAgICB2YXIgdXJsID0gIi9vcGVuYm94ZXMvYXBpL3B1dGF3YXlzLyIuY29uY2F0KHRoaXMucHJvcHMubWF0Y2gucGFyYW1zLnB1dEF3YXlJZCk7CiAgICAgICAgYXBpQ2xpZW50LmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICB2YXIgcHV0QXdheSA9IHBhcnNlUmVzcG9uc2UocmVzcG9uc2UuZGF0YS5kYXRhKTsKICAgICAgICAgIHZhciBwdXRhd2F5SXRlbXMgPSBfLm1hcChwdXRBd2F5LnB1dGF3YXlJdGVtcywgZnVuY3Rpb24gKHZhbCkgewogICAgICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCB2YWwpLCB7fSwgewogICAgICAgICAgICAgIHB1dGF3YXlMb2NhdGlvbjogdmFsLnB1dGF3YXlMb2NhdGlvbi5pZCB8fCB2YWwucHJlZmVycmVkQmluLmlkID8gewogICAgICAgICAgICAgICAgaWQ6IHZhbC5wdXRhd2F5TG9jYXRpb24uaWQgPyB2YWwucHV0YXdheUxvY2F0aW9uLmlkIDogdmFsLnByZWZlcnJlZEJpbi5pZCwKICAgICAgICAgICAgICAgIG5hbWU6IHZhbC5wdXRhd2F5TG9jYXRpb24ubmFtZSA/IHZhbC5wdXRhd2F5TG9jYXRpb24ubmFtZSA6IHZhbC5wcmVmZXJyZWRCaW4ubmFtZSwKICAgICAgICAgICAgICAgIHpvbmVJZDogdmFsLnB1dGF3YXlMb2NhdGlvbi5pZCA/IHZhbC5wdXRhd2F5TG9jYXRpb24uem9uZUlkIDogdmFsLnByZWZlcnJlZEJpbi56b25lSWQsCiAgICAgICAgICAgICAgICB6b25lTmFtZTogdmFsLnB1dGF3YXlMb2NhdGlvbi5pZCA/IHZhbC5wdXRhd2F5TG9jYXRpb24uem9uZU5hbWUgOiB2YWwucHJlZmVycmVkQmluLnpvbmVOYW1lCiAgICAgICAgICAgICAgfSA6IG51bGwKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICAgIF90aGlzMi5wcm9wcy5oaWRlU3Bpbm5lcigpOwogICAgICAgICAgdmFyIGV4cGFuZGVkID0ge307CiAgICAgICAgICBfLmZvckVhY2gocHV0YXdheUl0ZW1zLCBmdW5jdGlvbiAoaXRlbSwgaW5kZXgpIHsKICAgICAgICAgICAgZXhwYW5kZWRbaW5kZXhdID0gdHJ1ZTsKICAgICAgICAgIH0pOwogICAgICAgICAgX3RoaXMyLnNldFN0YXRlKHsKICAgICAgICAgICAgZXhwYW5kZWQ6IGV4cGFuZGVkLAogICAgICAgICAgICBwdXRBd2F5OiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHB1dEF3YXkpLCB7fSwgewogICAgICAgICAgICAgIHB1dGF3YXlJdGVtczogcHV0YXdheUl0ZW1zCiAgICAgICAgICAgIH0pCiAgICAgICAgICB9KTsKICAgICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMyLnByb3BzLmhpZGVTcGlubmVyKCk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIE1ldGhvZCB0aGF0IGlzIHBhc3NlZCB0byByZWFjdCB0YWJsZSdzIG9wdGlvbjogZGVmYXVsdEZpbHRlck1ldGhvZC4KICAgICAqIEl0IGZpbHRlcnMgcm93cyBhbmQgY29udmVydHMgYSBzdHJpbmcgdG8gbG93ZXJjYXNlIGxldHRlcnMuCiAgICAgKiBAcGFyYW0ge29iamVjdH0gZmlsdGVyCiAgICAgKiBAcGFyYW0ge29iamVjdH0gcm93CiAgICAgKiBAcHVibGljCiAgICAgKi8KICB9LCB7CiAgICBrZXk6ICJmZXRjaEJpbnMiLAogICAgdmFsdWU6CiAgICAvKioKICAgICAqIEZldGNoZXMgYXZhaWxhYmxlIGJpbiBsb2NhdGlvbnMgZnJvbSBBUEkuCiAgICAgKiBAcHVibGljCiAgICAgKi8KICAgIGZ1bmN0aW9uIGZldGNoQmlucygpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CiAgICAgIHRoaXMucHJvcHMuc2hvd1NwaW5uZXIoKTsKICAgICAgdmFyIHVybCA9ICcvb3BlbmJveGVzL2FwaS9pbnRlcm5hbExvY2F0aW9ucyc7CiAgICAgIHZhciBtYXBCaW5zID0gZnVuY3Rpb24gbWFwQmlucyhiaW5zKSB7CiAgICAgICAgcmV0dXJuIF8uY2hhaW4oYmlucykub3JkZXJCeShbJ25hbWUnXSwgWydhc2MnXSkudmFsdWUoKTsKICAgICAgfTsKICAgICAgcmV0dXJuIGFwaUNsaWVudC5nZXQodXJsLCB7CiAgICAgICAgcGFyYW1zU2VyaWFsaXplcjogZnVuY3Rpb24gcGFyYW1zU2VyaWFsaXplcihwYXJhbWV0ZXJzKSB7CiAgICAgICAgICByZXR1cm4gcXVlcnlTdHJpbmcuc3RyaW5naWZ5KHBhcmFtZXRlcnMpOwogICAgICAgIH0sCiAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAnbG9jYXRpb24uaWQnOiB0aGlzLnByb3BzLmxvY2F0aW9uLmlkLAogICAgICAgICAgbG9jYXRpb25UeXBlQ29kZTogWydCSU5fTE9DQVRJT04nLCAnSU5URVJOQUwnXSwKICAgICAgICAgIGlnbm9yZUFjdGl2aXR5Q29kZXM6IFsnUkVDRUlWRV9TVE9DSyddCiAgICAgICAgfQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIHZhciBiaW5Hcm91cHMgPSBfLnBhcnRpdGlvbihyZXNwb25zZS5kYXRhLmRhdGEsIGZ1bmN0aW9uIChiaW4pIHsKICAgICAgICAgIHJldHVybiBiaW4uem9uZU5hbWU7CiAgICAgICAgfSk7CiAgICAgICAgdmFyIGJpbnNXaXRoWm9uZSA9IF8uY2hhaW4oYmluR3JvdXBzWzBdKS5ncm91cEJ5KCd6b25lTmFtZScpLm1hcChmdW5jdGlvbiAodmFsdWUsIGtleSkgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgbmFtZToga2V5LAogICAgICAgICAgICBvcHRpb25zOiBtYXBCaW5zKHZhbHVlKQogICAgICAgICAgfTsKICAgICAgICB9KS5vcmRlckJ5KFsnbGFiZWwnXSwgWydhc2MnXSkudmFsdWUoKTsKICAgICAgICB2YXIgYmluc1dpdGhvdXRab25lID0gbWFwQmlucyhiaW5Hcm91cHNbMV0pOwogICAgICAgIF90aGlzMy5zZXRTdGF0ZSh7CiAgICAgICAgICBiaW5zOiBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGJpbnNXaXRoWm9uZSksIF90b0NvbnN1bWFibGVBcnJheShiaW5zV2l0aG91dFpvbmUpKQogICAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBfdGhpczMucHJvcHMuaGlkZVNwaW5uZXIoKTsKICAgICAgICB9KTsKICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBfdGhpczMucHJvcHMuaGlkZVNwaW5uZXIoKTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTYXZlIHB1dC1hd2F5IHdpdGggbmV3IHNwbGl0IGl0ZW1zLgogICAgICogQHB1YmxpYwogICAgICovCiAgfSwgewogICAga2V5OiAic2F2ZVNwbGl0SXRlbXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNhdmVTcGxpdEl0ZW1zKHNwbGl0SXRlbXMsIGl0ZW1JbmRleCkgewogICAgICB2YXIgcHV0QXdheSA9IHVwZGF0ZSh0aGlzLnN0YXRlLnB1dEF3YXksIHsKICAgICAgICBwdXRhd2F5SXRlbXM6IF9kZWZpbmVQcm9wZXJ0eSh7fSwgaXRlbUluZGV4LCB7CiAgICAgICAgICBzcGxpdEl0ZW1zOiB7CiAgICAgICAgICAgICRzZXQ6IHNwbGl0SXRlbXMKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICB9KTsKICAgICAgdGhpcy5zYXZlUHV0QXdheXMocHV0QXdheSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZW5kcyBhbGwgY2hhbmdlcyBtYWRlIGJ5IHVzZXIgaW4gdGhpcyBzdGVwIG9mIHB1dC1hd2F5IHRvIEFQSSBhbmQgdXBkYXRlcyBkYXRhLgogICAgICogQHB1YmxpYwogICAgICovCiAgfSwgewogICAga2V5OiAic2F2ZVB1dEF3YXlzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzYXZlUHV0QXdheXMocHV0QXdheVRvU2F2ZSwgY2FsbGJhY2spIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CiAgICAgIHRoaXMucHJvcHMuc2hvd1NwaW5uZXIoKTsKICAgICAgdmFyIHVybCA9ICIvb3BlbmJveGVzL2FwaS9wdXRhd2F5cz9sb2NhdGlvbi5pZD0iLmNvbmNhdCh0aGlzLnN0YXRlLmxvY2F0aW9uLmlkKTsKICAgICAgcmV0dXJuIGFwaUNsaWVudC5wb3N0KHVybCwgZmxhdHRlblJlcXVlc3QocHV0QXdheVRvU2F2ZSkpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgdmFyIHB1dEF3YXkgPSBwYXJzZVJlc3BvbnNlKHJlc3BvbnNlLmRhdGEuZGF0YSk7CiAgICAgICAgX3RoaXM0LnNldFN0YXRlKHsKICAgICAgICAgIHB1dEF3YXk6IHB1dEF3YXkKICAgICAgICB9LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpczQucHJvcHMuaGlkZVNwaW5uZXIoKTsKICAgICAgICAgIGlmIChjYWxsYmFjaykgewogICAgICAgICAgICBjYWxsYmFjayhwdXRBd2F5KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBfdGhpczQucHJvcHMuaGlkZVNwaW5uZXIoKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY2hhbmdlUHV0QXdheSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2hhbmdlUHV0QXdheShwdXRBd2F5KSB7CiAgICAgIHRoaXMuc2V0U3RhdGUoewogICAgICAgIHB1dEF3YXk6IHB1dEF3YXkKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZWRpdEl0ZW0iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGVkaXRJdGVtKGl0ZW1JbmRleCkgewogICAgICB2YXIgcHV0QXdheSA9IHVwZGF0ZSh0aGlzLnN0YXRlLnB1dEF3YXksIHsKICAgICAgICBwdXRhd2F5SXRlbXM6IF9kZWZpbmVQcm9wZXJ0eSh7fSwgaXRlbUluZGV4LCB7CiAgICAgICAgICBlZGl0OiB7CiAgICAgICAgICAgICRzZXQ6IHRydWUKICAgICAgICAgIH0sCiAgICAgICAgICBzcGxpdEl0ZW1zOiB7CiAgICAgICAgICAgICRzZXQ6IF8ubWFwKF8uZmlsdGVyKHRoaXMuc3RhdGUucHV0QXdheS5wdXRhd2F5SXRlbXNbaXRlbUluZGV4XS5zcGxpdEl0ZW1zLCBmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgIHJldHVybiBpdGVtLmlkOwogICAgICAgICAgICB9KSwgZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBpdGVtKSwge30sIHsKICAgICAgICAgICAgICAgICJkZWxldGUiOiB0cnVlCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgfSk7CiAgICAgIHRoaXMuY2hhbmdlUHV0QXdheShwdXRBd2F5KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJkZWxldGVJdGVtIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkZWxldGVJdGVtKGl0ZW1JbmRleCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKICAgICAgdGhpcy5wcm9wcy5zaG93U3Bpbm5lcigpOwogICAgICB2YXIgdXJsID0gIi9vcGVuYm94ZXMvYXBpL3B1dGF3YXlJdGVtcy8iLmNvbmNhdChfLmdldCh0aGlzLnN0YXRlLnB1dEF3YXkucHV0YXdheUl0ZW1zLCAiWyIuY29uY2F0KGl0ZW1JbmRleCwgIl0uaWQiKSkpOwogICAgICBhcGlDbGllbnRbImRlbGV0ZSJdKHVybCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIHB1dEF3YXkgPSB1cGRhdGUoX3RoaXM1LnN0YXRlLnB1dEF3YXksIHsKICAgICAgICAgIHB1dGF3YXlJdGVtczogewogICAgICAgICAgICAkc3BsaWNlOiBbW2l0ZW1JbmRleCwgMV1dCiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgX3RoaXM1LmNoYW5nZVB1dEF3YXkocHV0QXdheSk7CiAgICAgICAgX3RoaXM1LnByb3BzLmhpZGVTcGlubmVyKCk7CiAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gX3RoaXM1LnByb3BzLmhpZGVTcGlubmVyKCk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogU2F2ZSBwdXQtYXdheSBhbmQgZ28gdG8gbmV4dCBwYWdlLgogICAgICogQHB1YmxpYwogICAgICovCiAgfSwgewogICAga2V5OiAibmV4dFBhZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG5leHRQYWdlKCkgewogICAgICB2YXIgX3RoaXM2ID0gdGhpczsKICAgICAgaWYgKF8uc29tZSh0aGlzLnN0YXRlLnB1dEF3YXkucHV0YXdheUl0ZW1zLCBmdW5jdGlvbiAocHV0YXdheUl0ZW0pIHsKICAgICAgICByZXR1cm4gcHV0YXdheUl0ZW0ucXVhbnRpdHkgPiBwdXRhd2F5SXRlbS5xdWFudGl0eUF2YWlsYWJsZTsKICAgICAgfSkpIHsKICAgICAgICBjb25maXJtQWxlcnQoewogICAgICAgICAgdGl0bGU6IHRoaXMucHJvcHMudHJhbnNsYXRlKCdyZWFjdC5wdXRBd2F5Lm1lc3NhZ2UucHV0QXdheUVycm9yLmxhYmVsJywgJ1B1dGF3YXkgZXJyb3InKSwKICAgICAgICAgIG1lc3NhZ2U6IHRoaXMucHJvcHMudHJhbnNsYXRlKCdyZWFjdC5wdXRBd2F5LnB1dEF3YXlBbGVydC5tZXNzYWdlJywgJ0Nhbm5vdCBwdXQgYXdheSBtb3JlIHRoYW4gaXMgYXZhaWxhYmxlIGluIHRoZSByZWNlaXZpbmcgYmluLiBSZWR1Y2UgcXVhbnRpdHkgb2YgaXRlbXMgaW4gcmVkIHRvIG1hdGNoIHRoZSBxdWFudGl0eSBpbiB0aGUgcmVjZWl2aW5nIGJpbi4nKSwKICAgICAgICAgIGJ1dHRvbnM6IFt7CiAgICAgICAgICAgIGxhYmVsOiB0aGlzLnByb3BzLnRyYW5zbGF0ZSgncmVhY3QuZGVmYXVsdC5vay5sYWJlbCcsICdPSycpCiAgICAgICAgICB9XQogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc2F2ZVB1dEF3YXlzKHRoaXMuc3RhdGUucHV0QXdheSwgZnVuY3Rpb24gKHB1dEF3YXkpIHsKICAgICAgICAgIF90aGlzNi5wcm9wcy5uZXh0UGFnZSh7CiAgICAgICAgICAgIHB1dEF3YXk6IHB1dEF3YXksCiAgICAgICAgICAgIHBpdm90Qnk6IF90aGlzNi5zdGF0ZS5waXZvdEJ5LAogICAgICAgICAgICBleHBhbmRlZDogX3RoaXM2LnN0YXRlLmV4cGFuZGVkCiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogR2VuZXJhdGVzIGEgcGRmIHRoYXQgc2hvd3Mgd2hhdCBzaG91bGQgYmUgcHV0dGVkIGF3YXkuCiAgICAgKiBAcHVibGljCiAgICAgKi8KICB9LCB7CiAgICBrZXk6ICJnZW5lcmF0ZVB1dEF3YXlMaXN0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZW5lcmF0ZVB1dEF3YXlMaXN0KCkgewogICAgICB2YXIgX3RoaXM3ID0gdGhpczsKICAgICAgdGhpcy5wcm9wcy5zaG93U3Bpbm5lcigpOwogICAgICB2YXIgdXJsID0gJy9vcGVuYm94ZXMvcHV0QXdheS9nZW5lcmF0ZVBkZic7CiAgICAgIHZhciBwdXRhd2F5TnVtYmVyID0gdGhpcy5zdGF0ZS5wdXRBd2F5LnB1dGF3YXlOdW1iZXI7CiAgICAgIHJldHVybiBhcGlDbGllbnQucG9zdCh1cmwsIGZsYXR0ZW5SZXF1ZXN0KHRoaXMuc3RhdGUucHV0QXdheSksIHsKICAgICAgICByZXNwb25zZVR5cGU6ICdibG9iJwogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIGZpbGVEb3dubG9hZChyZXNwb25zZS5kYXRhLCAiUHV0YXdheVJlcG9ydCIuY29uY2F0KHB1dGF3YXlOdW1iZXIgPyAiLSIuY29uY2F0KHB1dGF3YXlOdW1iZXIpIDogJycsICIucGRmIiksICdhcHBsaWNhdGlvbi9wZGYnKTsKICAgICAgICBfdGhpczcuZmV0Y2hJdGVtcyhfdGhpczcuc3RhdGUuc29ydEJ5KTsKICAgICAgICBfdGhpczcucHJvcHMuaGlkZVNwaW5uZXIoKTsKICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBfdGhpczcucHJvcHMuaGlkZVNwaW5uZXIoKTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTb3J0IHB1dGF3YXkgaXRlbXMgaW4gb3JkZXIgY2hvc2VuIGJ5IHRoZSB1c2VyCiAgICAgKiBAcHVibGljCiAgICAgKi8KICB9LCB7CiAgICBrZXk6ICJzb3J0UHV0YXdheUl0ZW1zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzb3J0UHV0YXdheUl0ZW1zKCkgewogICAgICB2YXIgc29ydEJ5ID0gdGhpcy5zdGF0ZS5zb3J0Qnk7CiAgICAgIHN3aXRjaCAoc29ydEJ5KSB7CiAgICAgICAgY2FzZSAnY3VycmVudEJpbnMnOgogICAgICAgICAgc29ydEJ5ID0gJ3ByZWZlcnJlZEJpbic7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICdwcmVmZXJyZWRCaW4nOgogICAgICAgICAgc29ydEJ5ID0gJyc7CiAgICAgICAgICBicmVhazsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgc29ydEJ5ID0gJ2N1cnJlbnRCaW5zJzsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIHRoaXMuc2V0U3RhdGUoewogICAgICAgIHNvcnRCeTogc29ydEJ5CiAgICAgIH0pOwogICAgICB0aGlzLmZldGNoSXRlbXMoc29ydEJ5KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJmZXRjaEl0ZW1zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmZXRjaEl0ZW1zKHNvcnRCeSkgewogICAgICB2YXIgX3RoaXM4ID0gdGhpczsKICAgICAgdmFyIHVybCA9ICIvb3BlbmJveGVzL2FwaS9wdXRhd2F5cy8iLmNvbmNhdCh0aGlzLnN0YXRlLnB1dEF3YXkuaWQsICI/c29ydEJ5PSIpLmNvbmNhdChzb3J0QnkpOwogICAgICByZXR1cm4gYXBpQ2xpZW50LmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgdmFyIHB1dGF3YXlJdGVtcyA9IF8ubWFwKHBhcnNlUmVzcG9uc2UocmVzcG9uc2UuZGF0YS5kYXRhLnB1dGF3YXlJdGVtcyksIGZ1bmN0aW9uICh2YWwpIHsKICAgICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHZhbCksIHt9LCB7CiAgICAgICAgICAgIHB1dGF3YXlMb2NhdGlvbjogdmFsLnB1dGF3YXlMb2NhdGlvbi5pZCB8fCB2YWwucHJlZmVycmVkQmluLmlkID8gewogICAgICAgICAgICAgIGlkOiB2YWwucHV0YXdheUxvY2F0aW9uLmlkID8gdmFsLnB1dGF3YXlMb2NhdGlvbi5pZCA6IHZhbC5wcmVmZXJyZWRCaW4uaWQsCiAgICAgICAgICAgICAgbmFtZTogdmFsLnB1dGF3YXlMb2NhdGlvbi5uYW1lID8gdmFsLnB1dGF3YXlMb2NhdGlvbi5uYW1lIDogdmFsLnByZWZlcnJlZEJpbi5uYW1lLAogICAgICAgICAgICAgIHpvbmVJZDogdmFsLnB1dGF3YXlMb2NhdGlvbi5pZCA/IHZhbC5wdXRhd2F5TG9jYXRpb24uem9uZUlkIDogdmFsLnByZWZlcnJlZEJpbi56b25lSWQsCiAgICAgICAgICAgICAgem9uZU5hbWU6IHZhbC5wdXRhd2F5TG9jYXRpb24uaWQgPyB2YWwucHV0YXdheUxvY2F0aW9uLnpvbmVOYW1lIDogdmFsLnByZWZlcnJlZEJpbi56b25lTmFtZQogICAgICAgICAgICB9IDogbnVsbAogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgICAgX3RoaXM4LmNoYW5nZVB1dEF3YXkoX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBfdGhpczguc3RhdGUucHV0QXdheSksIHt9LCB7CiAgICAgICAgICBzb3J0Qnk6IHNvcnRCeSwKICAgICAgICAgIHB1dGF3YXlJdGVtczogcHV0YXdheUl0ZW1zCiAgICAgICAgfSkpOwogICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIF90aGlzOC5wcm9wcy5oaWRlU3Bpbm5lcigpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHsKICAgICAgdmFyIF90aGlzOSA9IHRoaXM7CiAgICAgIHZhciBvbkV4cGFuZGVkQ2hhbmdlID0gdGhpcy5vbkV4cGFuZGVkQ2hhbmdlLAogICAgICAgIHRvZ2dsZVRyZWUgPSB0aGlzLnRvZ2dsZVRyZWU7CiAgICAgIHZhciBfdGhpcyRzdGF0ZSA9IHRoaXMuc3RhdGUsCiAgICAgICAgY29sdW1ucyA9IF90aGlzJHN0YXRlLmNvbHVtbnMsCiAgICAgICAgcGl2b3RCeSA9IF90aGlzJHN0YXRlLnBpdm90QnksCiAgICAgICAgZXhwYW5kZWQgPSBfdGhpcyRzdGF0ZS5leHBhbmRlZCwKICAgICAgICBzb3J0QnkgPSBfdGhpcyRzdGF0ZS5zb3J0Qnk7CiAgICAgIHZhciBleHRyYVByb3BzID0gewogICAgICAgIHBpdm90Qnk6IHBpdm90QnksCiAgICAgICAgZXhwYW5kZWQ6IGV4cGFuZGVkLAogICAgICAgIG9uRXhwYW5kZWRDaGFuZ2U6IG9uRXhwYW5kZWRDaGFuZ2UKICAgICAgfTsKICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgY2xhc3NOYW1lOiAicHV0YXdheSIKICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBjbGFzc05hbWU6ICJkLWZsZXgganVzdGlmeS1jb250ZW50LWJldHdlZW4gbWItMiBwdXRhd2F5LWJ1dHRvbnMiCiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCBudWxsLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUcmFuc2xhdGUsIHsKICAgICAgICBpZDogInJlYWN0LnB1dEF3YXkuc2hvd0J5LmxhYmVsIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlNob3cgYnkiCiAgICAgIH0pLCAiOiIsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJidXR0b24iLCB7CiAgICAgICAgY2xhc3NOYW1lOiAiYnRuIGJ0bi1wcmltYXJ5IG1sLTIgYnRuLXhzIiwKICAgICAgICAiZGF0YS10b2dnbGUiOiAiYnV0dG9uIiwKICAgICAgICAiYXJpYS1wcmVzc2VkIjogImZhbHNlIiwKICAgICAgICBvbkNsaWNrOiB0b2dnbGVUcmVlCiAgICAgIH0sIHBpdm90QnkgJiYgcGl2b3RCeS5sZW5ndGggPyAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUcmFuc2xhdGUsIHsKICAgICAgICBpZDogInJlYWN0LnB1dEF3YXkuc3RvY2tNb3ZlbWVudC5sYWJlbCIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJTdG9jayBNb3ZlbWVudCIKICAgICAgfSkgOiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUcmFuc2xhdGUsIHsKICAgICAgICBpZDogInJlYWN0LnB1dEF3YXkucHJvZHVjdC5sYWJlbCIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJQcm9kdWN0IgogICAgICB9KSkpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIHsKICAgICAgICBjbGFzc05hbWU6ICJidXR0b25zLWNvbnRhaW5lciBjbGFzc2ljLWZvcm0tYnV0dG9ucyIKICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIsIHsKICAgICAgICB0eXBlOiAiYnV0dG9uIiwKICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzOS5zYXZlUHV0QXdheXMoX3RoaXM5LnN0YXRlLnB1dEF3YXksIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzOS5zb3J0UHV0YXdheUl0ZW1zKCk7CiAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIGNsYXNzTmFtZTogImJ0biBidG4tb3V0bGluZS1zZWNvbmRhcnkgYnRuLXhzIG1yLTMiCiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwgdGhpcy5wcm9wcy50cmFuc2xhdGUoIC8qIGVzbGludC1kaXNhYmxlIG5vLW5lc3RlZC10ZXJuYXJ5ICovInJlYWN0LnB1dEF3YXkuIi5jb25jYXQoIXNvcnRCeSA/ICdzb3J0QnlDdXJyZW50QmlucycgOiBzb3J0QnkgPT09ICdjdXJyZW50QmlucycgPyAnc29ydEJ5UHJlZmVycmVkQmluJyA6ICdvcmlnaW5hbE9yZGVyJywgIi5sYWJlbCIpLCAhc29ydEJ5ID8gJ1NvcnQgYnkgY3VycmVudCBiaW5zJyA6IHNvcnRCeSA9PT0gJ2N1cnJlbnRCaW5zJyA/ICdTb3J0IGJ5IHByZWZlcnJlZCBiaW4nIDogJ09yaWdpbmFsIG9yZGVyJykpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIsIHsKICAgICAgICBjbGFzc05hbWU6ICJidG4gYnRuLW91dGxpbmUtc2Vjb25kYXJ5IGJ0bi14cyBtci0zIiwKICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzOS5zYXZlUHV0QXdheXMoX3RoaXM5LnN0YXRlLnB1dEF3YXksIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzOS5nZW5lcmF0ZVB1dEF3YXlMaXN0KCk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImkiLCB7CiAgICAgICAgY2xhc3NOYW1lOiAiZmEgZmEtcHJpbnQgcHItMiIKICAgICAgfSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyYW5zbGF0ZSwgewogICAgICAgIGlkOiAicmVhY3QucHV0QXdheS5nZW5lcmF0ZUxpc3QubGFiZWwiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiR2VuZXJhdGUgUHV0YXdheSBsaXN0IgogICAgICB9KSkpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiYnV0dG9uIiwgewogICAgICAgIHR5cGU6ICJidXR0b24iLAogICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXM5LnNhdmVQdXRBd2F5cyhfdGhpczkuc3RhdGUucHV0QXdheSk7CiAgICAgICAgfSwKICAgICAgICBjbGFzc05hbWU6ICJidG4gYnRuLW91dGxpbmUtc2Vjb25kYXJ5IGJ0bi14cyIsCiAgICAgICAgZGlzYWJsZWQ6IF8uc29tZSh0aGlzLnN0YXRlLnB1dEF3YXkucHV0YXdheUl0ZW1zLCBmdW5jdGlvbiAocHV0YXdheUl0ZW0pIHsKICAgICAgICAgIHJldHVybiBoYXNWYWxpZGF0aW9uRXJyb3IocHV0YXdheUl0ZW0ucXVhbnRpdHksIHB1dGF3YXlJdGVtLnF1YW50aXR5QXZhaWxhYmxlKTsKICAgICAgICB9KQogICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUcmFuc2xhdGUsIHsKICAgICAgICBpZDogInJlYWN0LmRlZmF1bHQuYnV0dG9uLnNhdmUubGFiZWwiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiU2F2ZSIKICAgICAgfSkpKSksIHRoaXMuc3RhdGUucHV0QXdheS5wdXRhd2F5SXRlbXMgPyAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChTZWxlY3RUcmVlVGFibGUsIF9leHRlbmRzKHsKICAgICAgICBkYXRhOiB0aGlzLnN0YXRlLnB1dEF3YXkucHV0YXdheUl0ZW1zLAogICAgICAgIGNvbHVtbnM6IGNvbHVtbnMsCiAgICAgICAgcmVmOiBmdW5jdGlvbiByZWYocikgewogICAgICAgICAgX3RoaXM5LnNlbGVjdFRhYmxlID0gcjsKICAgICAgICB9LAogICAgICAgIGNsYXNzTmFtZTogIi1zdHJpcGVkIC1oaWdobGlnaHQiCiAgICAgIH0sIGV4dHJhUHJvcHMsIHsKICAgICAgICBkZWZhdWx0UGFnZVNpemU6IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSLAogICAgICAgIG1pblJvd3M6IDAsCiAgICAgICAgc2hvd1BhZ2luYXRpb25Cb3R0b206IGZhbHNlLAogICAgICAgIGZpbHRlcmFibGU6IHRydWUsCiAgICAgICAgZGVmYXVsdEZpbHRlck1ldGhvZDogdGhpcy5maWx0ZXJNZXRob2QKICAgICAgfSkpIDogbnVsbCwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBjbGFzc05hbWU6ICJzdWJtaXQtYnV0dG9ucyIKICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIsIHsKICAgICAgICBkaXNhYmxlZDogXy5zb21lKHRoaXMuc3RhdGUucHV0QXdheS5wdXRhd2F5SXRlbXMsIGZ1bmN0aW9uIChwdXRhd2F5SXRlbSkgewogICAgICAgICAgcmV0dXJuIGhhc1ZhbGlkYXRpb25FcnJvcihwdXRhd2F5SXRlbS5xdWFudGl0eSwgcHV0YXdheUl0ZW0ucXVhbnRpdHlBdmFpbGFibGUpOwogICAgICAgIH0pLAogICAgICAgIHR5cGU6ICJidXR0b24iLAogICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXM5Lm5leHRQYWdlKCk7CiAgICAgICAgfSwKICAgICAgICBjbGFzc05hbWU6ICJidG4gYnRuLW91dGxpbmUtcHJpbWFyeSBidG4tZm9ybSBmbG9hdC1yaWdodCBidG4teHMiCiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyYW5zbGF0ZSwgewogICAgICAgIGlkOiAicmVhY3QuZGVmYXVsdC5idXR0b24ubmV4dC5sYWJlbCIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJOZXh0IgogICAgICB9KSkpKTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIFB1dEF3YXlTZWNvbmRQYWdlOwp9KENvbXBvbmVudCk7CnZhciBtYXBTdGF0ZVRvUHJvcHMgPSBmdW5jdGlvbiBtYXBTdGF0ZVRvUHJvcHMoc3RhdGUpIHsKICByZXR1cm4gewogICAgdHJhbnNsYXRlOiB0cmFuc2xhdGVXaXRoRGVmYXVsdE1lc3NhZ2UoZ2V0VHJhbnNsYXRlKHN0YXRlLmxvY2FsaXplKSksCiAgICBwdXRBd2F5VHJhbnNsYXRpb25zRmV0Y2hlZDogc3RhdGUuc2Vzc2lvbi5mZXRjaGVkVHJhbnNsYXRpb25zLnB1dEF3YXkKICB9Owp9OwpleHBvcnQgZGVmYXVsdCBjb25uZWN0KG1hcFN0YXRlVG9Qcm9wcywgewogIHNob3dTcGlubmVyOiBzaG93U3Bpbm5lciwKICBoaWRlU3Bpbm5lcjogaGlkZVNwaW5uZXIKfSkoUHV0QXdheVNlY29uZFBhZ2UpOwpQdXRBd2F5U2Vjb25kUGFnZS5kZWZhdWx0UHJvcHMgPSB7CiAgb3JpZ2luYWw6IHt9Cn07ClB1dEF3YXlTZWNvbmRQYWdlLnByb3BUeXBlcyA9IHsKICAvKiogRnVuY3Rpb24gY2FsbGVkIHdoZW4gZGF0YSBpcyBsb2FkaW5nICovCiAgc2hvd1NwaW5uZXI6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsCiAgLyoqIEZ1bmN0aW9uIGNhbGxlZCB3aGVuIGRhdGEgaGFzIGxvYWRlZCAqLwogIGhpZGVTcGlubmVyOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLAogIC8qKiBGdW5jdGlvbiB0YWtpbmcgdXNlciB0byB0aGUgbmV4dCBwYWdlICovCiAgbmV4dFBhZ2U6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsCiAgdHJhbnNsYXRlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLAogIC8qKiBBbGwgcHV0LWF3YXkncyBkYXRhICovCiAgaW5pdGlhbFZhbHVlczogUHJvcFR5cGVzLnNoYXBlKHsKICAgIHB1dEF3YXk6IFByb3BUeXBlcy5hcnJheU9mKFByb3BUeXBlcy5zaGFwZSh7fSkpLAogICAgcGl2b3RCeTogUHJvcFR5cGVzLmFycmF5T2YoUHJvcFR5cGVzLnNoYXBlKHt9KSksCiAgICBleHBhbmRlZDogUHJvcFR5cGVzLmFycmF5T2YoUHJvcFR5cGVzLnNoYXBlKHt9KSkKICB9KS5pc1JlcXVpcmVkLAogIG9yaWdpbmFsOiBQcm9wVHlwZXMuc2hhcGUoewogICAgcXVhbnRpdHlBdmFpbGFibGU6IFByb3BUeXBlcy5udW1iZXIKICB9KSwKICBtYXRjaDogUHJvcFR5cGVzLnNoYXBlKHsKICAgIHBhcmFtczogUHJvcFR5cGVzLnNoYXBlKHsKICAgICAgcHV0QXdheUlkOiBQcm9wVHlwZXMuc3RyaW5nCiAgICB9KQogIH0pLmlzUmVxdWlyZWQsCiAgLyoqIExvY2F0aW9uIChjdXJyZW50bHkgY2hvc2VuKS4gVG8gYmUgdXNlZCBpbiBpbnRlcm5hbExvY2F0aW9ucyBhbmQgcHV0YXdheXMgcmVxdWVzdHMuICovCiAgbG9jYXRpb246IFByb3BUeXBlcy5zaGFwZSh7CiAgICBpZDogUHJvcFR5cGVzLnN0cmluZwogIH0pLmlzUmVxdWlyZWQsCiAgcHV0QXdheVRyYW5zbGF0aW9uc0ZldGNoZWQ6IFByb3BUeXBlcy5ib29sLmlzUmVxdWlyZWQKfTs="},null]}