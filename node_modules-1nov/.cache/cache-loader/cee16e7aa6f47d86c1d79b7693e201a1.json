{"remainingRequest":"/opt/MTOBS-BIKASH/node_modules/babel-loader/lib/index.js?presets[]=@babel/react&presets[]=@babel/env!/opt/MTOBS-BIKASH/node_modules/eslint-loader/dist/cjs.js!/opt/MTOBS-BIKASH/src/js/components/stock-movement-wizard/inbound/CreateStockMovement.jsx","dependencies":[{"path":"/opt/MTOBS-BIKASH/src/js/components/stock-movement-wizard/inbound/CreateStockMovement.jsx","mtime":1698037749000},{"path":"/opt/MTOBS-BIKASH/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/opt/MTOBS-BIKASH/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/opt/MTOBS-BIKASH/node_modules/eslint-loader/dist/cjs.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsgcmV0dXJuIF90eXBlb2YgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgInN5bWJvbCIgPT0gdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfSwgX3R5cGVvZihvYmopOyB9CmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBlbnVtZXJhYmxlT25seSAmJiAoc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7IH0pKSwga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBudWxsICE9IGFyZ3VtZW50c1tpXSA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpICUgMiA/IG93bktleXMoT2JqZWN0KHNvdXJjZSksICEwKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7IH0pIDogT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpIDogb3duS2V5cyhPYmplY3Qoc291cmNlKSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSByZXR1cm4gdGFyZ2V0OyB9CmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsga2V5ID0gX3RvUHJvcGVydHlLZXkoa2V5KTsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9CmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBfdG9Qcm9wZXJ0eUtleShkZXNjcmlwdG9yLmtleSksIGRlc2NyaXB0b3IpOyB9IH0KZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29uc3RydWN0b3IsICJwcm90b3R5cGUiLCB7IHdyaXRhYmxlOiBmYWxzZSB9KTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9CmZ1bmN0aW9uIF90b1Byb3BlcnR5S2V5KGFyZykgeyB2YXIga2V5ID0gX3RvUHJpbWl0aXZlKGFyZywgInN0cmluZyIpOyByZXR1cm4gX3R5cGVvZihrZXkpID09PSAic3ltYm9sIiA/IGtleSA6IFN0cmluZyhrZXkpOyB9CmZ1bmN0aW9uIF90b1ByaW1pdGl2ZShpbnB1dCwgaGludCkgeyBpZiAoX3R5cGVvZihpbnB1dCkgIT09ICJvYmplY3QiIHx8IGlucHV0ID09PSBudWxsKSByZXR1cm4gaW5wdXQ7IHZhciBwcmltID0gaW5wdXRbU3ltYm9sLnRvUHJpbWl0aXZlXTsgaWYgKHByaW0gIT09IHVuZGVmaW5lZCkgeyB2YXIgcmVzID0gcHJpbS5jYWxsKGlucHV0LCBoaW50IHx8ICJkZWZhdWx0Iik7IGlmIChfdHlwZW9mKHJlcykgIT09ICJvYmplY3QiKSByZXR1cm4gcmVzOyB0aHJvdyBuZXcgVHlwZUVycm9yKCJAQHRvUHJpbWl0aXZlIG11c3QgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlLiIpOyB9IHJldHVybiAoaGludCA9PT0gInN0cmluZyIgPyBTdHJpbmcgOiBOdW1iZXIpKGlucHV0KTsgfQpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzdWJDbGFzcywgInByb3RvdHlwZSIsIHsgd3JpdGFibGU6IGZhbHNlIH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfQpmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2YuYmluZCgpIDogZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfQpmdW5jdGlvbiBfY3JlYXRlU3VwZXIoRGVyaXZlZCkgeyB2YXIgaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCA9IF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKTsgcmV0dXJuIGZ1bmN0aW9uIF9jcmVhdGVTdXBlckludGVybmFsKCkgeyB2YXIgU3VwZXIgPSBfZ2V0UHJvdG90eXBlT2YoRGVyaXZlZCksIHJlc3VsdDsgaWYgKGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QpIHsgdmFyIE5ld1RhcmdldCA9IF9nZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3RvcjsgcmVzdWx0ID0gUmVmbGVjdC5jb25zdHJ1Y3QoU3VwZXIsIGFyZ3VtZW50cywgTmV3VGFyZ2V0KTsgfSBlbHNlIHsgcmVzdWx0ID0gU3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfSByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgcmVzdWx0KTsgfTsgfQpmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikpIHsgcmV0dXJuIGNhbGw7IH0gZWxzZSBpZiAoY2FsbCAhPT0gdm9pZCAwKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkRlcml2ZWQgY29uc3RydWN0b3JzIG1heSBvbmx5IHJldHVybiBvYmplY3Qgb3IgdW5kZWZpbmVkIik7IH0gcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7IH0KZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7IGlmIChzZWxmID09PSB2b2lkIDApIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsgfSByZXR1cm4gc2VsZjsgfQpmdW5jdGlvbiBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCkgeyBpZiAodHlwZW9mIFJlZmxlY3QgPT09ICJ1bmRlZmluZWQiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlOyBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlOyBpZiAodHlwZW9mIFByb3h5ID09PSAiZnVuY3Rpb24iKSByZXR1cm4gdHJ1ZTsgdHJ5IHsgQm9vbGVhbi5wcm90b3R5cGUudmFsdWVPZi5jYWxsKFJlZmxlY3QuY29uc3RydWN0KEJvb2xlYW4sIFtdLCBmdW5jdGlvbiAoKSB7fSkpOyByZXR1cm4gdHJ1ZTsgfSBjYXRjaCAoZSkgeyByZXR1cm4gZmFsc2U7IH0gfQpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YuYmluZCgpIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfQppbXBvcnQgUmVhY3QsIHsgQ29tcG9uZW50IH0gZnJvbSAncmVhY3QnOwppbXBvcnQgXyBmcm9tICdsb2Rhc2gnOwppbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7CmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7CmltcG9ydCB7IGNvbmZpcm1BbGVydCB9IGZyb20gJ3JlYWN0LWNvbmZpcm0tYWxlcnQnOwppbXBvcnQgeyBGb3JtIH0gZnJvbSAncmVhY3QtZmluYWwtZm9ybSc7CmltcG9ydCB7IGdldFRyYW5zbGF0ZSB9IGZyb20gJ3JlYWN0LWxvY2FsaXplLXJlZHV4JzsKaW1wb3J0IHsgY29ubmVjdCB9IGZyb20gJ3JlYWN0LXJlZHV4JzsKaW1wb3J0IHsgd2l0aFJvdXRlciB9IGZyb20gJ3JlYWN0LXJvdXRlci1kb20nOwppbXBvcnQgeyBoaWRlU3Bpbm5lciwgc2hvd1NwaW5uZXIgfSBmcm9tICdhY3Rpb25zJzsKaW1wb3J0IERhdGVGaWVsZCBmcm9tICdjb21wb25lbnRzL2Zvcm0tZWxlbWVudHMvRGF0ZUZpZWxkJzsKaW1wb3J0IFNlbGVjdEZpZWxkIGZyb20gJ2NvbXBvbmVudHMvZm9ybS1lbGVtZW50cy9TZWxlY3RGaWVsZCc7CmltcG9ydCBUZXh0RmllbGQgZnJvbSAnY29tcG9uZW50cy9mb3JtLWVsZW1lbnRzL1RleHRGaWVsZCc7CmltcG9ydCBhcGlDbGllbnQgZnJvbSAndXRpbHMvYXBpQ2xpZW50JzsKaW1wb3J0IHsgcmVuZGVyRm9ybUZpZWxkIH0gZnJvbSAndXRpbHMvZm9ybS11dGlscyc7CmltcG9ydCB7IGRlYm91bmNlTG9jYXRpb25zRmV0Y2gsIGRlYm91bmNlUGVvcGxlRmV0Y2ggfSBmcm9tICd1dGlscy9vcHRpb24tdXRpbHMnOwppbXBvcnQgVHJhbnNsYXRlLCB7IHRyYW5zbGF0ZVdpdGhEZWZhdWx0TWVzc2FnZSB9IGZyb20gJ3V0aWxzL1RyYW5zbGF0ZSc7CmltcG9ydCAncmVhY3QtY29uZmlybS1hbGVydC9zcmMvcmVhY3QtY29uZmlybS1hbGVydC5jc3MnOwpmdW5jdGlvbiB2YWxpZGF0ZSh2YWx1ZXMpIHsKICB2YXIgZXJyb3JzID0ge307CiAgaWYgKCF2YWx1ZXMuZGVzY3JpcHRpb24pIHsKICAgIGVycm9ycy5kZXNjcmlwdGlvbiA9ICdyZWFjdC5kZWZhdWx0LmVycm9yLnJlcXVpcmVkRmllbGQubGFiZWwnOwogIH0KICBpZiAoIXZhbHVlcy5vcmlnaW4pIHsKICAgIGVycm9ycy5vcmlnaW4gPSAncmVhY3QuZGVmYXVsdC5lcnJvci5yZXF1aXJlZEZpZWxkLmxhYmVsJzsKICB9CiAgaWYgKCF2YWx1ZXMuZGVzdGluYXRpb24pIHsKICAgIGVycm9ycy5kZXN0aW5hdGlvbiA9ICdyZWFjdC5kZWZhdWx0LmVycm9yLnJlcXVpcmVkRmllbGQubGFiZWwnOwogIH0KICBpZiAoIXZhbHVlcy5yZXF1ZXN0ZWRCeSkgewogICAgZXJyb3JzLnJlcXVlc3RlZEJ5ID0gJ3JlYWN0LmRlZmF1bHQuZXJyb3IucmVxdWlyZWRGaWVsZC5sYWJlbCc7CiAgfQogIGlmICghdmFsdWVzLmRhdGVSZXF1ZXN0ZWQpIHsKICAgIGVycm9ycy5kYXRlUmVxdWVzdGVkID0gJ3JlYWN0LmRlZmF1bHQuZXJyb3IucmVxdWlyZWRGaWVsZC5sYWJlbCc7CiAgfSBlbHNlIHsKICAgIHZhciBkYXRlUmVxdWVzdGVkID0gbW9tZW50KHZhbHVlcy5kYXRlUmVxdWVzdGVkLCAnTU0vREQvWVlZWScpOwogICAgaWYgKG1vbWVudCgpLmRpZmYoZGF0ZVJlcXVlc3RlZCkgPCAwKSB7CiAgICAgIGVycm9ycy5kYXRlUmVxdWVzdGVkID0gJ3JlYWN0LnN0b2NrTW92ZW1lbnQuZXJyb3IuZnV0dXJlRGF0ZS5sYWJlbCc7CiAgICB9CiAgfQogIHJldHVybiBlcnJvcnM7Cn0KdmFyIEZJRUxEUyA9IHsKICBkZXNjcmlwdGlvbjogewogICAgdHlwZTogVGV4dEZpZWxkLAogICAgbGFiZWw6ICdyZWFjdC5zdG9ja01vdmVtZW50LmRlc2NyaXB0aW9uLmxhYmVsJywKICAgIGRlZmF1bHRNZXNzYWdlOiAnRGVzY3JpcHRpb24nLAogICAgYXR0cmlidXRlczogewogICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgYXV0b0ZvY3VzOiB0cnVlCiAgICB9CiAgfSwKICBvcmlnaW46IHsKICAgIHR5cGU6IFNlbGVjdEZpZWxkLAogICAgbGFiZWw6ICdyZWFjdC5zdG9ja01vdmVtZW50Lm9yaWdpbi5sYWJlbCcsCiAgICBkZWZhdWx0TWVzc2FnZTogJ09yaWdpbicsCiAgICBhdHRyaWJ1dGVzOiB7CiAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICBhc3luYzogdHJ1ZSwKICAgICAgc2hvd1ZhbHVlVG9vbHRpcDogdHJ1ZSwKICAgICAgb3Blbk9uQ2xpY2s6IGZhbHNlLAogICAgICBhdXRvbG9hZDogZmFsc2UsCiAgICAgIGNhY2hlOiBmYWxzZSwKICAgICAgb3B0aW9uczogW10sCiAgICAgIGZpbHRlck9wdGlvbnM6IGZ1bmN0aW9uIGZpbHRlck9wdGlvbnMob3B0aW9ucykgewogICAgICAgIHJldHVybiBvcHRpb25zOwogICAgICB9CiAgICB9LAogICAgZ2V0RHluYW1pY0F0dHI6IGZ1bmN0aW9uIGdldER5bmFtaWNBdHRyKHByb3BzKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgbG9hZE9wdGlvbnM6IHByb3BzLmRlYm91bmNlZExvY2F0aW9uc0ZldGNoLAogICAgICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZSh2YWx1ZSkgewogICAgICAgICAgaWYgKHZhbHVlICYmIHByb3BzLmRlc3RpbmF0aW9uICYmIHByb3BzLmRlc3RpbmF0aW9uLmlkKSB7CiAgICAgICAgICAgIHByb3BzLmZldGNoU3RvY2tMaXN0cyh2YWx1ZSwgcHJvcHMuZGVzdGluYXRpb24pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9LAogIGRlc3RpbmF0aW9uOiB7CiAgICB0eXBlOiBTZWxlY3RGaWVsZCwKICAgIGxhYmVsOiAncmVhY3Quc3RvY2tNb3ZlbWVudC5kZXN0aW5hdGlvbi5sYWJlbCcsCiAgICBkZWZhdWx0TWVzc2FnZTogJ0Rlc3RpbmF0aW9uJywKICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgIGFzeW5jOiB0cnVlLAogICAgICBzaG93VmFsdWVUb29sdGlwOiB0cnVlLAogICAgICBvcGVuT25DbGljazogZmFsc2UsCiAgICAgIGF1dG9sb2FkOiBmYWxzZSwKICAgICAgY2FjaGU6IGZhbHNlLAogICAgICBvcHRpb25zOiBbXSwKICAgICAgZmlsdGVyT3B0aW9uczogZnVuY3Rpb24gZmlsdGVyT3B0aW9ucyhvcHRpb25zKSB7CiAgICAgICAgcmV0dXJuIG9wdGlvbnM7CiAgICAgIH0KICAgIH0sCiAgICBnZXREeW5hbWljQXR0cjogZnVuY3Rpb24gZ2V0RHluYW1pY0F0dHIocHJvcHMpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBsb2FkT3B0aW9uczogcHJvcHMuZGVib3VuY2VkTG9jYXRpb25zRmV0Y2gsCiAgICAgICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKHZhbHVlKSB7CiAgICAgICAgICBpZiAodmFsdWUgJiYgcHJvcHMub3JpZ2luICYmIHByb3BzLm9yaWdpbi5pZCkgewogICAgICAgICAgICBwcm9wcy5mZXRjaFN0b2NrTGlzdHMocHJvcHMub3JpZ2luLCB2YWx1ZSk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBkaXNhYmxlZDogIXByb3BzLmlzU3VwZXJ1c2VyCiAgICAgIH07CiAgICB9CiAgfSwKICBzdG9ja2xpc3Q6IHsKICAgIGxhYmVsOiAncmVhY3Quc3RvY2tNb3ZlbWVudC5zdG9ja2xpc3QubGFiZWwnLAogICAgZGVmYXVsdE1lc3NhZ2U6ICdTdG9ja2xpc3QnLAogICAgdHlwZTogU2VsZWN0RmllbGQsCiAgICBnZXREeW5hbWljQXR0cjogZnVuY3Rpb24gZ2V0RHluYW1pY0F0dHIoX3JlZikgewogICAgICB2YXIgb3JpZ2luID0gX3JlZi5vcmlnaW4sCiAgICAgICAgZGVzdGluYXRpb24gPSBfcmVmLmRlc3RpbmF0aW9uLAogICAgICAgIHN0b2NrbGlzdHMgPSBfcmVmLnN0b2NrbGlzdHM7CiAgICAgIHJldHVybiB7CiAgICAgICAgZGlzYWJsZWQ6ICEob3JpZ2luICYmIGRlc3RpbmF0aW9uICYmIG9yaWdpbi5pZCAmJiBkZXN0aW5hdGlvbi5pZCksCiAgICAgICAgb3B0aW9uczogc3RvY2tsaXN0cywKICAgICAgICBzaG93VmFsdWVUb29sdGlwOiB0cnVlLAogICAgICAgIHZhbHVlS2V5OiAnaWQnLAogICAgICAgIGxhYmVsS2V5OiAnbmFtZScKICAgICAgfTsKICAgIH0KICB9LAogIHJlcXVlc3RlZEJ5OiB7CiAgICB0eXBlOiBTZWxlY3RGaWVsZCwKICAgIGxhYmVsOiAncmVhY3Quc3RvY2tNb3ZlbWVudC5yZXF1ZXN0ZWRCeS5sYWJlbCcsCiAgICBkZWZhdWx0TWVzc2FnZTogJ1JlcXVlc3RlZCBieScsCiAgICBhdHRyaWJ1dGVzOiB7CiAgICAgIGFzeW5jOiB0cnVlLAogICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgc2hvd1ZhbHVlVG9vbHRpcDogdHJ1ZSwKICAgICAgb3Blbk9uQ2xpY2s6IGZhbHNlLAogICAgICBhdXRvbG9hZDogZmFsc2UsCiAgICAgIGNhY2hlOiBmYWxzZSwKICAgICAgb3B0aW9uczogW10sCiAgICAgIGxhYmVsS2V5OiAnbmFtZScsCiAgICAgIGZpbHRlck9wdGlvbnM6IGZ1bmN0aW9uIGZpbHRlck9wdGlvbnMob3B0aW9ucykgewogICAgICAgIHJldHVybiBvcHRpb25zOwogICAgICB9CiAgICB9LAogICAgZ2V0RHluYW1pY0F0dHI6IGZ1bmN0aW9uIGdldER5bmFtaWNBdHRyKHByb3BzKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgbG9hZE9wdGlvbnM6IHByb3BzLmRlYm91bmNlZFBlb3BsZUZldGNoCiAgICAgIH07CiAgICB9CiAgfSwKICBkYXRlUmVxdWVzdGVkOiB7CiAgICB0eXBlOiBEYXRlRmllbGQsCiAgICBsYWJlbDogJ3JlYWN0LnN0b2NrTW92ZW1lbnQuZGF0ZVJlcXVlc3RlZC5sYWJlbCcsCiAgICBkZWZhdWx0TWVzc2FnZTogJ0RhdGUgcmVxdWVzdGVkJywKICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgIGRhdGVGb3JtYXQ6ICdNTS9ERC9ZWVlZJywKICAgICAgYXV0b0NvbXBsZXRlOiAnb2ZmJwogICAgfQogIH0KfTsKCi8qKiBUaGUgZmlyc3Qgc3RlcCBvZiBzdG9jayBtb3ZlbWVudCB3aGVyZSB1c2VyIGNhbiBhZGQgYWxsIHRoZSBiYXNpYyBpbmZvcm1hdGlvbi4gKi8KdmFyIENyZWF0ZVN0b2NrTW92ZW1lbnQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoQ3JlYXRlU3RvY2tNb3ZlbWVudCwgX0NvbXBvbmVudCk7CiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihDcmVhdGVTdG9ja01vdmVtZW50KTsKICBmdW5jdGlvbiBDcmVhdGVTdG9ja01vdmVtZW50KHByb3BzKSB7CiAgICB2YXIgX3RoaXM7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ3JlYXRlU3RvY2tNb3ZlbWVudCk7CiAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKTsKICAgIF90aGlzLnN0YXRlID0gewogICAgICBzdG9ja2xpc3RzOiBbXSwKICAgICAgc2V0SW5pdGlhbFZhbHVlczogdHJ1ZSwKICAgICAgdmFsdWVzOiBfdGhpcy5wcm9wcy5pbml0aWFsVmFsdWVzCiAgICB9OwogICAgX3RoaXMuZmV0Y2hTdG9ja0xpc3RzID0gX3RoaXMuZmV0Y2hTdG9ja0xpc3RzLmJpbmQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcykpOwogICAgX3RoaXMuZGVib3VuY2VkUGVvcGxlRmV0Y2ggPSBkZWJvdW5jZVBlb3BsZUZldGNoKF90aGlzLnByb3BzLmRlYm91bmNlVGltZSwgX3RoaXMucHJvcHMubWluU2VhcmNoTGVuZ3RoKTsKICAgIF90aGlzLmRlYm91bmNlZExvY2F0aW9uc0ZldGNoID0gZGVib3VuY2VMb2NhdGlvbnNGZXRjaChfdGhpcy5wcm9wcy5kZWJvdW5jZVRpbWUsIF90aGlzLnByb3BzLm1pblNlYXJjaExlbmd0aCk7CiAgICByZXR1cm4gX3RoaXM7CiAgfQogIF9jcmVhdGVDbGFzcyhDcmVhdGVTdG9ja01vdmVtZW50LCBbewogICAga2V5OiAiY29tcG9uZW50RGlkTW91bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkgewogICAgICBpZiAodGhpcy5zdGF0ZS52YWx1ZXMub3JpZ2luICYmIHRoaXMuc3RhdGUudmFsdWVzLmRlc3RpbmF0aW9uKSB7CiAgICAgICAgdGhpcy5mZXRjaFN0b2NrTGlzdHModGhpcy5zdGF0ZS52YWx1ZXMub3JpZ2luLCB0aGlzLnN0YXRlLnZhbHVlcy5kZXN0aW5hdGlvbik7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wcykgewogICAgICBpZiAoIXRoaXMucHJvcHMubWF0Y2gucGFyYW1zLnN0b2NrTW92ZW1lbnRJZCAmJiB0aGlzLnN0YXRlLnNldEluaXRpYWxWYWx1ZXMgJiYgbmV4dFByb3BzLmxvY2F0aW9uLmlkKSB7CiAgICAgICAgdGhpcy5zZXRJbml0aWFsVmFsdWVzKG5leHRQcm9wcy5sb2NhdGlvbik7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRJbml0aWFsVmFsdWVzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRJbml0aWFsVmFsdWVzKGxvY2F0aW9uKSB7CiAgICAgIHZhciBpZCA9IGxvY2F0aW9uLmlkLAogICAgICAgIGxvY2F0aW9uVHlwZSA9IGxvY2F0aW9uLmxvY2F0aW9uVHlwZSwKICAgICAgICBuYW1lID0gbG9jYXRpb24ubmFtZTsKICAgICAgdmFyIHZhbHVlcyA9IHsKICAgICAgICBkZXN0aW5hdGlvbjogewogICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgdHlwZTogbG9jYXRpb25UeXBlID8gbG9jYXRpb25UeXBlLmxvY2F0aW9uVHlwZUNvZGUgOiBudWxsLAogICAgICAgICAgbmFtZTogbmFtZSwKICAgICAgICAgIGxhYmVsOiAiIi5jb25jYXQobmFtZSwgIiBbIikuY29uY2F0KGxvY2F0aW9uVHlwZSA/IGxvY2F0aW9uVHlwZS5kZXNjcmlwdGlvbiA6IG51bGwsICJdIikKICAgICAgICB9CiAgICAgIH07CiAgICAgIHRoaXMuc2V0U3RhdGUoewogICAgICAgIHZhbHVlczogdmFsdWVzLAogICAgICAgIHNldEluaXRpYWxWYWx1ZXM6IGZhbHNlCiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImNoZWNrU3RvY2tNb3ZlbWVudENoYW5nZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2hlY2tTdG9ja01vdmVtZW50Q2hhbmdlKG5ld1ZhbHVlcykgewogICAgICB2YXIgX3RoaXMkcHJvcHMkaW5pdGlhbFZhID0gdGhpcy5wcm9wcy5pbml0aWFsVmFsdWVzLAogICAgICAgIG9yaWdpbiA9IF90aGlzJHByb3BzJGluaXRpYWxWYS5vcmlnaW4sCiAgICAgICAgZGVzdGluYXRpb24gPSBfdGhpcyRwcm9wcyRpbml0aWFsVmEuZGVzdGluYXRpb24sCiAgICAgICAgc3RvY2tsaXN0ID0gX3RoaXMkcHJvcHMkaW5pdGlhbFZhLnN0b2NrbGlzdDsKICAgICAgdmFyIG9yaWdpbkxvY3MgPSBuZXdWYWx1ZXMub3JpZ2luICYmIG9yaWdpbjsKICAgICAgdmFyIGlzT2xkU3VwcGxpZXIgPSBvcmlnaW4gJiYgb3JpZ2luLnR5cGUgPT09ICdTVVBQTElFUic7CiAgICAgIHZhciBpc05ld1N1cHBsaWVyID0gbmV3VmFsdWVzLm9yaWdpbiAmJiBuZXdWYWx1ZXMudHlwZSA9PT0gJ1NVUFBMSUVSJzsKICAgICAgdmFyIGNoZWNrT3JpZ2luID0gb3JpZ2luTG9jcyAmJiAoIWlzT2xkU3VwcGxpZXIgfHwgaXNPbGRTdXBwbGllciAmJiAhaXNOZXdTdXBwbGllcikgPyBuZXdWYWx1ZXMub3JpZ2luLmlkICE9PSBvcmlnaW4uaWQgOiBmYWxzZTsKICAgICAgdmFyIGNoZWNrRGVzdCA9IHN0b2NrbGlzdCAmJiBuZXdWYWx1ZXMuZGVzdGluYXRpb24gJiYgZGVzdGluYXRpb24gPyBuZXdWYWx1ZXMuZGVzdGluYXRpb24uaWQgIT09IGRlc3RpbmF0aW9uLmlkIDogZmFsc2U7CiAgICAgIHZhciBjaGVja1N0b2NrTGlzdCA9IG5ld1ZhbHVlcy5zdG9ja01vdmVtZW50SWQgPyBfLmdldChuZXdWYWx1ZXMuc3RvY2tsaXN0LCAnaWQnLCBudWxsKSAhPT0gXy5nZXQoc3RvY2tsaXN0LCAnaWQnLCBudWxsKSA6IGZhbHNlOwogICAgICByZXR1cm4gY2hlY2tPcmlnaW4gfHwgY2hlY2tEZXN0IHx8IGNoZWNrU3RvY2tMaXN0OwogICAgfQoKICAgIC8qKgogICAgICogRmV0Y2hlcyBhdmFpbGFibGUgc3RvY2sgbGlzdHMgZnJvbSBBUEkgd2l0aCBnaXZlbiBvcmlnaW4gYW5kIGRlc3RpbmF0aW9uLgogICAgICogQHBhcmFtIHtvYmplY3R9IG9yaWdpbgogICAgICogQHBhcmFtIHtvYmplY3R9IGRlc3RpbmF0aW9uCiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBjbGVhclN0b2NrbGlzdAogICAgICogQHB1YmxpYwogICAgICovCiAgfSwgewogICAga2V5OiAiZmV0Y2hTdG9ja0xpc3RzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmZXRjaFN0b2NrTGlzdHMob3JpZ2luLCBkZXN0aW5hdGlvbiwgY2xlYXJTdG9ja2xpc3QpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CiAgICAgIHRoaXMucHJvcHMuc2hvd1NwaW5uZXIoKTsKICAgICAgdmFyIHVybCA9ICIvb3BlbmJveGVzL2FwaS9zdG9ja2xpc3RzP29yaWdpbj0iLmNvbmNhdChvcmlnaW4uaWQsICImZGVzdGluYXRpb249IikuY29uY2F0KGRlc3RpbmF0aW9uLmlkKTsKICAgICAgcmV0dXJuIGFwaUNsaWVudC5nZXQodXJsKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIHZhciBzdG9ja2xpc3RzID0gXy5tYXAocmVzcG9uc2UuZGF0YS5kYXRhLCBmdW5jdGlvbiAoc3RvY2tsaXN0KSB7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBpZDogc3RvY2tsaXN0LmlkLAogICAgICAgICAgICBuYW1lOiBzdG9ja2xpc3QubmFtZSwKICAgICAgICAgICAgdmFsdWU6IHN0b2NrbGlzdC5pZCwKICAgICAgICAgICAgbGFiZWw6IHN0b2NrbGlzdC5uYW1lCiAgICAgICAgICB9OwogICAgICAgIH0pOwogICAgICAgIHZhciBzdG9ja2xpc3RDaGFuZ2VkID0gIV8uZmluZChzdG9ja2xpc3RzLCBmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgcmV0dXJuIGl0ZW0udmFsdWUuaWQgPT09IF8uZ2V0KF90aGlzMi5zdGF0ZS52YWx1ZXMsICdzdG9ja2xpc3QuaWQnKTsKICAgICAgICB9KTsKICAgICAgICBpZiAoc3RvY2tsaXN0Q2hhbmdlZCAmJiBjbGVhclN0b2NrbGlzdCkgewogICAgICAgICAgY2xlYXJTdG9ja2xpc3QoKTsKICAgICAgICB9CiAgICAgICAgX3RoaXMyLnNldFN0YXRlKHsKICAgICAgICAgIHN0b2NrbGlzdHM6IHN0b2NrbGlzdHMKICAgICAgICB9LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMyLnByb3BzLmhpZGVTcGlubmVyKCk7CiAgICAgICAgfSk7CiAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gX3RoaXMyLnByb3BzLmhpZGVTcGlubmVyKCk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlcyBvciB1cGRhdGVzIHN0b2NrIG1vdmVtZW50IHdpdGggZ2l2ZW4gZGF0YQogICAgICogQHBhcmFtIHtvYmplY3R9IHZhbHVlcwogICAgICogQHB1YmxpYwogICAgICovCiAgfSwgewogICAga2V5OiAic2F2ZVN0b2NrTW92ZW1lbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNhdmVTdG9ja01vdmVtZW50KHZhbHVlcykgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKICAgICAgaWYgKHZhbHVlcy5vcmlnaW4gJiYgdmFsdWVzLmRlc3RpbmF0aW9uICYmIHZhbHVlcy5yZXF1ZXN0ZWRCeSAmJiB2YWx1ZXMuZGF0ZVJlcXVlc3RlZCAmJiB2YWx1ZXMuZGVzY3JpcHRpb24pIHsKICAgICAgICB0aGlzLnByb3BzLnNob3dTcGlubmVyKCk7CiAgICAgICAgdmFyIHN0b2NrTW92ZW1lbnRVcmwgPSAnJzsKICAgICAgICBpZiAodmFsdWVzLnN0b2NrTW92ZW1lbnRJZCkgewogICAgICAgICAgc3RvY2tNb3ZlbWVudFVybCA9ICIvb3BlbmJveGVzL2FwaS9zdG9ja01vdmVtZW50cy8iLmNvbmNhdCh2YWx1ZXMuc3RvY2tNb3ZlbWVudElkLCAiL3VwZGF0ZVJlcXVpc2l0aW9uIik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHN0b2NrTW92ZW1lbnRVcmwgPSAnL29wZW5ib3hlcy9hcGkvc3RvY2tNb3ZlbWVudHMnOwogICAgICAgIH0KICAgICAgICB2YXIgcGF5bG9hZCA9IHsKICAgICAgICAgIG5hbWU6ICcnLAogICAgICAgICAgZGVzY3JpcHRpb246IHZhbHVlcy5kZXNjcmlwdGlvbiwKICAgICAgICAgIGRhdGVSZXF1ZXN0ZWQ6IHZhbHVlcy5kYXRlUmVxdWVzdGVkLAogICAgICAgICAgJ29yaWdpbi5pZCc6IHZhbHVlcy5vcmlnaW4uaWQsCiAgICAgICAgICAnZGVzdGluYXRpb24uaWQnOiB2YWx1ZXMuZGVzdGluYXRpb24uaWQsCiAgICAgICAgICAncmVxdWVzdGVkQnkuaWQnOiB2YWx1ZXMucmVxdWVzdGVkQnkuaWQsCiAgICAgICAgICAnc3RvY2tsaXN0LmlkJzogXy5nZXQodmFsdWVzLnN0b2NrbGlzdCwgJ2lkJykgfHwgJycKICAgICAgICB9OwogICAgICAgIGFwaUNsaWVudC5wb3N0KHN0b2NrTW92ZW1lbnRVcmwsIHBheWxvYWQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSkgewogICAgICAgICAgICB2YXIgcmVzcCA9IHJlc3BvbnNlLmRhdGEuZGF0YTsKICAgICAgICAgICAgX3RoaXMzLnByb3BzLmhpc3RvcnkucHVzaCgiL29wZW5ib3hlcy9zdG9ja01vdmVtZW50L2NyZWF0ZUluYm91bmQvIi5jb25jYXQocmVzcC5pZCkpOwogICAgICAgICAgICBfdGhpczMucHJvcHMubmV4dFBhZ2UoX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCB2YWx1ZXMpLCB7fSwgewogICAgICAgICAgICAgIHN0b2NrTW92ZW1lbnRJZDogcmVzcC5pZCwKICAgICAgICAgICAgICBsaW5lSXRlbXM6IHJlc3AubGluZUl0ZW1zLAogICAgICAgICAgICAgIG1vdmVtZW50TnVtYmVyOiByZXNwLmlkZW50aWZpZXIsCiAgICAgICAgICAgICAgbmFtZTogcmVzcC5uYW1lLAogICAgICAgICAgICAgIHN0b2NrbGlzdDogcmVzcC5zdG9ja2xpc3QKICAgICAgICAgICAgfSkpOwogICAgICAgICAgfQogICAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzMy5wcm9wcy5oaWRlU3Bpbm5lcigpOwogICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihfdGhpczMucHJvcHMudHJhbnNsYXRlKCdyZWFjdC5zdG9ja01vdmVtZW50LmVycm9yLmNyZWF0ZVN0b2NrTW92ZW1lbnQubGFiZWwnLCAnQ291bGQgbm90IGNyZWF0ZSBzdG9jayBtb3ZlbWVudCcpKSk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZXNldFRvSW5pdGlhbFZhbHVlcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVzZXRUb0luaXRpYWxWYWx1ZXMoKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwogICAgICB0aGlzLnNldFN0YXRlKHsKICAgICAgICB2YWx1ZXM6IHt9CiAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gX3RoaXM0LnNldFN0YXRlKHsKICAgICAgICAgIHZhbHVlczogX3RoaXM0LnByb3BzLmluaXRpYWxWYWx1ZXMKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDYWxscyBtZXRob2QgY3JlYXRpbmcgb3Igc2F2aW5nIHN0b2NrIG1vdmVtZW50IGFuZCBtb3ZlcyB1c2VyIHRvIHRoZSBuZXh0IHBhZ2UuCiAgICAgKiBAcGFyYW0ge29iamVjdH0gdmFsdWVzCiAgICAgKiBAcHVibGljCiAgICAgKi8KICB9LCB7CiAgICBrZXk6ICJuZXh0UGFnZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbmV4dFBhZ2UodmFsdWVzKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwogICAgICB2YXIgc2hvd01vZGFsID0gdGhpcy5jaGVja1N0b2NrTW92ZW1lbnRDaGFuZ2UodmFsdWVzKTsKICAgICAgaWYgKCFzaG93TW9kYWwpIHsKICAgICAgICB0aGlzLnNhdmVTdG9ja01vdmVtZW50KHZhbHVlcyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uZmlybUFsZXJ0KHsKICAgICAgICAgIHRpdGxlOiB0aGlzLnByb3BzLnRyYW5zbGF0ZSgncmVhY3Quc3RvY2tNb3ZlbWVudC5tZXNzYWdlLmNvbmZpcm1DaGFuZ2UubGFiZWwnLCAnQ29uZmlybSBjaGFuZ2UnKSwKICAgICAgICAgIG1lc3NhZ2U6IHRoaXMucHJvcHMudHJhbnNsYXRlKCdyZWFjdC5zdG9ja01vdmVtZW50LmNvbmZpcm1DaGFuZ2UubWVzc2FnZScsICdEbyB5b3Ugd2FudCB0byBjaGFuZ2Ugc3RvY2sgbW92ZW1lbnQgZGF0YT8gQ2hhbmdpbmcgb3JpZ2luLCBkZXN0aW5hdGlvbiBvciBzdG9jayBsaXN0IGNhbiBjYXVzZSBsb3NzIG9mIHlvdXIgY3VycmVudCB3b3JrJyksCiAgICAgICAgICBidXR0b25zOiBbewogICAgICAgICAgICBsYWJlbDogdGhpcy5wcm9wcy50cmFuc2xhdGUoJ3JlYWN0LmRlZmF1bHQubm8ubGFiZWwnLCAnTm8nKSwKICAgICAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXM1LnJlc2V0VG9Jbml0aWFsVmFsdWVzKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIHsKICAgICAgICAgICAgbGFiZWw6IHRoaXMucHJvcHMudHJhbnNsYXRlKCdyZWFjdC5kZWZhdWx0Lnllcy5sYWJlbCcsICdZZXMnKSwKICAgICAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXM1LnNhdmVTdG9ja01vdmVtZW50KHZhbHVlcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH1dCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChGb3JtLCB7CiAgICAgICAgb25TdWJtaXQ6IGZ1bmN0aW9uIG9uU3VibWl0KHZhbHVlcykgewogICAgICAgICAgcmV0dXJuIF90aGlzNi5uZXh0UGFnZSh2YWx1ZXMpOwogICAgICAgIH0sCiAgICAgICAgdmFsaWRhdGU6IHZhbGlkYXRlLAogICAgICAgIGluaXRpYWxWYWx1ZXM6IHRoaXMuc3RhdGUudmFsdWVzLAogICAgICAgIG11dGF0b3JzOiB7CiAgICAgICAgICBjbGVhclN0b2NrbGlzdDogZnVuY3Rpb24gY2xlYXJTdG9ja2xpc3QoYXJncywgc3RhdGUsIHV0aWxzKSB7CiAgICAgICAgICAgIHV0aWxzLmNoYW5nZVZhbHVlKHN0YXRlLCAnc3RvY2tsaXN0JywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKF9yZWYyKSB7CiAgICAgICAgICB2YXIgbXV0YXRvcnMgPSBfcmVmMi5mb3JtLm11dGF0b3JzLAogICAgICAgICAgICBoYW5kbGVTdWJtaXQgPSBfcmVmMi5oYW5kbGVTdWJtaXQsCiAgICAgICAgICAgIHZhbHVlcyA9IF9yZWYyLnZhbHVlczsKICAgICAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZm9ybSIsIHsKICAgICAgICAgICAgb25TdWJtaXQ6IGhhbmRsZVN1Ym1pdAogICAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICAgICAgY2xhc3NOYW1lOiAiY2xhc3NpYy1mb3JtIHdpdGgtZGVzY3JpcHRpb24iCiAgICAgICAgICB9LCBfLm1hcChGSUVMRFMsIGZ1bmN0aW9uIChmaWVsZENvbmZpZywgZmllbGROYW1lKSB7CiAgICAgICAgICAgIHJldHVybiByZW5kZXJGb3JtRmllbGQoZmllbGRDb25maWcsIGZpZWxkTmFtZSwgewogICAgICAgICAgICAgIHN0b2NrbGlzdHM6IF90aGlzNi5zdGF0ZS5zdG9ja2xpc3RzLAogICAgICAgICAgICAgIGZldGNoU3RvY2tMaXN0czogZnVuY3Rpb24gZmV0Y2hTdG9ja0xpc3RzKG9yaWdpbiwgZGVzdGluYXRpb24pIHsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczYuZmV0Y2hTdG9ja0xpc3RzKG9yaWdpbiwgZGVzdGluYXRpb24sIG11dGF0b3JzLmNsZWFyU3RvY2tsaXN0KTsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIG9yaWdpbjogdmFsdWVzLm9yaWdpbiwKICAgICAgICAgICAgICBkZXN0aW5hdGlvbjogdmFsdWVzLmRlc3RpbmF0aW9uLAogICAgICAgICAgICAgIGlzU3VwZXJ1c2VyOiBfdGhpczYucHJvcHMuaXNTdXBlcnVzZXIsCiAgICAgICAgICAgICAgZGVib3VuY2VkUGVvcGxlRmV0Y2g6IF90aGlzNi5kZWJvdW5jZWRQZW9wbGVGZXRjaCwKICAgICAgICAgICAgICBkZWJvdW5jZWRMb2NhdGlvbnNGZXRjaDogX3RoaXM2LmRlYm91bmNlZExvY2F0aW9uc0ZldGNoCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSkpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgICBjbGFzc05hbWU6ICJzdWJtaXQtYnV0dG9ucyIKICAgICAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJidXR0b24iLCB7CiAgICAgICAgICAgIHR5cGU6ICJzdWJtaXQiLAogICAgICAgICAgICBjbGFzc05hbWU6ICJidG4gYnRuLW91dGxpbmUtcHJpbWFyeSBmbG9hdC1yaWdodCBidG4teHMiCiAgICAgICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUcmFuc2xhdGUsIHsKICAgICAgICAgICAgaWQ6ICJyZWFjdC5kZWZhdWx0LmJ1dHRvbi5uZXh0LmxhYmVsIiwKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJOZXh0IgogICAgICAgICAgfSkpKSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIENyZWF0ZVN0b2NrTW92ZW1lbnQ7Cn0oQ29tcG9uZW50KTsKdmFyIG1hcFN0YXRlVG9Qcm9wcyA9IGZ1bmN0aW9uIG1hcFN0YXRlVG9Qcm9wcyhzdGF0ZSkgewogIHJldHVybiB7CiAgICBsb2NhdGlvbjogc3RhdGUuc2Vzc2lvbi5jdXJyZW50TG9jYXRpb24sCiAgICBpc1N1cGVydXNlcjogc3RhdGUuc2Vzc2lvbi5pc1N1cGVydXNlciwKICAgIHRyYW5zbGF0ZTogdHJhbnNsYXRlV2l0aERlZmF1bHRNZXNzYWdlKGdldFRyYW5zbGF0ZShzdGF0ZS5sb2NhbGl6ZSkpLAogICAgZGVib3VuY2VUaW1lOiBzdGF0ZS5zZXNzaW9uLnNlYXJjaENvbmZpZy5kZWJvdW5jZVRpbWUsCiAgICBtaW5TZWFyY2hMZW5ndGg6IHN0YXRlLnNlc3Npb24uc2VhcmNoQ29uZmlnLm1pblNlYXJjaExlbmd0aCwKICAgIHVzZXI6IHN0YXRlLnNlc3Npb24udXNlcgogIH07Cn07CmV4cG9ydCBkZWZhdWx0IHdpdGhSb3V0ZXIoY29ubmVjdChtYXBTdGF0ZVRvUHJvcHMsIHsKICBzaG93U3Bpbm5lcjogc2hvd1NwaW5uZXIsCiAgaGlkZVNwaW5uZXI6IGhpZGVTcGlubmVyCn0pKENyZWF0ZVN0b2NrTW92ZW1lbnQpKTsKQ3JlYXRlU3RvY2tNb3ZlbWVudC5wcm9wVHlwZXMgPSB7CiAgLyoqIFJlYWN0IHJvdXRlcidzIG9iamVjdCB3aGljaCBjb250YWlucyBpbmZvcm1hdGlvbiBhYm91dCB1cmwgdmFyYWlhYmxlcyBhbmQgcGFyYW1zICovCiAgbWF0Y2g6IFByb3BUeXBlcy5zaGFwZSh7CiAgICBwYXJhbXM6IFByb3BUeXBlcy5zaGFwZSh7CiAgICAgIHN0b2NrTW92ZW1lbnRJZDogUHJvcFR5cGVzLnN0cmluZwogICAgfSkKICB9KS5pc1JlcXVpcmVkLAogIC8qKiBJbml0aWFsIGNvbXBvbmVudCdzIGRhdGEgKi8KICBpbml0aWFsVmFsdWVzOiBQcm9wVHlwZXMuc2hhcGUoewogICAgb3JpZ2luOiBQcm9wVHlwZXMuc2hhcGUoewogICAgICBpZDogUHJvcFR5cGVzLnN0cmluZwogICAgfSksCiAgICBkZXN0aW5hdGlvbjogUHJvcFR5cGVzLnNoYXBlKHsKICAgICAgaWQ6IFByb3BUeXBlcy5zdHJpbmcKICAgIH0pLAogICAgc3RvY2tsaXN0OiBQcm9wVHlwZXMuc2hhcGUoe30pCiAgfSkuaXNSZXF1aXJlZCwKICAvKiogRnVuY3Rpb24gY2FsbGVkIHdoZW4gZGF0YSBpcyBsb2FkaW5nICovCiAgc2hvd1NwaW5uZXI6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsCiAgLyoqIEZ1bmN0aW9uIGNhbGxlZCB3aGVuIGRhdGEgaGFzIGxvYWRlZCAqLwogIGhpZGVTcGlubmVyOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLAogIC8qKgogICAqIEZ1bmN0aW9uIGNhbGxlZCB3aXRoIHRoZSBmb3JtIGRhdGEgd2hlbiB0aGUgaGFuZGxlU3VibWl0KCkKICAgKiBpcyBmaXJlZCBmcm9tIHdpdGhpbiB0aGUgZm9ybSBjb21wb25lbnQuCiAgICovCiAgbmV4dFBhZ2U6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsCiAgLyoqIFJlYWN0IHJvdXRlcidzIG9iamVjdCB1c2VkIHRvIG1hbmFnZSBzZXNzaW9uIGhpc3RvcnkgKi8KICBoaXN0b3J5OiBQcm9wVHlwZXMuc2hhcGUoewogICAgcHVzaDogUHJvcFR5cGVzLmZ1bmMKICB9KS5pc1JlcXVpcmVkLAogIC8qKiBDdXJyZW50IGxvY2F0aW9uICovCiAgbG9jYXRpb246IFByb3BUeXBlcy5zaGFwZSh7CiAgICBuYW1lOiBQcm9wVHlwZXMuc3RyaW5nLAogICAgaWQ6IFByb3BUeXBlcy5zdHJpbmcsCiAgICBsb2NhdGlvblR5cGU6IFByb3BUeXBlcy5zaGFwZSh7CiAgICAgIGRlc2NyaXB0aW9uOiBQcm9wVHlwZXMuc3RyaW5nLAogICAgICBsb2NhdGlvblR5cGVDb2RlOiBQcm9wVHlwZXMuc3RyaW5nCiAgICB9KQogIH0pLmlzUmVxdWlyZWQsCiAgLyoqIFJldHVybiB0cnVlIGlmIGN1cnJlbnQgdXNlciBpcyBzdXBlcnVzZXIgKi8KICBpc1N1cGVydXNlcjogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZCwKICB0cmFuc2xhdGU6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsCiAgZGVib3VuY2VUaW1lOiBQcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWQsCiAgbWluU2VhcmNoTGVuZ3RoOiBQcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWQKfTs="},null]}