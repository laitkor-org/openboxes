{"remainingRequest":"/opt/MTOBS-BIKASH/node_modules/babel-loader/lib/index.js?presets[]=@babel/react&presets[]=@babel/env!/opt/MTOBS-BIKASH/node_modules/eslint-loader/dist/cjs.js!/opt/MTOBS-BIKASH/src/js/components/invoice/ConfirmInvoicePage.jsx","dependencies":[{"path":"/opt/MTOBS-BIKASH/src/js/components/invoice/ConfirmInvoicePage.jsx","mtime":1698037748000},{"path":"/opt/MTOBS-BIKASH/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/opt/MTOBS-BIKASH/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/opt/MTOBS-BIKASH/node_modules/eslint-loader/dist/cjs.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsgcmV0dXJuIF90eXBlb2YgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgInN5bWJvbCIgPT0gdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfSwgX3R5cGVvZihvYmopOyB9CmZ1bmN0aW9uIF9leHRlbmRzKCkgeyBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gPyBPYmplY3QuYXNzaWduLmJpbmQoKSA6IGZ1bmN0aW9uICh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXTsgZm9yICh2YXIga2V5IGluIHNvdXJjZSkgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkgeyB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOyB9IH0gfSByZXR1cm4gdGFyZ2V0OyB9OyByZXR1cm4gX2V4dGVuZHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfQpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsgZW51bWVyYWJsZU9ubHkgJiYgKHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KSksIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsgfSByZXR1cm4ga2V5czsgfQpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gbnVsbCAhPSBhcmd1bWVudHNbaV0gPyBhcmd1bWVudHNbaV0gOiB7fTsgaSAlIDIgPyBvd25LZXlzKE9iamVjdChzb3VyY2UpLCAhMCkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KSA6IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKSA6IG93bktleXMoT2JqZWN0KHNvdXJjZSkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsgfSk7IH0gcmV0dXJuIHRhcmdldDsgfQpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7IGtleSA9IF90b1Byb3BlcnR5S2V5KGtleSk7IGlmIChrZXkgaW4gb2JqKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgeyB2YWx1ZTogdmFsdWUsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7IH0gZWxzZSB7IG9ialtrZXldID0gdmFsdWU7IH0gcmV0dXJuIG9iajsgfQpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgX3RvUHJvcGVydHlLZXkoZGVzY3JpcHRvci5rZXkpLCBkZXNjcmlwdG9yKTsgfSB9CmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbnN0cnVjdG9yLCAicHJvdG90eXBlIiwgeyB3cml0YWJsZTogZmFsc2UgfSk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQpmdW5jdGlvbiBfdG9Qcm9wZXJ0eUtleShhcmcpIHsgdmFyIGtleSA9IF90b1ByaW1pdGl2ZShhcmcsICJzdHJpbmciKTsgcmV0dXJuIF90eXBlb2Yoa2V5KSA9PT0gInN5bWJvbCIgPyBrZXkgOiBTdHJpbmcoa2V5KTsgfQpmdW5jdGlvbiBfdG9QcmltaXRpdmUoaW5wdXQsIGhpbnQpIHsgaWYgKF90eXBlb2YoaW5wdXQpICE9PSAib2JqZWN0IiB8fCBpbnB1dCA9PT0gbnVsbCkgcmV0dXJuIGlucHV0OyB2YXIgcHJpbSA9IGlucHV0W1N5bWJvbC50b1ByaW1pdGl2ZV07IGlmIChwcmltICE9PSB1bmRlZmluZWQpIHsgdmFyIHJlcyA9IHByaW0uY2FsbChpbnB1dCwgaGludCB8fCAiZGVmYXVsdCIpOyBpZiAoX3R5cGVvZihyZXMpICE9PSAib2JqZWN0IikgcmV0dXJuIHJlczsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQEB0b1ByaW1pdGl2ZSBtdXN0IHJldHVybiBhIHByaW1pdGl2ZSB2YWx1ZS4iKTsgfSByZXR1cm4gKGhpbnQgPT09ICJzdHJpbmciID8gU3RyaW5nIDogTnVtYmVyKShpbnB1dCk7IH0KZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBPYmplY3QuZGVmaW5lUHJvcGVydHkoc3ViQ2xhc3MsICJwcm90b3R5cGUiLCB7IHdyaXRhYmxlOiBmYWxzZSB9KTsgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7IH0KZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mLmJpbmQoKSA6IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IG8uX19wcm90b19fID0gcDsgcmV0dXJuIG87IH07IHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7IH0KZnVuY3Rpb24gX2NyZWF0ZVN1cGVyKERlcml2ZWQpIHsgdmFyIGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QgPSBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCk7IHJldHVybiBmdW5jdGlvbiBfY3JlYXRlU3VwZXJJbnRlcm5hbCgpIHsgdmFyIFN1cGVyID0gX2dldFByb3RvdHlwZU9mKERlcml2ZWQpLCByZXN1bHQ7IGlmIChoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KSB7IHZhciBOZXdUYXJnZXQgPSBfZ2V0UHJvdG90eXBlT2YodGhpcykuY29uc3RydWN0b3I7IHJlc3VsdCA9IFJlZmxlY3QuY29uc3RydWN0KFN1cGVyLCBhcmd1bWVudHMsIE5ld1RhcmdldCk7IH0gZWxzZSB7IHJlc3VsdCA9IFN1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7IH0gcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIHJlc3VsdCk7IH07IH0KZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7IHJldHVybiBjYWxsOyB9IGVsc2UgaWYgKGNhbGwgIT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJEZXJpdmVkIGNvbnN0cnVjdG9ycyBtYXkgb25seSByZXR1cm4gb2JqZWN0IG9yIHVuZGVmaW5lZCIpOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9CmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7IH0gcmV0dXJuIHNlbGY7IH0KZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHsgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSAidW5kZWZpbmVkIiB8fCAhUmVmbGVjdC5jb25zdHJ1Y3QpIHJldHVybiBmYWxzZTsgaWYgKFJlZmxlY3QuY29uc3RydWN0LnNoYW0pIHJldHVybiBmYWxzZTsgaWYgKHR5cGVvZiBQcm94eSA9PT0gImZ1bmN0aW9uIikgcmV0dXJuIHRydWU7IHRyeSB7IEJvb2xlYW4ucHJvdG90eXBlLnZhbHVlT2YuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChCb29sZWFuLCBbXSwgZnVuY3Rpb24gKCkge30pKTsgcmV0dXJuIHRydWU7IH0gY2F0Y2ggKGUpIHsgcmV0dXJuIGZhbHNlOyB9IH0KZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mLmJpbmQoKSA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7IH07IHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7IH0KaW1wb3J0IFJlYWN0LCB7IENvbXBvbmVudCB9IGZyb20gJ3JlYWN0JzsKaW1wb3J0IGFycmF5TXV0YXRvcnMgZnJvbSAnZmluYWwtZm9ybS1hcnJheXMnOwppbXBvcnQgXyBmcm9tICdsb2Rhc2gnOwppbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnOwppbXBvcnQgeyBGb3JtIH0gZnJvbSAncmVhY3QtZmluYWwtZm9ybSc7CmltcG9ydCB7IGNvbm5lY3QgfSBmcm9tICdyZWFjdC1yZWR1eCc7CmltcG9ydCB7IFRvb2x0aXAgfSBmcm9tICdyZWFjdC10aXBweSc7CmltcG9ydCB7IGhpZGVTcGlubmVyLCBzaG93U3Bpbm5lciB9IGZyb20gJ2FjdGlvbnMnOwppbXBvcnQgRG9jdW1lbnRCdXR0b24gZnJvbSAnY29tcG9uZW50cy9Eb2N1bWVudEJ1dHRvbic7CmltcG9ydCBBcnJheUZpZWxkIGZyb20gJ2NvbXBvbmVudHMvZm9ybS1lbGVtZW50cy9BcnJheUZpZWxkJzsKaW1wb3J0IERhdGVGaWVsZCBmcm9tICdjb21wb25lbnRzL2Zvcm0tZWxlbWVudHMvRGF0ZUZpZWxkJzsKaW1wb3J0IExhYmVsRmllbGQgZnJvbSAnY29tcG9uZW50cy9mb3JtLWVsZW1lbnRzL0xhYmVsRmllbGQnOwppbXBvcnQgVGV4dEZpZWxkIGZyb20gJ2NvbXBvbmVudHMvZm9ybS1lbGVtZW50cy9UZXh0RmllbGQnOwppbXBvcnQgYXBpQ2xpZW50IGZyb20gJ3V0aWxzL2FwaUNsaWVudCc7CmltcG9ydCB7IHJlbmRlckZvcm1GaWVsZCB9IGZyb20gJ3V0aWxzL2Zvcm0tdXRpbHMnOwppbXBvcnQgeyBnZXRJbnZvaWNlRGVzY3JpcHRpb24gfSBmcm9tICd1dGlscy9mb3JtLXZhbHVlcy11dGlscyc7CmltcG9ydCBhY2NvdW50aW5nRm9ybWF0IGZyb20gJ3V0aWxzL251bWJlci11dGlscyc7CmltcG9ydCBUcmFuc2xhdGUgZnJvbSAndXRpbHMvVHJhbnNsYXRlJzsKdmFyIElOVk9JQ0VfSEVBREVSX0ZJRUxEUyA9IHsKICBpbnZvaWNlTnVtYmVyOiB7CiAgICB0eXBlOiBUZXh0RmllbGQsCiAgICBsYWJlbDogJ3JlYWN0Lmludm9pY2UuaW52b2ljZU51bWJlci5sYWJlbCcsCiAgICBkZWZhdWx0TWVzc2FnZTogJ0ludm9pY2UgbnVtYmVyJywKICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgZGlzYWJsZWQ6IHRydWUKICAgIH0KICB9LAogIHZlbmRvck5hbWU6IHsKICAgIHR5cGU6IFRleHRGaWVsZCwKICAgIGxhYmVsOiAncmVhY3QuSW52b2ljZS52ZW5kb3IubGFiZWwnLAogICAgZGVmYXVsdE1lc3NhZ2U6ICdWZW5kb3InLAogICAgYXR0cmlidXRlczogewogICAgICBkaXNhYmxlZDogdHJ1ZQogICAgfQogIH0sCiAgdmVuZG9ySW52b2ljZU51bWJlcjogewogICAgdHlwZTogVGV4dEZpZWxkLAogICAgbGFiZWw6ICdyZWFjdC5pbnZvaWNlLnZlbmRvckludm9pY2VOdW1iZXIubGFiZWwnLAogICAgZGVmYXVsdE1lc3NhZ2U6ICdWZW5kb3IgSW52b2ljZSBOdW1iZXInLAogICAgYXR0cmlidXRlczogewogICAgICBkaXNhYmxlZDogdHJ1ZQogICAgfQogIH0sCiAgZGF0ZUludm9pY2VkOiB7CiAgICB0eXBlOiBEYXRlRmllbGQsCiAgICBsYWJlbDogJ3JlYWN0Lmludm9pY2UuaW52b2ljZURhdGUubGFiZWwnLAogICAgZGVmYXVsdE1lc3NhZ2U6ICdJbnZvaWNlIERhdGUnLAogICAgYXR0cmlidXRlczogewogICAgICBkaXNhYmxlZDogdHJ1ZSwKICAgICAgZGF0ZUZvcm1hdDogJ01NL0REL1lZWVknCiAgICB9CiAgfSwKICAnY3VycmVuY3lVb20uY29kZSc6IHsKICAgIHR5cGU6IFRleHRGaWVsZCwKICAgIGxhYmVsOiAncmVhY3QuaW52b2ljZS5jdXJyZW5jeS5sYWJlbCcsCiAgICBkZWZhdWx0TWVzc2FnZTogJ0N1cnJlbmN5JywKICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgZGlzYWJsZWQ6IHRydWUKICAgIH0KICB9LAogIHRvdGFsVmFsdWU6IHsKICAgIHR5cGU6IFRleHRGaWVsZCwKICAgIGxhYmVsOiAncmVhY3QuaW52b2ljZS50b3RhbC5sYWJlbCcsCiAgICBkZWZhdWx0TWVzc2FnZTogJ1RvdGFsJywKICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgZGlzYWJsZWQ6IHRydWUKICAgIH0sCiAgICBnZXREeW5hbWljQXR0cjogZnVuY3Rpb24gZ2V0RHluYW1pY0F0dHIoX3JlZikgewogICAgICB2YXIgdmFsdWVzID0gX3JlZi52YWx1ZXM7CiAgICAgIHJldHVybiB7CiAgICAgICAgY2xhc3NOYW1lOiB2YWx1ZXMgJiYgdmFsdWVzLnRvdGFsVmFsdWUgJiYgKHZhbHVlcy50b3RhbFZhbHVlIDwgMCB8fCB2YWx1ZXMudG90YWxWYWx1ZS5zdGFydHNXaXRoKCcoJykpID8gJ25lZ2F0aXZlLXZhbHVlJyA6ICcnCiAgICAgIH07CiAgICB9CiAgfQp9Owp2YXIgSU5WT0lDRV9JVEVNUyA9IHsKICBpbnZvaWNlSXRlbXM6IHsKICAgIHR5cGU6IEFycmF5RmllbGQsCiAgICB2aXJ0dWFsaXplZDogdHJ1ZSwKICAgIHRvdGFsQ291bnQ6IGZ1bmN0aW9uIHRvdGFsQ291bnQoX3JlZjIpIHsKICAgICAgdmFyIF90b3RhbENvdW50ID0gX3JlZjIudG90YWxDb3VudDsKICAgICAgcmV0dXJuIF90b3RhbENvdW50OwogICAgfSwKICAgIGlzUm93TG9hZGVkOiBmdW5jdGlvbiBpc1Jvd0xvYWRlZChfcmVmMykgewogICAgICB2YXIgX2lzUm93TG9hZGVkID0gX3JlZjMuaXNSb3dMb2FkZWQ7CiAgICAgIHJldHVybiBfaXNSb3dMb2FkZWQ7CiAgICB9LAogICAgbG9hZE1vcmVSb3dzOiBmdW5jdGlvbiBsb2FkTW9yZVJvd3MoX3JlZjQpIHsKICAgICAgdmFyIF9sb2FkTW9yZVJvd3MgPSBfcmVmNC5sb2FkTW9yZVJvd3M7CiAgICAgIHJldHVybiBfbG9hZE1vcmVSb3dzKCk7CiAgICB9LAogICAgaXNGaXJzdFBhZ2VMb2FkZWQ6IGZ1bmN0aW9uIGlzRmlyc3RQYWdlTG9hZGVkKF9yZWY1KSB7CiAgICAgIHZhciBfaXNGaXJzdFBhZ2VMb2FkZWQgPSBfcmVmNS5pc0ZpcnN0UGFnZUxvYWRlZDsKICAgICAgcmV0dXJuIF9pc0ZpcnN0UGFnZUxvYWRlZDsKICAgIH0sCiAgICBnZXREeW5hbWljUm93QXR0cjogZnVuY3Rpb24gZ2V0RHluYW1pY1Jvd0F0dHIoX3JlZjYpIHsKICAgICAgdmFyIHJvd1ZhbHVlcyA9IF9yZWY2LnJvd1ZhbHVlczsKICAgICAgcmV0dXJuIHsKICAgICAgICBjbGFzc05hbWU6IHJvd1ZhbHVlcyAmJiByb3dWYWx1ZXMudG90YWxBbW91bnQgJiYgcm93VmFsdWVzLnRvdGFsQW1vdW50IDwgMCA/ICduZWdhdGl2ZS1yb3ctdmFsdWUnIDogJycKICAgICAgfTsKICAgIH0sCiAgICBmaWVsZHM6IHsKICAgICAgcHJlcGF5bWVudEljb246IHsKICAgICAgICB0eXBlOiBmdW5jdGlvbiB0eXBlKHBhcmFtcykgewogICAgICAgICAgdmFyIHZhbHVlcyA9IHBhcmFtcy52YWx1ZXM7CiAgICAgICAgICB2YXIgaGFzSXRlbXMgPSB2YWx1ZXMgJiYgdmFsdWVzLmludm9pY2VJdGVtczsKICAgICAgICAgIHZhciBpc1ByZXBMaW5lID0gaGFzSXRlbXMgJiYgKHZhbHVlcy5pc1ByZXBheW1lbnRJbnZvaWNlIHx8IHZhbHVlcy5pbnZvaWNlSXRlbXNbcGFyYW1zLnJvd0luZGV4XS5pc1ByZXBheW1lbnRJdGVtKTsKICAgICAgICAgIGlmIChpc1ByZXBMaW5lKSB7CiAgICAgICAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgICAgIGNsYXNzTmFtZTogImQtZmxleCBhbGlnbi1pdGVtcy1jZW50ZXIganVzdGlmeS1jb250ZW50LWNlbnRlciIKICAgICAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoVG9vbHRpcCwgewogICAgICAgICAgICAgIGh0bWw6ICJQcmVwYXltZW50IiwKICAgICAgICAgICAgICB0aGVtZTogInRyYW5zcGFyZW50IiwKICAgICAgICAgICAgICBkZWxheTogIjE1MCIsCiAgICAgICAgICAgICAgZHVyYXRpb246ICIyNTAiLAogICAgICAgICAgICAgIGhpZGVEZWxheTogIjUwIgogICAgICAgICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiYiIsIG51bGwsICJcdTI0QzUiKSkpOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfSwKICAgICAgICBsYWJlbDogJycsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICcnLAogICAgICAgIGZsZXhXaWR0aDogJzAuMjUnCiAgICAgIH0sCiAgICAgIG9yZGVyTnVtYmVyOiB7CiAgICAgICAgdHlwZTogTGFiZWxGaWVsZCwKICAgICAgICBsYWJlbDogJ3JlYWN0Lmludm9pY2Uub3JkZXJOdW1iZXIubGFiZWwnLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnUE8gTnVtYmVyJywKICAgICAgICBmbGV4V2lkdGg6ICcxJywKICAgICAgICBnZXREeW5hbWljQXR0cjogZnVuY3Rpb24gZ2V0RHluYW1pY0F0dHIoX3JlZjcpIHsKICAgICAgICAgIHZhciB2YWx1ZXMgPSBfcmVmNy52YWx1ZXMsCiAgICAgICAgICAgIHJvd0luZGV4ID0gX3JlZjcucm93SW5kZXg7CiAgICAgICAgICB2YXIgb3JkZXJJZCA9IHZhbHVlcyAmJiB2YWx1ZXMuaW52b2ljZUl0ZW1zICYmIHZhbHVlcy5pbnZvaWNlSXRlbXNbcm93SW5kZXhdICYmIHZhbHVlcy5pbnZvaWNlSXRlbXNbcm93SW5kZXhdLm9yZGVySWQ7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICB1cmw6IG9yZGVySWQgPyAiL29wZW5ib3hlcy9vcmRlci9zaG93LyIuY29uY2F0KG9yZGVySWQpIDogJycKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9LAogICAgICBzaGlwbWVudE51bWJlcjogewogICAgICAgIHR5cGU6IExhYmVsRmllbGQsCiAgICAgICAgbGFiZWw6ICdyZWFjdC5pbnZvaWNlLnNoaXBtZW50TnVtYmVyLmxhYmVsJywKICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1NoaXBtZW50IE51bWJlcicsCiAgICAgICAgZmxleFdpZHRoOiAnMScsCiAgICAgICAgZ2V0RHluYW1pY0F0dHI6IGZ1bmN0aW9uIGdldER5bmFtaWNBdHRyKF9yZWY4KSB7CiAgICAgICAgICB2YXIgdmFsdWVzID0gX3JlZjgudmFsdWVzLAogICAgICAgICAgICByb3dJbmRleCA9IF9yZWY4LnJvd0luZGV4OwogICAgICAgICAgdmFyIHNoaXBtZW50SWQgPSB2YWx1ZXMgJiYgdmFsdWVzLmludm9pY2VJdGVtcyAmJiB2YWx1ZXMuaW52b2ljZUl0ZW1zW3Jvd0luZGV4XSAmJiB2YWx1ZXMuaW52b2ljZUl0ZW1zW3Jvd0luZGV4XS5zaGlwbWVudElkOwogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgdXJsOiBzaGlwbWVudElkID8gIi9vcGVuYm94ZXMvc3RvY2tNb3ZlbWVudC9zaG93LyIuY29uY2F0KHNoaXBtZW50SWQpIDogJycKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9LAogICAgICBidWRnZXRDb2RlOiB7CiAgICAgICAgdHlwZTogTGFiZWxGaWVsZCwKICAgICAgICBsYWJlbDogJ3JlYWN0Lmludm9pY2UuYnVkZ2V0Q29kZS5sYWJlbCcsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdCdWRnZXQgQ29kZScsCiAgICAgICAgZmxleFdpZHRoOiAnMScKICAgICAgfSwKICAgICAgZ2xDb2RlOiB7CiAgICAgICAgdHlwZTogTGFiZWxGaWVsZCwKICAgICAgICBsYWJlbDogJ3JlYWN0Lmludm9pY2UuZ2xDb2RlLmxhYmVsJywKICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0dMIENvZGUnLAogICAgICAgIGZsZXhXaWR0aDogJzEnCiAgICAgIH0sCiAgICAgIHByb2R1Y3RDb2RlOiB7CiAgICAgICAgdHlwZTogTGFiZWxGaWVsZCwKICAgICAgICBsYWJlbDogJ3JlYWN0Lmludm9pY2UuaXRlbU5vLmxhYmVsJywKICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0l0ZW0gTm8nLAogICAgICAgIGZsZXhXaWR0aDogJzEnCiAgICAgIH0sCiAgICAgIGRlc2NyaXB0aW9uOiB7CiAgICAgICAgdHlwZTogTGFiZWxGaWVsZCwKICAgICAgICBsYWJlbDogJ3JlYWN0Lmludm9pY2UuZGVzY3JpcHRpb24ubGFiZWwnLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnRGVzY3JpcHRpb24nLAogICAgICAgIGZsZXhXaWR0aDogJzUnLAogICAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICAgIGNsYXNzTmFtZTogJ3RleHQtbGVmdCcKICAgICAgICB9LAogICAgICAgIGdldER5bmFtaWNBdHRyOiBmdW5jdGlvbiBnZXREeW5hbWljQXR0cihwYXJhbXMpIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGZvcm1hdFZhbHVlOiBmdW5jdGlvbiBmb3JtYXRWYWx1ZSgpIHsKICAgICAgICAgICAgICB2YXIgX3ZhbHVlcyRpbnZvaWNlSXRlbXM7CiAgICAgICAgICAgICAgdmFyIHZhbHVlcyA9IHBhcmFtcy52YWx1ZXMsCiAgICAgICAgICAgICAgICByb3dJbmRleCA9IHBhcmFtcy5yb3dJbmRleDsKICAgICAgICAgICAgICB2YXIgcm93VmFsdWUgPSB2YWx1ZXMgPT09IG51bGwgfHwgdmFsdWVzID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX3ZhbHVlcyRpbnZvaWNlSXRlbXMgPSB2YWx1ZXMuaW52b2ljZUl0ZW1zKSA9PT0gbnVsbCB8fCBfdmFsdWVzJGludm9pY2VJdGVtcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3ZhbHVlcyRpbnZvaWNlSXRlbXNbcm93SW5kZXhdOwogICAgICAgICAgICAgIC8vIElmIGl0J3Mgbm90IGFuIGFkanVzdG1lbnQsIGJ1dCBwcm9kdWN0LCBhbmQgaXQgaGFzIGEgc3lub255bSwgZGlzcGxheSBpdAogICAgICAgICAgICAgIC8vIHdpdGggYSB0b29sdGlwIHdpdGggdGhlIG9yaWdpbmFsIG5hbWUgb2YgdGhlIHByb2R1Y3QKICAgICAgICAgICAgICByZXR1cm4gZ2V0SW52b2ljZURlc2NyaXB0aW9uKHJvd1ZhbHVlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHF1YW50aXR5OiB7CiAgICAgICAgdHlwZTogTGFiZWxGaWVsZCwKICAgICAgICBsYWJlbDogJ3JlYWN0Lmludm9pY2UucXR5LmxhYmVsJywKICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1F0eScsCiAgICAgICAgZmxleFdpZHRoOiAnMScsCiAgICAgICAgZ2V0RHluYW1pY0F0dHI6IGZ1bmN0aW9uIGdldER5bmFtaWNBdHRyKHBhcmFtcykgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgZm9ybWF0VmFsdWU6IGZ1bmN0aW9uIGZvcm1hdFZhbHVlKCkgewogICAgICAgICAgICAgIHZhciB2YWx1ZXMgPSBwYXJhbXMudmFsdWVzOwogICAgICAgICAgICAgIHZhciBoYXNJdGVtcyA9IHZhbHVlcyAmJiB2YWx1ZXMuaW52b2ljZUl0ZW1zOwogICAgICAgICAgICAgIHZhciBpc1ByZXBMaW5lID0gaGFzSXRlbXMgJiYgdmFsdWVzLmludm9pY2VJdGVtc1twYXJhbXMucm93SW5kZXhdLmlzUHJlcGF5bWVudEl0ZW07CiAgICAgICAgICAgICAgaWYgKGlzUHJlcExpbmUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBwYXJhbXMuZmllbGRWYWx1ZSAqIC0xOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICByZXR1cm4gcGFyYW1zLmZpZWxkVmFsdWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9LAogICAgICB1b206IHsKICAgICAgICB0eXBlOiBMYWJlbEZpZWxkLAogICAgICAgIGxhYmVsOiAncmVhY3QuaW52b2ljZS51b20ubGFiZWwnLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVU9NJywKICAgICAgICBmbGV4V2lkdGg6ICcxJwogICAgICB9LAogICAgICB1bml0UHJpY2U6IHsKICAgICAgICB0eXBlOiBMYWJlbEZpZWxkLAogICAgICAgIGxhYmVsOiAncmVhY3QuaW52b2ljZS51bml0UHJpY2UubGFiZWwnLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVW5pdCBQcmljZScsCiAgICAgICAgZmxleFdpZHRoOiAnMScsCiAgICAgICAgYXR0cmlidXRlczogewogICAgICAgICAgZm9ybWF0VmFsdWU6IGZ1bmN0aW9uIGZvcm1hdFZhbHVlKHZhbHVlKSB7CiAgICAgICAgICAgIHJldHVybiB2YWx1ZSA/IGFjY291bnRpbmdGb3JtYXQodmFsdWUpIDogdmFsdWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICB0b3RhbEFtb3VudDogewogICAgICAgIHR5cGU6IExhYmVsRmllbGQsCiAgICAgICAgbGFiZWw6ICdyZWFjdC5pbnZvaWNlLnRvdGFsUHJpY2UubGFiZWwnLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVG90YWwgUHJpY2UnLAogICAgICAgIGZsZXhXaWR0aDogJzEnLAogICAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICAgIGZvcm1hdFZhbHVlOiBmdW5jdGlvbiBmb3JtYXRWYWx1ZSh2YWx1ZSkgewogICAgICAgICAgICByZXR1cm4gdmFsdWUgPyBhY2NvdW50aW5nRm9ybWF0KHZhbHVlKSA6IHZhbHVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KfTsKdmFyIFBSRVBBWU1FTlRfSU5WT0lDRSA9ICdQUkVQQVlNRU5UX0lOVk9JQ0UnOwp2YXIgQ29uZmlybUludm9pY2VQYWdlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29tcG9uZW50KSB7CiAgX2luaGVyaXRzKENvbmZpcm1JbnZvaWNlUGFnZSwgX0NvbXBvbmVudCk7CiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihDb25maXJtSW52b2ljZVBhZ2UpOwogIGZ1bmN0aW9uIENvbmZpcm1JbnZvaWNlUGFnZShwcm9wcykgewogICAgdmFyIF90aGlzOwogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENvbmZpcm1JbnZvaWNlUGFnZSk7CiAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKTsKICAgIF90aGlzLnN0YXRlID0gewogICAgICB2YWx1ZXM6IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgX3RoaXMucHJvcHMuaW5pdGlhbFZhbHVlcyksIHt9LCB7CiAgICAgICAgaW52b2ljZUl0ZW1zOiBbXSwKICAgICAgICB0b3RhbFZhbHVlOiAwCiAgICAgIH0pLAogICAgICBpc0ZpcnN0UGFnZUxvYWRlZDogZmFsc2UKICAgIH07CiAgICBfdGhpcy5pc1Jvd0xvYWRlZCA9IF90aGlzLmlzUm93TG9hZGVkLmJpbmQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcykpOwogICAgX3RoaXMubG9hZE1vcmVSb3dzID0gX3RoaXMubG9hZE1vcmVSb3dzLmJpbmQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcykpOwogICAgX3RoaXMudG9nZ2xlRHJvcGRvd24gPSBfdGhpcy50b2dnbGVEcm9wZG93bi5iaW5kKF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpKTsKICAgIHJldHVybiBfdGhpczsKICB9CiAgX2NyZWF0ZUNsYXNzKENvbmZpcm1JbnZvaWNlUGFnZSwgW3sKICAgIGtleTogImNvbXBvbmVudERpZE1vdW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHsKICAgICAgdGhpcy5mZXRjaEludm9pY2VEYXRhKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXRzIHN0YXRlIG9mIGludm9pY2UgaXRlbXMgYWZ0ZXIgZmV0Y2ggYW5kIGNhbGxzIG1ldGhvZCB0byBmZXRjaCBuZXh0IGl0ZW1zCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc3RhcnRJbmRleAogICAgICogQHB1YmxpYwogICAgICovCiAgfSwgewogICAga2V5OiAic2V0SW52b2ljZUl0ZW1zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRJbnZvaWNlSXRlbXMocmVzcG9uc2UsIHN0YXJ0SW5kZXgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CiAgICAgIHRoaXMucHJvcHMuc2hvd1NwaW5uZXIoKTsKICAgICAgdmFyIF9yZXNwb25zZSRkYXRhID0gcmVzcG9uc2UuZGF0YSwKICAgICAgICBkYXRhID0gX3Jlc3BvbnNlJGRhdGEuZGF0YSwKICAgICAgICB0b3RhbENvdW50ID0gX3Jlc3BvbnNlJGRhdGEudG90YWxDb3VudDsKICAgICAgdmFyIGludm9pY2VJdGVtcyA9IF8uaXNOdWxsKHN0YXJ0SW5kZXgpIHx8IHN0YXJ0SW5kZXggPT09IDAgPyBkYXRhIDogXy51bmlxQnkoXy5jb25jYXQodGhpcy5zdGF0ZS52YWx1ZXMuaW52b2ljZUl0ZW1zLCBkYXRhKSwgJ2lkJyk7CiAgICAgIHZhciB0b3RhbFZhbHVlID0gXy5yZWR1Y2UoaW52b2ljZUl0ZW1zLCBmdW5jdGlvbiAoc3VtLCB2YWwpIHsKICAgICAgICByZXR1cm4gc3VtICsgKHZhbC50b3RhbEFtb3VudCA/IHBhcnNlRmxvYXQodmFsLnRvdGFsQW1vdW50KSA6IDAuMCk7CiAgICAgIH0sIDApOwogICAgICB0aGlzLnNldFN0YXRlKHsKICAgICAgICB2YWx1ZXM6IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgdGhpcy5zdGF0ZS52YWx1ZXMpLCB7fSwgewogICAgICAgICAgaW52b2ljZUl0ZW1zOiBpbnZvaWNlSXRlbXMsCiAgICAgICAgICB0b3RhbENvdW50OiB0b3RhbENvdW50LAogICAgICAgICAgdG90YWxWYWx1ZTogYWNjb3VudGluZ0Zvcm1hdCh0b3RhbFZhbHVlLnRvRml4ZWQoMikpCiAgICAgICAgfSkKICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgIGlmICghXy5pc051bGwoc3RhcnRJbmRleCkgJiYgX3RoaXMyLnN0YXRlLnZhbHVlcy5pbnZvaWNlSXRlbXMubGVuZ3RoICE9PSBfdGhpczIuc3RhdGUudmFsdWVzLnRvdGFsQ291bnQpIHsKICAgICAgICAgIF90aGlzMi5sb2FkTW9yZVJvd3MoewogICAgICAgICAgICBzdGFydEluZGV4OiBzdGFydEluZGV4ICsgX3RoaXMyLnByb3BzLnBhZ2VTaXplCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgaWYgKF90aGlzMi5zdGF0ZS52YWx1ZXMuaW52b2ljZUl0ZW1zLmxlbmd0aCA9PT0gX3RoaXMyLnN0YXRlLnZhbHVlcy50b3RhbENvdW50ICYmICFfdGhpczIuc3RhdGUudmFsdWVzLmlzUHJlcGF5bWVudEludm9pY2UpIHsKICAgICAgICAgIF90aGlzMi5mZXRjaFByZXBheW1lbnRJdGVtcygpOwogICAgICAgIH0KICAgICAgICBfdGhpczIucHJvcHMuaGlkZVNwaW5uZXIoKTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBGZXRjaGVzIGludm9pY2UgdmFsdWVzIGZyb20gQVBJLgogICAgICogQHB1YmxpYwogICAgICovCiAgfSwgewogICAga2V5OiAiZmV0Y2hJbnZvaWNlRGF0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZmV0Y2hJbnZvaWNlRGF0YSgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CiAgICAgIGlmICh0aGlzLnN0YXRlLnZhbHVlcy5pZCkgewogICAgICAgIHRoaXMucHJvcHMuc2hvd1NwaW5uZXIoKTsKICAgICAgICB2YXIgdXJsID0gIi9vcGVuYm94ZXMvYXBpL2ludm9pY2VzLyIuY29uY2F0KHRoaXMuc3RhdGUudmFsdWVzLmlkKTsKICAgICAgICBhcGlDbGllbnQuZ2V0KHVybCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIHZhciB2YWx1ZXMgPSBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIF90aGlzMy5zdGF0ZS52YWx1ZXMpLCB7fSwgewogICAgICAgICAgICBkb2N1bWVudHM6IHJlc3BvbnNlLmRhdGEuZGF0YS5kb2N1bWVudHMKICAgICAgICAgIH0pOwogICAgICAgICAgX3RoaXMzLnNldFN0YXRlKHsKICAgICAgICAgICAgdmFsdWVzOiB2YWx1ZXMKICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzMy5wcm9wcy5oaWRlU3Bpbm5lcigpOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIENoZWNrcyBpZiByb3cgaXMgbG9hZGVkLCBuZWVkZWQgZm9yIHBhZ2luYXRpb24KICAgICAqIEBwYXJhbSB7c3RyaW5nfSBpbmRleAogICAgICogQHB1YmxpYwogICAgICovCiAgfSwgewogICAga2V5OiAiaXNSb3dMb2FkZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGlzUm93TG9hZGVkKF9yZWY5KSB7CiAgICAgIHZhciBpbmRleCA9IF9yZWY5LmluZGV4OwogICAgICByZXR1cm4gISF0aGlzLnN0YXRlLnZhbHVlcy5pbnZvaWNlSXRlbXNbaW5kZXhdOwogICAgfQoKICAgIC8qKgogICAgICogTG9hZHMgbW9yZSByb3dzLCBuZWVkZWQgZm9yIHBhZ2luYXRpb24KICAgICAqIEBwYXJhbSB7aW5kZXh9IHN0YXJ0SW5kZXgKICAgICAqIEBwdWJsaWMKICAgICAqLwogIH0sIHsKICAgIGtleTogImxvYWRNb3JlUm93cyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZE1vcmVSb3dzKF9yZWYxMCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKICAgICAgdmFyIHN0YXJ0SW5kZXggPSBfcmVmMTAuc3RhcnRJbmRleDsKICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgaXNGaXJzdFBhZ2VMb2FkZWQ6IHRydWUKICAgICAgfSk7CiAgICAgIHZhciB1cmwgPSAiL29wZW5ib3hlcy9hcGkvaW52b2ljZXMvIi5jb25jYXQodGhpcy5zdGF0ZS52YWx1ZXMuaWQsICIvaXRlbXM/b2Zmc2V0PSIpLmNvbmNhdChzdGFydEluZGV4LCAiJm1heD0iKS5jb25jYXQodGhpcy5wcm9wcy5wYWdlU2l6ZSk7CiAgICAgIGFwaUNsaWVudC5nZXQodXJsKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIF90aGlzNC5zZXRJbnZvaWNlSXRlbXMocmVzcG9uc2UsIHN0YXJ0SW5kZXgpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzdWJtaXRJbnZvaWNlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzdWJtaXRJbnZvaWNlKCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKICAgICAgdmFyIHVybCA9ICIvb3BlbmJveGVzL2FwaS9pbnZvaWNlcy8iLmNvbmNhdCh0aGlzLnN0YXRlLnZhbHVlcy5pZCwgIi9zdWJtaXQiKTsKICAgICAgYXBpQ2xpZW50LnBvc3QodXJsKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICB3aW5kb3cubG9jYXRpb24gPSAiL29wZW5ib3hlcy9pbnZvaWNlL3Nob3cvIi5jb25jYXQoX3RoaXM1LnN0YXRlLnZhbHVlcy5pZCk7CiAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gX3RoaXM1LnByb3BzLmhpZGVTcGlubmVyKCk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInBvc3RJbnZvaWNlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBwb3N0SW52b2ljZSgpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CiAgICAgIHZhciB1cmwgPSAiL29wZW5ib3hlcy9hcGkvaW52b2ljZXMvIi5jb25jYXQodGhpcy5zdGF0ZS52YWx1ZXMuaWQsICIvcG9zdCIpOwogICAgICBhcGlDbGllbnQucG9zdCh1cmwpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9ICIvb3BlbmJveGVzL2ludm9pY2Uvc2hvdy8iLmNvbmNhdChfdGhpczYuc3RhdGUudmFsdWVzLmlkKTsKICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBfdGhpczYucHJvcHMuaGlkZVNwaW5uZXIoKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZmV0Y2hQcmVwYXltZW50SXRlbXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZldGNoUHJlcGF5bWVudEl0ZW1zKCkgewogICAgICB2YXIgX3RoaXM3ID0gdGhpczsKICAgICAgdmFyIHVybCA9ICIvb3BlbmJveGVzL2FwaS9pbnZvaWNlcy8iLmNvbmNhdCh0aGlzLnN0YXRlLnZhbHVlcy5pZCwgIi9wcmVwYXltZW50SXRlbXMiKTsKICAgICAgYXBpQ2xpZW50LmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgdmFyIGRhdGEgPSByZXNwb25zZS5kYXRhLmRhdGE7CiAgICAgICAgdmFyIGxpbmVJdGVtc0RhdGEgPSBfLm1hcChfLmZpbHRlcihkYXRhLCBmdW5jdGlvbiAodmFsKSB7CiAgICAgICAgICByZXR1cm4gdmFsLm9yZGVyTnVtYmVyID09PSBfdGhpczcuc3RhdGUudmFsdWVzLnZlbmRvckludm9pY2VOdW1iZXI7CiAgICAgICAgfSksIGZ1bmN0aW9uICh2YWwpIHsKICAgICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHZhbCksIHt9LCB7CiAgICAgICAgICAgIHRvdGFsQW1vdW50OiB2YWwudG90YWxQcmVwYXltZW50QW1vdW50LAogICAgICAgICAgICBpc1ByZXBheW1lbnRJdGVtOiB0cnVlCiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgICB2YXIgaW52b2ljZUl0ZW1zID0gXy5jb25jYXQoX3RoaXM3LnN0YXRlLnZhbHVlcy5pbnZvaWNlSXRlbXMsIGxpbmVJdGVtc0RhdGEpOwogICAgICAgIHZhciB1cGRhdGVkVG90YWxDb3VudCA9IF90aGlzNy5zdGF0ZS52YWx1ZXMudG90YWxDb3VudCArIGxpbmVJdGVtc0RhdGEubGVuZ3RoOwogICAgICAgIHZhciB0b3RhbFZhbHVlID0gXy5yZWR1Y2UoaW52b2ljZUl0ZW1zLCBmdW5jdGlvbiAoc3VtLCB2YWwpIHsKICAgICAgICAgIHJldHVybiBzdW0gKyAodmFsLnRvdGFsQW1vdW50ID8gcGFyc2VGbG9hdCh2YWwudG90YWxBbW91bnQpIDogMC4wKTsKICAgICAgICB9LCAwKTsKICAgICAgICBfdGhpczcuc2V0U3RhdGUoewogICAgICAgICAgdmFsdWVzOiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIF90aGlzNy5zdGF0ZS52YWx1ZXMpLCB7fSwgewogICAgICAgICAgICBpbnZvaWNlSXRlbXM6IGludm9pY2VJdGVtcywKICAgICAgICAgICAgdG90YWxDb3VudDogdXBkYXRlZFRvdGFsQ291bnQsCiAgICAgICAgICAgIHRvdGFsVmFsdWU6IGFjY291bnRpbmdGb3JtYXQodG90YWxWYWx1ZS50b0ZpeGVkKDIpKQogICAgICAgICAgfSkKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUb2dnbGUgdGhlIGRvd25sb2FkYWJsZSBmaWxlcwogICAgICovCiAgfSwgewogICAga2V5OiAidG9nZ2xlRHJvcGRvd24iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHRvZ2dsZURyb3Bkb3duKCkgewogICAgICB0aGlzLnNldFN0YXRlKHsKICAgICAgICBpc0Ryb3Bkb3duVmlzaWJsZTogIXRoaXMuc3RhdGUuaXNEcm9wZG93blZpc2libGUKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7CiAgICAgIHZhciBfdGhpczggPSB0aGlzOwogICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEZvcm0sIHsKICAgICAgICBvblN1Ym1pdDogZnVuY3Rpb24gb25TdWJtaXQoKSB7fSwKICAgICAgICB2YWxpZGF0ZTogdGhpcy52YWxpZGF0ZSwKICAgICAgICBpbml0aWFsVmFsdWVzOiB0aGlzLnN0YXRlLnZhbHVlcywKICAgICAgICBtdXRhdG9yczogX29iamVjdFNwcmVhZCh7fSwgYXJyYXlNdXRhdG9ycyksCiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoX3JlZjExKSB7CiAgICAgICAgICB2YXIgaGFuZGxlU3VibWl0ID0gX3JlZjExLmhhbmRsZVN1Ym1pdCwKICAgICAgICAgICAgdmFsdWVzID0gX3JlZjExLnZhbHVlczsKICAgICAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZm9ybSIsIHsKICAgICAgICAgICAgb25TdWJtaXQ6IGhhbmRsZVN1Ym1pdAogICAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICAgICAgY2xhc3NOYW1lOiAiY2xhc3NpYy1mb3JtIGNsYXNzaWMtZm9ybS1jb25kZW5zZWQiCiAgICAgICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIHsKICAgICAgICAgICAgY2xhc3NOYW1lOiAiYnV0dG9ucy1jb250YWluZXIgY2xhc3NpYy1mb3JtLWJ1dHRvbnMiCiAgICAgICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiYnV0dG9uIiwgewogICAgICAgICAgICB0eXBlOiAiYnV0dG9uIiwKICAgICAgICAgICAgY2xhc3NOYW1lOiAiYnRuIGJ0bi1vdXRsaW5lLXNlY29uZGFyeSBmbG9hdC1yaWdodCBidG4tZm9ybSBidG4teHMiLAogICAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9ICIvb3BlbmJveGVzL2ludm9pY2Uvc2hvdy8iLmNvbmNhdCh2YWx1ZXMuaWQpOwogICAgICAgICAgICB9CiAgICAgICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJpIiwgewogICAgICAgICAgICBjbGFzc05hbWU6ICJmYSBmYS1zaWduLW91dCBwci0yIgogICAgICAgICAgfSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyYW5zbGF0ZSwgewogICAgICAgICAgICBpZDogInJlYWN0LmRlZmF1bHQuYnV0dG9uLnNhdmVBbmRFeGl0LmxhYmVsIiwKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJTYXZlIGFuZCBleGl0IgogICAgICAgICAgfSkpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCB7CiAgICAgICAgICAgIGNsYXNzTmFtZTogIm1yLTMiCiAgICAgICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgICBjbGFzc05hbWU6ICJkcm9wZG93biIKICAgICAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJidXR0b24iLCB7CiAgICAgICAgICAgIHR5cGU6ICJidXR0b24iLAogICAgICAgICAgICBvbkNsaWNrOiBfdGhpczgudG9nZ2xlRHJvcGRvd24sCiAgICAgICAgICAgIGNsYXNzTmFtZTogImRyb3Bkb3duLWJ1dHRvbiBmbG9hdC1yaWdodCBtYi0xIGJ0biBidG4tb3V0bGluZS1zZWNvbmRhcnkgYWxpZ24tc2VsZi1lbmQgYnRuLXhzIgogICAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiaSIsIHsKICAgICAgICAgICAgY2xhc3NOYW1lOiAiZmEgZmEtc2lnbi1vdXQgcHItMiIKICAgICAgICAgIH0pLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUcmFuc2xhdGUsIHsKICAgICAgICAgICAgaWQ6ICJyZWFjdC5kZWZhdWx0LmJ1dHRvbi5kb3dubG9hZC5sYWJlbCIsCiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiRG93bmxvYWQiCiAgICAgICAgICB9KSkpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgICBjbGFzc05hbWU6ICJkcm9wZG93bi1jb250ZW50IHByaW50LWJ1dHRvbnMtY29udGFpbmVyIGNvbC1tZC0zIGZsZXgtZ3Jvdy0xXG4gICAgICAgICAgICAgICAgICAgICAgICAiLmNvbmNhdChfdGhpczguc3RhdGUuaXNEcm9wZG93blZpc2libGUgPyAndmlzaWJsZScgOiAnJykKICAgICAgICAgIH0sIF90aGlzOC5zdGF0ZS52YWx1ZXMuZG9jdW1lbnRzICYmIF90aGlzOC5zdGF0ZS52YWx1ZXMuZG9jdW1lbnRzLmxlbmd0aCA+IDAgJiYgXy5tYXAoX3RoaXM4LnN0YXRlLnZhbHVlcy5kb2N1bWVudHMsIGZ1bmN0aW9uIChkb2N1bWVudCwgaWR4KSB7CiAgICAgICAgICAgIGlmIChkb2N1bWVudC5oaWRkZW4pIHsKICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRG9jdW1lbnRCdXR0b24sIF9leHRlbmRzKHsKICAgICAgICAgICAgICBsaW5rOiBkb2N1bWVudC5saW5rLAogICAgICAgICAgICAgIGJ1dHRvblRpdGxlOiBkb2N1bWVudC5uYW1lCiAgICAgICAgICAgIH0sIGRvY3VtZW50LCB7CiAgICAgICAgICAgICAga2V5OiBpZHgsCiAgICAgICAgICAgICAgZGlzYWJsZWQ6IGZhbHNlCiAgICAgICAgICAgIH0pKTsKICAgICAgICAgIH0pKSkpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICAgICAgY2xhc3NOYW1lOiAiZm9ybS10aXRsZSIKICAgICAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyYW5zbGF0ZSwgewogICAgICAgICAgICBpZDogInJlYWN0Lmludm9pY2Uub3B0aW9ucy5sYWJlbCIsCiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiSW52b2ljZSBvcHRpb25zIgogICAgICAgICAgfSkpLCBfLm1hcChJTlZPSUNFX0hFQURFUl9GSUVMRFMsIGZ1bmN0aW9uIChmaWVsZENvbmZpZywgZmllbGROYW1lKSB7CiAgICAgICAgICAgIHJldHVybiByZW5kZXJGb3JtRmllbGQoZmllbGRDb25maWcsIGZpZWxkTmFtZSwgewogICAgICAgICAgICAgIHZhbHVlczogdmFsdWVzLAogICAgICAgICAgICAgIHRvdGFsQ291bnQ6IF90aGlzOC5zdGF0ZS52YWx1ZXMudG90YWxDb3VudCwKICAgICAgICAgICAgICBsb2FkTW9yZVJvd3M6IF90aGlzOC5sb2FkTW9yZVJvd3MsCiAgICAgICAgICAgICAgaXNSb3dMb2FkZWQ6IF90aGlzOC5pc1Jvd0xvYWRlZCwKICAgICAgICAgICAgICBpc0ZpcnN0UGFnZUxvYWRlZDogX3RoaXM4LnN0YXRlLmlzRmlyc3RQYWdlTG9hZGVkCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSkpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgICBjbGFzc05hbWU6ICJzdWJtaXQtYnV0dG9ucyIKICAgICAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJidXR0b24iLCB7CiAgICAgICAgICAgIGNsYXNzTmFtZTogImJ0biBidG4tb3V0bGluZS1wcmltYXJ5IGJ0bi1mb3JtIGJ0bi14cyIsCiAgICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzOC5wcm9wcy5wcmV2aW91c1BhZ2UoX3RoaXM4LnN0YXRlLnZhbHVlcyk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGRpc2FibGVkOiBfdGhpczguc3RhdGUudmFsdWVzLmRhdGVQb3N0ZWQgfHwgX3RoaXM4LnN0YXRlLnZhbHVlcy5pbnZvaWNlVHlwZSA9PT0gUFJFUEFZTUVOVF9JTlZPSUNFIHx8IF90aGlzOC5zdGF0ZS52YWx1ZXMuaGFzUHJlcGF5bWVudEludm9pY2UKICAgICAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyYW5zbGF0ZSwgewogICAgICAgICAgICBpZDogInJlYWN0LmRlZmF1bHQuYnV0dG9uLnByZXZpb3VzLmxhYmVsIiwKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJQcmV2aW91cyIKICAgICAgICAgIH0pKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIsIHsKICAgICAgICAgICAgdHlwZTogInN1Ym1pdCIsCiAgICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICAgICAgX3RoaXM4LnN1Ym1pdEludm9pY2UoKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgY2xhc3NOYW1lOiAiYnRuIGJ0bi1vdXRsaW5lLXN1Y2Nlc3MgZmxvYXQtcmlnaHQgYnRuLWZvcm0gYnRuLXhzIiwKICAgICAgICAgICAgZGlzYWJsZWQ6IF90aGlzOC5zdGF0ZS52YWx1ZXMuZGF0ZVN1Ym1pdHRlZCB8fCBfdGhpczguc3RhdGUudmFsdWVzLmRhdGVQb3N0ZWQKICAgICAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyYW5zbGF0ZSwgewogICAgICAgICAgICBpZDogInJlYWN0Lmludm9pY2Uuc3VibWl0LmxhYmVsIiwKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJTdWJtaXQgZm9yIEFwcHJvdmFsIgogICAgICAgICAgfSkpLCBfdGhpczgucHJvcHMuaXNTdXBlcnVzZXIgJiYgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIsIHsKICAgICAgICAgICAgdHlwZTogInN1Ym1pdCIsCiAgICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICAgICAgX3RoaXM4LnBvc3RJbnZvaWNlKCk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGNsYXNzTmFtZTogImJ0biBidG4tb3V0bGluZS1zdWNjZXNzIGZsb2F0LXJpZ2h0IGJ0bi1mb3JtIGJ0bi14cyIsCiAgICAgICAgICAgIGRpc2FibGVkOiBfdGhpczguc3RhdGUudmFsdWVzLmRhdGVQb3N0ZWQKICAgICAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyYW5zbGF0ZSwgewogICAgICAgICAgICBpZDogInJlYWN0Lmludm9pY2UucG9zdC5sYWJlbCIsCiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiUG9zdCBJbnZvaWNlIgogICAgICAgICAgfSkpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICAgICAgY2xhc3NOYW1lOiAibXktMiB0YWJsZS1mb3JtIgogICAgICAgICAgfSwgXy5tYXAoSU5WT0lDRV9JVEVNUywgZnVuY3Rpb24gKGZpZWxkQ29uZmlnLCBmaWVsZE5hbWUpIHsKICAgICAgICAgICAgcmV0dXJuIHJlbmRlckZvcm1GaWVsZChmaWVsZENvbmZpZywgZmllbGROYW1lLCB7CiAgICAgICAgICAgICAgdmFsdWVzOiBfdGhpczguc3RhdGUudmFsdWVzLAogICAgICAgICAgICAgIHRvdGFsQ291bnQ6IF90aGlzOC5zdGF0ZS52YWx1ZXMudG90YWxDb3VudCwKICAgICAgICAgICAgICBsb2FkTW9yZVJvd3M6IF90aGlzOC5sb2FkTW9yZVJvd3MsCiAgICAgICAgICAgICAgaXNSb3dMb2FkZWQ6IF90aGlzOC5pc1Jvd0xvYWRlZCwKICAgICAgICAgICAgICBpc0ZpcnN0UGFnZUxvYWRlZDogX3RoaXM4LnN0YXRlLmlzRmlyc3RQYWdlTG9hZGVkLAogICAgICAgICAgICAgIHVwZGF0ZVRvdGFsQ291bnQ6IF90aGlzOC51cGRhdGVUb3RhbENvdW50CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSkpKTsKICAgICAgICB9CiAgICAgIH0pKTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIENvbmZpcm1JbnZvaWNlUGFnZTsKfShDb21wb25lbnQpOwp2YXIgbWFwU3RhdGVUb1Byb3BzID0gZnVuY3Rpb24gbWFwU3RhdGVUb1Byb3BzKHN0YXRlKSB7CiAgcmV0dXJuIHsKICAgIHBhZ2VTaXplOiBzdGF0ZS5zZXNzaW9uLnBhZ2VTaXplLAogICAgaXNTdXBlcnVzZXI6IHN0YXRlLnNlc3Npb24uaXNTdXBlcnVzZXIKICB9Owp9OwpleHBvcnQgZGVmYXVsdCBjb25uZWN0KG1hcFN0YXRlVG9Qcm9wcywgewogIHNob3dTcGlubmVyOiBzaG93U3Bpbm5lciwKICBoaWRlU3Bpbm5lcjogaGlkZVNwaW5uZXIKfSkoQ29uZmlybUludm9pY2VQYWdlKTsKQ29uZmlybUludm9pY2VQYWdlLnByb3BUeXBlcyA9IHsKICAvKiogSW5pdGlhbCBjb21wb25lbnQncyBkYXRhICovCiAgaW5pdGlhbFZhbHVlczogUHJvcFR5cGVzLnNoYXBlKHt9KS5pc1JlcXVpcmVkLAogIC8qKiBGdW5jdGlvbiByZXR1cm5pbmcgdXNlciB0byB0aGUgcHJldmlvdXMgcGFnZSAqLwogIHByZXZpb3VzUGFnZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCwKICAvKiogRnVuY3Rpb24gY2FsbGVkIHdoZW4gZGF0YSBpcyBsb2FkaW5nICovCiAgc2hvd1NwaW5uZXI6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsCiAgLyoqIEZ1bmN0aW9uIGNhbGxlZCB3aGVuIGRhdGEgaGFzIGxvYWRlZCAqLwogIGhpZGVTcGlubmVyOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLAogIHBhZ2VTaXplOiBQcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWQsCiAgaXNTdXBlcnVzZXI6IFByb3BUeXBlcy5ib29sLmlzUmVxdWlyZWQKfTs="},null]}