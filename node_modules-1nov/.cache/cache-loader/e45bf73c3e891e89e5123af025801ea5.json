{"remainingRequest":"/opt/MTOBS-BIKASH/node_modules/babel-loader/lib/index.js?presets[]=@babel/react&presets[]=@babel/env!/opt/MTOBS-BIKASH/node_modules/eslint-loader/dist/cjs.js!/opt/MTOBS-BIKASH/src/js/utils/option-utils.jsx","dependencies":[{"path":"/opt/MTOBS-BIKASH/src/js/utils/option-utils.jsx","mtime":1698037753000},{"path":"/opt/MTOBS-BIKASH/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/opt/MTOBS-BIKASH/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/opt/MTOBS-BIKASH/node_modules/eslint-loader/dist/cjs.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsgcmV0dXJuIF90eXBlb2YgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgInN5bWJvbCIgPT0gdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfSwgX3R5cGVvZihvYmopOyB9CmZ1bmN0aW9uIF9yZWdlbmVyYXRvclJ1bnRpbWUoKSB7ICJ1c2Ugc3RyaWN0IjsgLyohIHJlZ2VuZXJhdG9yLXJ1bnRpbWUgLS0gQ29weXJpZ2h0IChjKSAyMDE0LXByZXNlbnQsIEZhY2Vib29rLCBJbmMuIC0tIGxpY2Vuc2UgKE1JVCk6IGh0dHBzOi8vZ2l0aHViLmNvbS9mYWNlYm9vay9yZWdlbmVyYXRvci9ibG9iL21haW4vTElDRU5TRSAqLyBfcmVnZW5lcmF0b3JSdW50aW1lID0gZnVuY3Rpb24gX3JlZ2VuZXJhdG9yUnVudGltZSgpIHsgcmV0dXJuIGV4cG9ydHM7IH07IHZhciBleHBvcnRzID0ge30sIE9wID0gT2JqZWN0LnByb3RvdHlwZSwgaGFzT3duID0gT3AuaGFzT3duUHJvcGVydHksIGRlZmluZVByb3BlcnR5ID0gT2JqZWN0LmRlZmluZVByb3BlcnR5IHx8IGZ1bmN0aW9uIChvYmosIGtleSwgZGVzYykgeyBvYmpba2V5XSA9IGRlc2MudmFsdWU7IH0sICRTeW1ib2wgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgPyBTeW1ib2wgOiB7fSwgaXRlcmF0b3JTeW1ib2wgPSAkU3ltYm9sLml0ZXJhdG9yIHx8ICJAQGl0ZXJhdG9yIiwgYXN5bmNJdGVyYXRvclN5bWJvbCA9ICRTeW1ib2wuYXN5bmNJdGVyYXRvciB8fCAiQEBhc3luY0l0ZXJhdG9yIiwgdG9TdHJpbmdUYWdTeW1ib2wgPSAkU3ltYm9sLnRvU3RyaW5nVGFnIHx8ICJAQHRvU3RyaW5nVGFnIjsgZnVuY3Rpb24gZGVmaW5lKG9iaiwga2V5LCB2YWx1ZSkgeyByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogITAsIGNvbmZpZ3VyYWJsZTogITAsIHdyaXRhYmxlOiAhMCB9KSwgb2JqW2tleV07IH0gdHJ5IHsgZGVmaW5lKHt9LCAiIik7IH0gY2F0Y2ggKGVycikgeyBkZWZpbmUgPSBmdW5jdGlvbiBkZWZpbmUob2JqLCBrZXksIHZhbHVlKSB7IHJldHVybiBvYmpba2V5XSA9IHZhbHVlOyB9OyB9IGZ1bmN0aW9uIHdyYXAoaW5uZXJGbiwgb3V0ZXJGbiwgc2VsZiwgdHJ5TG9jc0xpc3QpIHsgdmFyIHByb3RvR2VuZXJhdG9yID0gb3V0ZXJGbiAmJiBvdXRlckZuLnByb3RvdHlwZSBpbnN0YW5jZW9mIEdlbmVyYXRvciA/IG91dGVyRm4gOiBHZW5lcmF0b3IsIGdlbmVyYXRvciA9IE9iamVjdC5jcmVhdGUocHJvdG9HZW5lcmF0b3IucHJvdG90eXBlKSwgY29udGV4dCA9IG5ldyBDb250ZXh0KHRyeUxvY3NMaXN0IHx8IFtdKTsgcmV0dXJuIGRlZmluZVByb3BlcnR5KGdlbmVyYXRvciwgIl9pbnZva2UiLCB7IHZhbHVlOiBtYWtlSW52b2tlTWV0aG9kKGlubmVyRm4sIHNlbGYsIGNvbnRleHQpIH0pLCBnZW5lcmF0b3I7IH0gZnVuY3Rpb24gdHJ5Q2F0Y2goZm4sIG9iaiwgYXJnKSB7IHRyeSB7IHJldHVybiB7IHR5cGU6ICJub3JtYWwiLCBhcmc6IGZuLmNhbGwob2JqLCBhcmcpIH07IH0gY2F0Y2ggKGVycikgeyByZXR1cm4geyB0eXBlOiAidGhyb3ciLCBhcmc6IGVyciB9OyB9IH0gZXhwb3J0cy53cmFwID0gd3JhcDsgdmFyIENvbnRpbnVlU2VudGluZWwgPSB7fTsgZnVuY3Rpb24gR2VuZXJhdG9yKCkge30gZnVuY3Rpb24gR2VuZXJhdG9yRnVuY3Rpb24oKSB7fSBmdW5jdGlvbiBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSgpIHt9IHZhciBJdGVyYXRvclByb3RvdHlwZSA9IHt9OyBkZWZpbmUoSXRlcmF0b3JQcm90b3R5cGUsIGl0ZXJhdG9yU3ltYm9sLCBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9KTsgdmFyIGdldFByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mLCBOYXRpdmVJdGVyYXRvclByb3RvdHlwZSA9IGdldFByb3RvICYmIGdldFByb3RvKGdldFByb3RvKHZhbHVlcyhbXSkpKTsgTmF0aXZlSXRlcmF0b3JQcm90b3R5cGUgJiYgTmF0aXZlSXRlcmF0b3JQcm90b3R5cGUgIT09IE9wICYmIGhhc093bi5jYWxsKE5hdGl2ZUl0ZXJhdG9yUHJvdG90eXBlLCBpdGVyYXRvclN5bWJvbCkgJiYgKEl0ZXJhdG9yUHJvdG90eXBlID0gTmF0aXZlSXRlcmF0b3JQcm90b3R5cGUpOyB2YXIgR3AgPSBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZS5wcm90b3R5cGUgPSBHZW5lcmF0b3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShJdGVyYXRvclByb3RvdHlwZSk7IGZ1bmN0aW9uIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyhwcm90b3R5cGUpIHsgWyJuZXh0IiwgInRocm93IiwgInJldHVybiJdLmZvckVhY2goZnVuY3Rpb24gKG1ldGhvZCkgeyBkZWZpbmUocHJvdG90eXBlLCBtZXRob2QsIGZ1bmN0aW9uIChhcmcpIHsgcmV0dXJuIHRoaXMuX2ludm9rZShtZXRob2QsIGFyZyk7IH0pOyB9KTsgfSBmdW5jdGlvbiBBc3luY0l0ZXJhdG9yKGdlbmVyYXRvciwgUHJvbWlzZUltcGwpIHsgZnVuY3Rpb24gaW52b2tlKG1ldGhvZCwgYXJnLCByZXNvbHZlLCByZWplY3QpIHsgdmFyIHJlY29yZCA9IHRyeUNhdGNoKGdlbmVyYXRvclttZXRob2RdLCBnZW5lcmF0b3IsIGFyZyk7IGlmICgidGhyb3ciICE9PSByZWNvcmQudHlwZSkgeyB2YXIgcmVzdWx0ID0gcmVjb3JkLmFyZywgdmFsdWUgPSByZXN1bHQudmFsdWU7IHJldHVybiB2YWx1ZSAmJiAib2JqZWN0IiA9PSBfdHlwZW9mKHZhbHVlKSAmJiBoYXNPd24uY2FsbCh2YWx1ZSwgIl9fYXdhaXQiKSA/IFByb21pc2VJbXBsLnJlc29sdmUodmFsdWUuX19hd2FpdCkudGhlbihmdW5jdGlvbiAodmFsdWUpIHsgaW52b2tlKCJuZXh0IiwgdmFsdWUsIHJlc29sdmUsIHJlamVjdCk7IH0sIGZ1bmN0aW9uIChlcnIpIHsgaW52b2tlKCJ0aHJvdyIsIGVyciwgcmVzb2x2ZSwgcmVqZWN0KTsgfSkgOiBQcm9taXNlSW1wbC5yZXNvbHZlKHZhbHVlKS50aGVuKGZ1bmN0aW9uICh1bndyYXBwZWQpIHsgcmVzdWx0LnZhbHVlID0gdW53cmFwcGVkLCByZXNvbHZlKHJlc3VsdCk7IH0sIGZ1bmN0aW9uIChlcnJvcikgeyByZXR1cm4gaW52b2tlKCJ0aHJvdyIsIGVycm9yLCByZXNvbHZlLCByZWplY3QpOyB9KTsgfSByZWplY3QocmVjb3JkLmFyZyk7IH0gdmFyIHByZXZpb3VzUHJvbWlzZTsgZGVmaW5lUHJvcGVydHkodGhpcywgIl9pbnZva2UiLCB7IHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShtZXRob2QsIGFyZykgeyBmdW5jdGlvbiBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZygpIHsgcmV0dXJuIG5ldyBQcm9taXNlSW1wbChmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IGludm9rZShtZXRob2QsIGFyZywgcmVzb2x2ZSwgcmVqZWN0KTsgfSk7IH0gcmV0dXJuIHByZXZpb3VzUHJvbWlzZSA9IHByZXZpb3VzUHJvbWlzZSA/IHByZXZpb3VzUHJvbWlzZS50aGVuKGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnLCBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZykgOiBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZygpOyB9IH0pOyB9IGZ1bmN0aW9uIG1ha2VJbnZva2VNZXRob2QoaW5uZXJGbiwgc2VsZiwgY29udGV4dCkgeyB2YXIgc3RhdGUgPSAic3VzcGVuZGVkU3RhcnQiOyByZXR1cm4gZnVuY3Rpb24gKG1ldGhvZCwgYXJnKSB7IGlmICgiZXhlY3V0aW5nIiA9PT0gc3RhdGUpIHRocm93IG5ldyBFcnJvcigiR2VuZXJhdG9yIGlzIGFscmVhZHkgcnVubmluZyIpOyBpZiAoImNvbXBsZXRlZCIgPT09IHN0YXRlKSB7IGlmICgidGhyb3ciID09PSBtZXRob2QpIHRocm93IGFyZzsgcmV0dXJuIGRvbmVSZXN1bHQoKTsgfSBmb3IgKGNvbnRleHQubWV0aG9kID0gbWV0aG9kLCBjb250ZXh0LmFyZyA9IGFyZzs7KSB7IHZhciBkZWxlZ2F0ZSA9IGNvbnRleHQuZGVsZWdhdGU7IGlmIChkZWxlZ2F0ZSkgeyB2YXIgZGVsZWdhdGVSZXN1bHQgPSBtYXliZUludm9rZURlbGVnYXRlKGRlbGVnYXRlLCBjb250ZXh0KTsgaWYgKGRlbGVnYXRlUmVzdWx0KSB7IGlmIChkZWxlZ2F0ZVJlc3VsdCA9PT0gQ29udGludWVTZW50aW5lbCkgY29udGludWU7IHJldHVybiBkZWxlZ2F0ZVJlc3VsdDsgfSB9IGlmICgibmV4dCIgPT09IGNvbnRleHQubWV0aG9kKSBjb250ZXh0LnNlbnQgPSBjb250ZXh0Ll9zZW50ID0gY29udGV4dC5hcmc7ZWxzZSBpZiAoInRocm93IiA9PT0gY29udGV4dC5tZXRob2QpIHsgaWYgKCJzdXNwZW5kZWRTdGFydCIgPT09IHN0YXRlKSB0aHJvdyBzdGF0ZSA9ICJjb21wbGV0ZWQiLCBjb250ZXh0LmFyZzsgY29udGV4dC5kaXNwYXRjaEV4Y2VwdGlvbihjb250ZXh0LmFyZyk7IH0gZWxzZSAicmV0dXJuIiA9PT0gY29udGV4dC5tZXRob2QgJiYgY29udGV4dC5hYnJ1cHQoInJldHVybiIsIGNvbnRleHQuYXJnKTsgc3RhdGUgPSAiZXhlY3V0aW5nIjsgdmFyIHJlY29yZCA9IHRyeUNhdGNoKGlubmVyRm4sIHNlbGYsIGNvbnRleHQpOyBpZiAoIm5vcm1hbCIgPT09IHJlY29yZC50eXBlKSB7IGlmIChzdGF0ZSA9IGNvbnRleHQuZG9uZSA/ICJjb21wbGV0ZWQiIDogInN1c3BlbmRlZFlpZWxkIiwgcmVjb3JkLmFyZyA9PT0gQ29udGludWVTZW50aW5lbCkgY29udGludWU7IHJldHVybiB7IHZhbHVlOiByZWNvcmQuYXJnLCBkb25lOiBjb250ZXh0LmRvbmUgfTsgfSAidGhyb3ciID09PSByZWNvcmQudHlwZSAmJiAoc3RhdGUgPSAiY29tcGxldGVkIiwgY29udGV4dC5tZXRob2QgPSAidGhyb3ciLCBjb250ZXh0LmFyZyA9IHJlY29yZC5hcmcpOyB9IH07IH0gZnVuY3Rpb24gbWF5YmVJbnZva2VEZWxlZ2F0ZShkZWxlZ2F0ZSwgY29udGV4dCkgeyB2YXIgbWV0aG9kTmFtZSA9IGNvbnRleHQubWV0aG9kLCBtZXRob2QgPSBkZWxlZ2F0ZS5pdGVyYXRvclttZXRob2ROYW1lXTsgaWYgKHVuZGVmaW5lZCA9PT0gbWV0aG9kKSByZXR1cm4gY29udGV4dC5kZWxlZ2F0ZSA9IG51bGwsICJ0aHJvdyIgPT09IG1ldGhvZE5hbWUgJiYgZGVsZWdhdGUuaXRlcmF0b3JbInJldHVybiJdICYmIChjb250ZXh0Lm1ldGhvZCA9ICJyZXR1cm4iLCBjb250ZXh0LmFyZyA9IHVuZGVmaW5lZCwgbWF5YmVJbnZva2VEZWxlZ2F0ZShkZWxlZ2F0ZSwgY29udGV4dCksICJ0aHJvdyIgPT09IGNvbnRleHQubWV0aG9kKSB8fCAicmV0dXJuIiAhPT0gbWV0aG9kTmFtZSAmJiAoY29udGV4dC5tZXRob2QgPSAidGhyb3ciLCBjb250ZXh0LmFyZyA9IG5ldyBUeXBlRXJyb3IoIlRoZSBpdGVyYXRvciBkb2VzIG5vdCBwcm92aWRlIGEgJyIgKyBtZXRob2ROYW1lICsgIicgbWV0aG9kIikpLCBDb250aW51ZVNlbnRpbmVsOyB2YXIgcmVjb3JkID0gdHJ5Q2F0Y2gobWV0aG9kLCBkZWxlZ2F0ZS5pdGVyYXRvciwgY29udGV4dC5hcmcpOyBpZiAoInRocm93IiA9PT0gcmVjb3JkLnR5cGUpIHJldHVybiBjb250ZXh0Lm1ldGhvZCA9ICJ0aHJvdyIsIGNvbnRleHQuYXJnID0gcmVjb3JkLmFyZywgY29udGV4dC5kZWxlZ2F0ZSA9IG51bGwsIENvbnRpbnVlU2VudGluZWw7IHZhciBpbmZvID0gcmVjb3JkLmFyZzsgcmV0dXJuIGluZm8gPyBpbmZvLmRvbmUgPyAoY29udGV4dFtkZWxlZ2F0ZS5yZXN1bHROYW1lXSA9IGluZm8udmFsdWUsIGNvbnRleHQubmV4dCA9IGRlbGVnYXRlLm5leHRMb2MsICJyZXR1cm4iICE9PSBjb250ZXh0Lm1ldGhvZCAmJiAoY29udGV4dC5tZXRob2QgPSAibmV4dCIsIGNvbnRleHQuYXJnID0gdW5kZWZpbmVkKSwgY29udGV4dC5kZWxlZ2F0ZSA9IG51bGwsIENvbnRpbnVlU2VudGluZWwpIDogaW5mbyA6IChjb250ZXh0Lm1ldGhvZCA9ICJ0aHJvdyIsIGNvbnRleHQuYXJnID0gbmV3IFR5cGVFcnJvcigiaXRlcmF0b3IgcmVzdWx0IGlzIG5vdCBhbiBvYmplY3QiKSwgY29udGV4dC5kZWxlZ2F0ZSA9IG51bGwsIENvbnRpbnVlU2VudGluZWwpOyB9IGZ1bmN0aW9uIHB1c2hUcnlFbnRyeShsb2NzKSB7IHZhciBlbnRyeSA9IHsgdHJ5TG9jOiBsb2NzWzBdIH07IDEgaW4gbG9jcyAmJiAoZW50cnkuY2F0Y2hMb2MgPSBsb2NzWzFdKSwgMiBpbiBsb2NzICYmIChlbnRyeS5maW5hbGx5TG9jID0gbG9jc1syXSwgZW50cnkuYWZ0ZXJMb2MgPSBsb2NzWzNdKSwgdGhpcy50cnlFbnRyaWVzLnB1c2goZW50cnkpOyB9IGZ1bmN0aW9uIHJlc2V0VHJ5RW50cnkoZW50cnkpIHsgdmFyIHJlY29yZCA9IGVudHJ5LmNvbXBsZXRpb24gfHwge307IHJlY29yZC50eXBlID0gIm5vcm1hbCIsIGRlbGV0ZSByZWNvcmQuYXJnLCBlbnRyeS5jb21wbGV0aW9uID0gcmVjb3JkOyB9IGZ1bmN0aW9uIENvbnRleHQodHJ5TG9jc0xpc3QpIHsgdGhpcy50cnlFbnRyaWVzID0gW3sgdHJ5TG9jOiAicm9vdCIgfV0sIHRyeUxvY3NMaXN0LmZvckVhY2gocHVzaFRyeUVudHJ5LCB0aGlzKSwgdGhpcy5yZXNldCghMCk7IH0gZnVuY3Rpb24gdmFsdWVzKGl0ZXJhYmxlKSB7IGlmIChpdGVyYWJsZSkgeyB2YXIgaXRlcmF0b3JNZXRob2QgPSBpdGVyYWJsZVtpdGVyYXRvclN5bWJvbF07IGlmIChpdGVyYXRvck1ldGhvZCkgcmV0dXJuIGl0ZXJhdG9yTWV0aG9kLmNhbGwoaXRlcmFibGUpOyBpZiAoImZ1bmN0aW9uIiA9PSB0eXBlb2YgaXRlcmFibGUubmV4dCkgcmV0dXJuIGl0ZXJhYmxlOyBpZiAoIWlzTmFOKGl0ZXJhYmxlLmxlbmd0aCkpIHsgdmFyIGkgPSAtMSwgbmV4dCA9IGZ1bmN0aW9uIG5leHQoKSB7IGZvciAoOyArK2kgPCBpdGVyYWJsZS5sZW5ndGg7KSB7IGlmIChoYXNPd24uY2FsbChpdGVyYWJsZSwgaSkpIHJldHVybiBuZXh0LnZhbHVlID0gaXRlcmFibGVbaV0sIG5leHQuZG9uZSA9ICExLCBuZXh0OyB9IHJldHVybiBuZXh0LnZhbHVlID0gdW5kZWZpbmVkLCBuZXh0LmRvbmUgPSAhMCwgbmV4dDsgfTsgcmV0dXJuIG5leHQubmV4dCA9IG5leHQ7IH0gfSByZXR1cm4geyBuZXh0OiBkb25lUmVzdWx0IH07IH0gZnVuY3Rpb24gZG9uZVJlc3VsdCgpIHsgcmV0dXJuIHsgdmFsdWU6IHVuZGVmaW5lZCwgZG9uZTogITAgfTsgfSByZXR1cm4gR2VuZXJhdG9yRnVuY3Rpb24ucHJvdG90eXBlID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUsIGRlZmluZVByb3BlcnR5KEdwLCAiY29uc3RydWN0b3IiLCB7IHZhbHVlOiBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSwgY29uZmlndXJhYmxlOiAhMCB9KSwgZGVmaW5lUHJvcGVydHkoR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUsICJjb25zdHJ1Y3RvciIsIHsgdmFsdWU6IEdlbmVyYXRvckZ1bmN0aW9uLCBjb25maWd1cmFibGU6ICEwIH0pLCBHZW5lcmF0b3JGdW5jdGlvbi5kaXNwbGF5TmFtZSA9IGRlZmluZShHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSwgdG9TdHJpbmdUYWdTeW1ib2wsICJHZW5lcmF0b3JGdW5jdGlvbiIpLCBleHBvcnRzLmlzR2VuZXJhdG9yRnVuY3Rpb24gPSBmdW5jdGlvbiAoZ2VuRnVuKSB7IHZhciBjdG9yID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgZ2VuRnVuICYmIGdlbkZ1bi5jb25zdHJ1Y3RvcjsgcmV0dXJuICEhY3RvciAmJiAoY3RvciA9PT0gR2VuZXJhdG9yRnVuY3Rpb24gfHwgIkdlbmVyYXRvckZ1bmN0aW9uIiA9PT0gKGN0b3IuZGlzcGxheU5hbWUgfHwgY3Rvci5uYW1lKSk7IH0sIGV4cG9ydHMubWFyayA9IGZ1bmN0aW9uIChnZW5GdW4pIHsgcmV0dXJuIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihnZW5GdW4sIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlKSA6IChnZW5GdW4uX19wcm90b19fID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUsIGRlZmluZShnZW5GdW4sIHRvU3RyaW5nVGFnU3ltYm9sLCAiR2VuZXJhdG9yRnVuY3Rpb24iKSksIGdlbkZ1bi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEdwKSwgZ2VuRnVuOyB9LCBleHBvcnRzLmF3cmFwID0gZnVuY3Rpb24gKGFyZykgeyByZXR1cm4geyBfX2F3YWl0OiBhcmcgfTsgfSwgZGVmaW5lSXRlcmF0b3JNZXRob2RzKEFzeW5jSXRlcmF0b3IucHJvdG90eXBlKSwgZGVmaW5lKEFzeW5jSXRlcmF0b3IucHJvdG90eXBlLCBhc3luY0l0ZXJhdG9yU3ltYm9sLCBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9KSwgZXhwb3J0cy5Bc3luY0l0ZXJhdG9yID0gQXN5bmNJdGVyYXRvciwgZXhwb3J0cy5hc3luYyA9IGZ1bmN0aW9uIChpbm5lckZuLCBvdXRlckZuLCBzZWxmLCB0cnlMb2NzTGlzdCwgUHJvbWlzZUltcGwpIHsgdm9pZCAwID09PSBQcm9taXNlSW1wbCAmJiAoUHJvbWlzZUltcGwgPSBQcm9taXNlKTsgdmFyIGl0ZXIgPSBuZXcgQXN5bmNJdGVyYXRvcih3cmFwKGlubmVyRm4sIG91dGVyRm4sIHNlbGYsIHRyeUxvY3NMaXN0KSwgUHJvbWlzZUltcGwpOyByZXR1cm4gZXhwb3J0cy5pc0dlbmVyYXRvckZ1bmN0aW9uKG91dGVyRm4pID8gaXRlciA6IGl0ZXIubmV4dCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgeyByZXR1cm4gcmVzdWx0LmRvbmUgPyByZXN1bHQudmFsdWUgOiBpdGVyLm5leHQoKTsgfSk7IH0sIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyhHcCksIGRlZmluZShHcCwgdG9TdHJpbmdUYWdTeW1ib2wsICJHZW5lcmF0b3IiKSwgZGVmaW5lKEdwLCBpdGVyYXRvclN5bWJvbCwgZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSksIGRlZmluZShHcCwgInRvU3RyaW5nIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gIltvYmplY3QgR2VuZXJhdG9yXSI7IH0pLCBleHBvcnRzLmtleXMgPSBmdW5jdGlvbiAodmFsKSB7IHZhciBvYmplY3QgPSBPYmplY3QodmFsKSwga2V5cyA9IFtdOyBmb3IgKHZhciBrZXkgaW4gb2JqZWN0KSB7IGtleXMucHVzaChrZXkpOyB9IHJldHVybiBrZXlzLnJldmVyc2UoKSwgZnVuY3Rpb24gbmV4dCgpIHsgZm9yICg7IGtleXMubGVuZ3RoOykgeyB2YXIga2V5ID0ga2V5cy5wb3AoKTsgaWYgKGtleSBpbiBvYmplY3QpIHJldHVybiBuZXh0LnZhbHVlID0ga2V5LCBuZXh0LmRvbmUgPSAhMSwgbmV4dDsgfSByZXR1cm4gbmV4dC5kb25lID0gITAsIG5leHQ7IH07IH0sIGV4cG9ydHMudmFsdWVzID0gdmFsdWVzLCBDb250ZXh0LnByb3RvdHlwZSA9IHsgY29uc3RydWN0b3I6IENvbnRleHQsIHJlc2V0OiBmdW5jdGlvbiByZXNldChza2lwVGVtcFJlc2V0KSB7IGlmICh0aGlzLnByZXYgPSAwLCB0aGlzLm5leHQgPSAwLCB0aGlzLnNlbnQgPSB0aGlzLl9zZW50ID0gdW5kZWZpbmVkLCB0aGlzLmRvbmUgPSAhMSwgdGhpcy5kZWxlZ2F0ZSA9IG51bGwsIHRoaXMubWV0aG9kID0gIm5leHQiLCB0aGlzLmFyZyA9IHVuZGVmaW5lZCwgdGhpcy50cnlFbnRyaWVzLmZvckVhY2gocmVzZXRUcnlFbnRyeSksICFza2lwVGVtcFJlc2V0KSBmb3IgKHZhciBuYW1lIGluIHRoaXMpIHsgInQiID09PSBuYW1lLmNoYXJBdCgwKSAmJiBoYXNPd24uY2FsbCh0aGlzLCBuYW1lKSAmJiAhaXNOYU4oK25hbWUuc2xpY2UoMSkpICYmICh0aGlzW25hbWVdID0gdW5kZWZpbmVkKTsgfSB9LCBzdG9wOiBmdW5jdGlvbiBzdG9wKCkgeyB0aGlzLmRvbmUgPSAhMDsgdmFyIHJvb3RSZWNvcmQgPSB0aGlzLnRyeUVudHJpZXNbMF0uY29tcGxldGlvbjsgaWYgKCJ0aHJvdyIgPT09IHJvb3RSZWNvcmQudHlwZSkgdGhyb3cgcm9vdFJlY29yZC5hcmc7IHJldHVybiB0aGlzLnJ2YWw7IH0sIGRpc3BhdGNoRXhjZXB0aW9uOiBmdW5jdGlvbiBkaXNwYXRjaEV4Y2VwdGlvbihleGNlcHRpb24pIHsgaWYgKHRoaXMuZG9uZSkgdGhyb3cgZXhjZXB0aW9uOyB2YXIgY29udGV4dCA9IHRoaXM7IGZ1bmN0aW9uIGhhbmRsZShsb2MsIGNhdWdodCkgeyByZXR1cm4gcmVjb3JkLnR5cGUgPSAidGhyb3ciLCByZWNvcmQuYXJnID0gZXhjZXB0aW9uLCBjb250ZXh0Lm5leHQgPSBsb2MsIGNhdWdodCAmJiAoY29udGV4dC5tZXRob2QgPSAibmV4dCIsIGNvbnRleHQuYXJnID0gdW5kZWZpbmVkKSwgISFjYXVnaHQ7IH0gZm9yICh2YXIgaSA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkgeyB2YXIgZW50cnkgPSB0aGlzLnRyeUVudHJpZXNbaV0sIHJlY29yZCA9IGVudHJ5LmNvbXBsZXRpb247IGlmICgicm9vdCIgPT09IGVudHJ5LnRyeUxvYykgcmV0dXJuIGhhbmRsZSgiZW5kIik7IGlmIChlbnRyeS50cnlMb2MgPD0gdGhpcy5wcmV2KSB7IHZhciBoYXNDYXRjaCA9IGhhc093bi5jYWxsKGVudHJ5LCAiY2F0Y2hMb2MiKSwgaGFzRmluYWxseSA9IGhhc093bi5jYWxsKGVudHJ5LCAiZmluYWxseUxvYyIpOyBpZiAoaGFzQ2F0Y2ggJiYgaGFzRmluYWxseSkgeyBpZiAodGhpcy5wcmV2IDwgZW50cnkuY2F0Y2hMb2MpIHJldHVybiBoYW5kbGUoZW50cnkuY2F0Y2hMb2MsICEwKTsgaWYgKHRoaXMucHJldiA8IGVudHJ5LmZpbmFsbHlMb2MpIHJldHVybiBoYW5kbGUoZW50cnkuZmluYWxseUxvYyk7IH0gZWxzZSBpZiAoaGFzQ2F0Y2gpIHsgaWYgKHRoaXMucHJldiA8IGVudHJ5LmNhdGNoTG9jKSByZXR1cm4gaGFuZGxlKGVudHJ5LmNhdGNoTG9jLCAhMCk7IH0gZWxzZSB7IGlmICghaGFzRmluYWxseSkgdGhyb3cgbmV3IEVycm9yKCJ0cnkgc3RhdGVtZW50IHdpdGhvdXQgY2F0Y2ggb3IgZmluYWxseSIpOyBpZiAodGhpcy5wcmV2IDwgZW50cnkuZmluYWxseUxvYykgcmV0dXJuIGhhbmRsZShlbnRyeS5maW5hbGx5TG9jKTsgfSB9IH0gfSwgYWJydXB0OiBmdW5jdGlvbiBhYnJ1cHQodHlwZSwgYXJnKSB7IGZvciAodmFyIGkgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHsgdmFyIGVudHJ5ID0gdGhpcy50cnlFbnRyaWVzW2ldOyBpZiAoZW50cnkudHJ5TG9jIDw9IHRoaXMucHJldiAmJiBoYXNPd24uY2FsbChlbnRyeSwgImZpbmFsbHlMb2MiKSAmJiB0aGlzLnByZXYgPCBlbnRyeS5maW5hbGx5TG9jKSB7IHZhciBmaW5hbGx5RW50cnkgPSBlbnRyeTsgYnJlYWs7IH0gfSBmaW5hbGx5RW50cnkgJiYgKCJicmVhayIgPT09IHR5cGUgfHwgImNvbnRpbnVlIiA9PT0gdHlwZSkgJiYgZmluYWxseUVudHJ5LnRyeUxvYyA8PSBhcmcgJiYgYXJnIDw9IGZpbmFsbHlFbnRyeS5maW5hbGx5TG9jICYmIChmaW5hbGx5RW50cnkgPSBudWxsKTsgdmFyIHJlY29yZCA9IGZpbmFsbHlFbnRyeSA/IGZpbmFsbHlFbnRyeS5jb21wbGV0aW9uIDoge307IHJldHVybiByZWNvcmQudHlwZSA9IHR5cGUsIHJlY29yZC5hcmcgPSBhcmcsIGZpbmFsbHlFbnRyeSA/ICh0aGlzLm1ldGhvZCA9ICJuZXh0IiwgdGhpcy5uZXh0ID0gZmluYWxseUVudHJ5LmZpbmFsbHlMb2MsIENvbnRpbnVlU2VudGluZWwpIDogdGhpcy5jb21wbGV0ZShyZWNvcmQpOyB9LCBjb21wbGV0ZTogZnVuY3Rpb24gY29tcGxldGUocmVjb3JkLCBhZnRlckxvYykgeyBpZiAoInRocm93IiA9PT0gcmVjb3JkLnR5cGUpIHRocm93IHJlY29yZC5hcmc7IHJldHVybiAiYnJlYWsiID09PSByZWNvcmQudHlwZSB8fCAiY29udGludWUiID09PSByZWNvcmQudHlwZSA/IHRoaXMubmV4dCA9IHJlY29yZC5hcmcgOiAicmV0dXJuIiA9PT0gcmVjb3JkLnR5cGUgPyAodGhpcy5ydmFsID0gdGhpcy5hcmcgPSByZWNvcmQuYXJnLCB0aGlzLm1ldGhvZCA9ICJyZXR1cm4iLCB0aGlzLm5leHQgPSAiZW5kIikgOiAibm9ybWFsIiA9PT0gcmVjb3JkLnR5cGUgJiYgYWZ0ZXJMb2MgJiYgKHRoaXMubmV4dCA9IGFmdGVyTG9jKSwgQ29udGludWVTZW50aW5lbDsgfSwgZmluaXNoOiBmdW5jdGlvbiBmaW5pc2goZmluYWxseUxvYykgeyBmb3IgKHZhciBpID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7IHZhciBlbnRyeSA9IHRoaXMudHJ5RW50cmllc1tpXTsgaWYgKGVudHJ5LmZpbmFsbHlMb2MgPT09IGZpbmFsbHlMb2MpIHJldHVybiB0aGlzLmNvbXBsZXRlKGVudHJ5LmNvbXBsZXRpb24sIGVudHJ5LmFmdGVyTG9jKSwgcmVzZXRUcnlFbnRyeShlbnRyeSksIENvbnRpbnVlU2VudGluZWw7IH0gfSwgImNhdGNoIjogZnVuY3Rpb24gX2NhdGNoKHRyeUxvYykgeyBmb3IgKHZhciBpID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7IHZhciBlbnRyeSA9IHRoaXMudHJ5RW50cmllc1tpXTsgaWYgKGVudHJ5LnRyeUxvYyA9PT0gdHJ5TG9jKSB7IHZhciByZWNvcmQgPSBlbnRyeS5jb21wbGV0aW9uOyBpZiAoInRocm93IiA9PT0gcmVjb3JkLnR5cGUpIHsgdmFyIHRocm93biA9IHJlY29yZC5hcmc7IHJlc2V0VHJ5RW50cnkoZW50cnkpOyB9IHJldHVybiB0aHJvd247IH0gfSB0aHJvdyBuZXcgRXJyb3IoImlsbGVnYWwgY2F0Y2ggYXR0ZW1wdCIpOyB9LCBkZWxlZ2F0ZVlpZWxkOiBmdW5jdGlvbiBkZWxlZ2F0ZVlpZWxkKGl0ZXJhYmxlLCByZXN1bHROYW1lLCBuZXh0TG9jKSB7IHJldHVybiB0aGlzLmRlbGVnYXRlID0geyBpdGVyYXRvcjogdmFsdWVzKGl0ZXJhYmxlKSwgcmVzdWx0TmFtZTogcmVzdWx0TmFtZSwgbmV4dExvYzogbmV4dExvYyB9LCAibmV4dCIgPT09IHRoaXMubWV0aG9kICYmICh0aGlzLmFyZyA9IHVuZGVmaW5lZCksIENvbnRpbnVlU2VudGluZWw7IH0gfSwgZXhwb3J0czsgfQpmdW5jdGlvbiBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIGtleSwgYXJnKSB7IHRyeSB7IHZhciBpbmZvID0gZ2VuW2tleV0oYXJnKTsgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsgfSBjYXRjaCAoZXJyb3IpIHsgcmVqZWN0KGVycm9yKTsgcmV0dXJuOyB9IGlmIChpbmZvLmRvbmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0gZWxzZSB7IFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTsgfSB9CmZ1bmN0aW9uIF9hc3luY1RvR2VuZXJhdG9yKGZuKSB7IHJldHVybiBmdW5jdGlvbiAoKSB7IHZhciBzZWxmID0gdGhpcywgYXJncyA9IGFyZ3VtZW50czsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdmFyIGdlbiA9IGZuLmFwcGx5KHNlbGYsIGFyZ3MpOyBmdW5jdGlvbiBfbmV4dCh2YWx1ZSkgeyBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJuZXh0IiwgdmFsdWUpOyB9IGZ1bmN0aW9uIF90aHJvdyhlcnIpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAidGhyb3ciLCBlcnIpOyB9IF9uZXh0KHVuZGVmaW5lZCk7IH0pOyB9OyB9CmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBlbnVtZXJhYmxlT25seSAmJiAoc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7IH0pKSwga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBudWxsICE9IGFyZ3VtZW50c1tpXSA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpICUgMiA/IG93bktleXMoT2JqZWN0KHNvdXJjZSksICEwKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7IH0pIDogT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpIDogb3duS2V5cyhPYmplY3Qoc291cmNlKSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSByZXR1cm4gdGFyZ2V0OyB9CmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsga2V5ID0gX3RvUHJvcGVydHlLZXkoa2V5KTsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9CmZ1bmN0aW9uIF90b1Byb3BlcnR5S2V5KGFyZykgeyB2YXIga2V5ID0gX3RvUHJpbWl0aXZlKGFyZywgInN0cmluZyIpOyByZXR1cm4gX3R5cGVvZihrZXkpID09PSAic3ltYm9sIiA/IGtleSA6IFN0cmluZyhrZXkpOyB9CmZ1bmN0aW9uIF90b1ByaW1pdGl2ZShpbnB1dCwgaGludCkgeyBpZiAoX3R5cGVvZihpbnB1dCkgIT09ICJvYmplY3QiIHx8IGlucHV0ID09PSBudWxsKSByZXR1cm4gaW5wdXQ7IHZhciBwcmltID0gaW5wdXRbU3ltYm9sLnRvUHJpbWl0aXZlXTsgaWYgKHByaW0gIT09IHVuZGVmaW5lZCkgeyB2YXIgcmVzID0gcHJpbS5jYWxsKGlucHV0LCBoaW50IHx8ICJkZWZhdWx0Iik7IGlmIChfdHlwZW9mKHJlcykgIT09ICJvYmplY3QiKSByZXR1cm4gcmVzOyB0aHJvdyBuZXcgVHlwZUVycm9yKCJAQHRvUHJpbWl0aXZlIG11c3QgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlLiIpOyB9IHJldHVybiAoaGludCA9PT0gInN0cmluZyIgPyBTdHJpbmcgOiBOdW1iZXIpKGlucHV0KTsgfQppbXBvcnQgXyBmcm9tICdsb2Rhc2gnOwppbXBvcnQgcXVlcnlTdHJpbmcgZnJvbSAncXVlcnktc3RyaW5nJzsKaW1wb3J0IGdsQWNjb3VudEFwaSBmcm9tICdhcGkvc2VydmljZXMvR2xBY2NvdW50QXBpJzsKaW1wb3J0IHByb2R1Y3RHcm91cEFwaSBmcm9tICdhcGkvc2VydmljZXMvUHJvZHVjdEdyb3VwQXBpJzsKaW1wb3J0IHVzZXJBcGkgZnJvbSAnYXBpL3NlcnZpY2VzL1VzZXJBcGknOwppbXBvcnQgYXBpQ2xpZW50IGZyb20gJ3V0aWxzL2FwaUNsaWVudCc7CmltcG9ydCBzcGxpdFRyYW5zbGF0aW9uIGZyb20gJ3V0aWxzL3RyYW5zbGF0aW9uLXV0aWxzJzsKZXhwb3J0IHZhciBkZWJvdW5jZVBlb3BsZUZldGNoID0gZnVuY3Rpb24gZGVib3VuY2VQZW9wbGVGZXRjaCh3YWl0VGltZSwgbWluU2VhcmNoTGVuZ3RoKSB7CiAgcmV0dXJuIF8uZGVib3VuY2UoZnVuY3Rpb24gKHNlYXJjaFRlcm0sIGNhbGxiYWNrKSB7CiAgICBpZiAoc2VhcmNoVGVybSAmJiBzZWFyY2hUZXJtLmxlbmd0aCA+PSBtaW5TZWFyY2hMZW5ndGgpIHsKICAgICAgYXBpQ2xpZW50LmdldCgnL29wZW5ib3hlcy9hcGkvcGVyc29ucycsIHsKICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgIG5hbWU6IHNlYXJjaFRlcm0sCiAgICAgICAgICBzdGF0dXM6IHRydWUKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgIHJldHVybiBjYWxsYmFjayhfLm1hcChyZXN1bHQuZGF0YS5kYXRhLCBmdW5jdGlvbiAob2JqKSB7CiAgICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBvYmopLCB7fSwgewogICAgICAgICAgICB2YWx1ZTogb2JqLmlkLAogICAgICAgICAgICBsYWJlbDogb2JqLm5hbWUKICAgICAgICAgIH0pOwogICAgICAgIH0pKTsKICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBjYWxsYmFjayhbXSk7CiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgY2FsbGJhY2soW10pOwogICAgfQogIH0sIHdhaXRUaW1lKTsKfTsKZXhwb3J0IHZhciBkZWJvdW5jZVVzZXJzRmV0Y2ggPSBmdW5jdGlvbiBkZWJvdW5jZVVzZXJzRmV0Y2god2FpdFRpbWUsIG1pblNlYXJjaExlbmd0aCkgewogIHJldHVybiBfLmRlYm91bmNlKGZ1bmN0aW9uIChzZWFyY2hUZXJtLCBjYWxsYmFjaykgewogICAgaWYgKChzZWFyY2hUZXJtID09PSBudWxsIHx8IHNlYXJjaFRlcm0gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHNlYXJjaFRlcm0ubGVuZ3RoKSA+PSBtaW5TZWFyY2hMZW5ndGgpIHsKICAgICAgdmFyIGNvbmZpZyA9IHsKICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgIHNlYXJjaFRlcm06IHNlYXJjaFRlcm0sCiAgICAgICAgICBhY3RpdmU6IHRydWUKICAgICAgICB9CiAgICAgIH07CiAgICAgIHVzZXJBcGkuZ2V0VXNlcnNPcHRpb25zKGNvbmZpZykudGhlbihmdW5jdGlvbiAodXNlcnMpIHsKICAgICAgICB2YXIgX3VzZXJzJGRhdGEsIF91c2VycyRkYXRhJGRhdGEsIF91c2VycyRkYXRhJGRhdGEkbWFwOwogICAgICAgIGNhbGxiYWNrKHVzZXJzID09PSBudWxsIHx8IHVzZXJzID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX3VzZXJzJGRhdGEgPSB1c2Vycy5kYXRhKSA9PT0gbnVsbCB8fCBfdXNlcnMkZGF0YSA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF91c2VycyRkYXRhJGRhdGEgPSBfdXNlcnMkZGF0YS5kYXRhKSA9PT0gbnVsbCB8fCBfdXNlcnMkZGF0YSRkYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX3VzZXJzJGRhdGEkZGF0YSRtYXAgPSBfdXNlcnMkZGF0YSRkYXRhLm1hcCkgPT09IG51bGwgfHwgX3VzZXJzJGRhdGEkZGF0YSRtYXAgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF91c2VycyRkYXRhJGRhdGEkbWFwLmNhbGwoX3VzZXJzJGRhdGEkZGF0YSwgZnVuY3Rpb24gKHVzZXIpIHsKICAgICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHVzZXIpLCB7fSwgewogICAgICAgICAgICB2YWx1ZTogdXNlci5pZCwKICAgICAgICAgICAgbGFiZWw6IHVzZXIubmFtZQogICAgICAgICAgfSk7CiAgICAgICAgfSkpOwogICAgICB9KTsKICAgICAgcmV0dXJuOwogICAgfQogICAgY2FsbGJhY2soW10pOwogIH0sIHdhaXRUaW1lKTsKfTsKZXhwb3J0IHZhciBkZWJvdW5jZUxvY2F0aW9uc0ZldGNoID0gZnVuY3Rpb24gZGVib3VuY2VMb2NhdGlvbnNGZXRjaCh3YWl0VGltZSwgbWluU2VhcmNoTGVuZ3RoLCBhY3Rpdml0eUNvZGVzKSB7CiAgdmFyIGZldGNoQWxsID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiBmYWxzZTsKICB2YXIgd2l0aE9yZ0NvZGUgPSBhcmd1bWVudHMubGVuZ3RoID4gNCAmJiBhcmd1bWVudHNbNF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1s0XSA6IGZhbHNlOwogIHZhciB3aXRoVHlwZURlc2NyaXB0aW9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDUgJiYgYXJndW1lbnRzWzVdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNV0gOiB0cnVlOwogIHZhciBpc1JldHVybk9yZGVyID0gYXJndW1lbnRzLmxlbmd0aCA+IDYgJiYgYXJndW1lbnRzWzZdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNl0gOiBmYWxzZTsKICByZXR1cm4gXy5kZWJvdW5jZShmdW5jdGlvbiAoc2VhcmNoVGVybSwgY2FsbGJhY2spIHsKICAgIGlmIChzZWFyY2hUZXJtICYmIHNlYXJjaFRlcm0ubGVuZ3RoID49IG1pblNlYXJjaExlbmd0aCkgewogICAgICB2YXIgYWN0aXZpdHlDb2Rlc1BhcmFtcyA9IGFjdGl2aXR5Q29kZXMgPyBhY3Rpdml0eUNvZGVzLm1hcChmdW5jdGlvbiAoYWN0aXZpdHlDb2RlKSB7CiAgICAgICAgcmV0dXJuICImYWN0aXZpdHlDb2Rlcz0iLmNvbmNhdChhY3Rpdml0eUNvZGUpOwogICAgICB9KS5qb2luKCcnKSA6ICcnOwogICAgICB2YXIgX3F1ZXJ5U3RyaW5nJHBhcnNlID0gcXVlcnlTdHJpbmcucGFyc2Uod2luZG93LmxvY2F0aW9uLnNlYXJjaCksCiAgICAgICAgZGlyZWN0aW9uID0gX3F1ZXJ5U3RyaW5nJHBhcnNlLmRpcmVjdGlvbjsKICAgICAgdmFyIGRpcmVjdGlvblBhcmFtID0gZmV0Y2hBbGwgPyBudWxsIDogZGlyZWN0aW9uOwogICAgICBhcGlDbGllbnQuZ2V0KCIvb3BlbmJveGVzL2FwaS9sb2NhdGlvbnM/bmFtZT0iLmNvbmNhdChzZWFyY2hUZXJtKS5jb25jYXQoZGlyZWN0aW9uUGFyYW0gPyAiJmRpcmVjdGlvbj0iLmNvbmNhdChkaXJlY3Rpb25QYXJhbSkgOiAnJykuY29uY2F0KGFjdGl2aXR5Q29kZXNQYXJhbXMpLmNvbmNhdChpc1JldHVybk9yZGVyID8gJyZpc1JldHVybk9yZGVyPXRydWUnIDogJycpKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICByZXR1cm4gY2FsbGJhY2soXy5tYXAocmVzdWx0LmRhdGEuZGF0YSwgZnVuY3Rpb24gKG9iaikgewogICAgICAgICAgdmFyIGxvY2F0aW9uVHlwZSA9IHdpdGhUeXBlRGVzY3JpcHRpb24gPyAiIFsiLmNvbmNhdChvYmoubG9jYXRpb25UeXBlLmRlc2NyaXB0aW9uLCAiXSIpIDogJyc7CiAgICAgICAgICB2YXIgbGFiZWwgPSAiIi5jb25jYXQob2JqLm5hbWUpLmNvbmNhdChsb2NhdGlvblR5cGUpOwogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgaWQ6IG9iai5pZCwKICAgICAgICAgICAgdHlwZTogb2JqLmxvY2F0aW9uVHlwZS5sb2NhdGlvblR5cGVDb2RlLAogICAgICAgICAgICBuYW1lOiBvYmoubmFtZSwKICAgICAgICAgICAgc3VwcG9ydGVkQWN0aXZpdGllczogb2JqLnN1cHBvcnRlZEFjdGl2aXRpZXMsCiAgICAgICAgICAgIGxhYmVsOiB3aXRoT3JnQ29kZSA/ICIiLmNvbmNhdChvYmoub3JnYW5pemF0aW9uQ29kZSA/ICIiLmNvbmNhdChvYmoub3JnYW5pemF0aW9uQ29kZSwgIiAtICIpIDogJycpLmNvbmNhdChsYWJlbCkgOiBsYWJlbAogICAgICAgICAgfTsKICAgICAgICB9KSk7CiAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gY2FsbGJhY2soW10pOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIGNhbGxiYWNrKFtdKTsKICAgIH0KICB9LCB3YWl0VGltZSk7Cn07CmV4cG9ydCB2YXIgZGVib3VuY2VHbG9iYWxTZWFyY2ggPSBmdW5jdGlvbiBkZWJvdW5jZUdsb2JhbFNlYXJjaCh3YWl0VGltZSwgbWluU2VhcmNoTGVuZ3RoKSB7CiAgcmV0dXJuIF8uZGVib3VuY2UoZnVuY3Rpb24gKHNlYXJjaFRlcm0sIGNhbGxiYWNrKSB7CiAgICBpZiAoc2VhcmNoVGVybSAmJiBzZWFyY2hUZXJtLmxlbmd0aCA+PSBtaW5TZWFyY2hMZW5ndGgpIHsKICAgICAgYXBpQ2xpZW50LmdldCgiL29wZW5ib3hlcy9qc29uL2dsb2JhbFNlYXJjaD90ZXJtPSIuY29uY2F0KHNlYXJjaFRlcm0pKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICByZXR1cm4gY2FsbGJhY2soXy5tYXAocmVzdWx0LmRhdGEsIGZ1bmN0aW9uIChvYmopIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHZhbHVlOiBvYmoudXJsLAogICAgICAgICAgICB1cmw6IG9iai51cmwsCiAgICAgICAgICAgIGxhYmVsOiBvYmoubGFiZWwsCiAgICAgICAgICAgIGNvbG9yOiBvYmouY29sb3IsCiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiBvYmouZGlzcGxheU5hbWUsCiAgICAgICAgICAgIG9yaWdpbmFsTmFtZTogb2JqLnZhbHVlCiAgICAgICAgICB9OwogICAgICAgIH0pKTsKICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBjYWxsYmFjayhbXSk7CiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgY2FsbGJhY2soW10pOwogICAgfQogIH0sIHdhaXRUaW1lKTsKfTsKZXhwb3J0IHZhciBkZWJvdW5jZVByb2R1Y3RzRmV0Y2ggPSBmdW5jdGlvbiBkZWJvdW5jZVByb2R1Y3RzRmV0Y2god2FpdFRpbWUsIG1pblNlYXJjaExlbmd0aCwgbG9jYXRpb25JZCkgewogIHJldHVybiBfLmRlYm91bmNlKGZ1bmN0aW9uIChzZWFyY2hUZXJtLCBjYWxsYmFjaykgewogICAgaWYgKHNlYXJjaFRlcm0gJiYgc2VhcmNoVGVybS5sZW5ndGggPj0gbWluU2VhcmNoTGVuZ3RoKSB7CiAgICAgIGFwaUNsaWVudC5nZXQoIi9vcGVuYm94ZXMvYXBpL3Byb2R1Y3RzL3NlYXJjaD9uYW1lPSIuY29uY2F0KHNlYXJjaFRlcm0sICImcHJvZHVjdENvZGU9IikuY29uY2F0KHNlYXJjaFRlcm0sICImbG9jYXRpb24uaWQ9IikuY29uY2F0KGxvY2F0aW9uSWQpKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICByZXR1cm4gY2FsbGJhY2soXy5tYXAocmVzdWx0LmRhdGEuZGF0YSwgZnVuY3Rpb24gKG9iaikgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgdmFsdWU6IG9iai5pZCwKICAgICAgICAgICAgaWQ6IG9iai5pZCwKICAgICAgICAgICAgbmFtZTogb2JqLm5hbWUsCiAgICAgICAgICAgIHByb2R1Y3RDb2RlOiBvYmoucHJvZHVjdENvZGUsCiAgICAgICAgICAgIGhhbmRsaW5nSWNvbnM6IG9iai5oYW5kbGluZ0ljb25zLAogICAgICAgICAgICBsb3RBbmRFeHBpcnlDb250cm9sOiBvYmoubG90QW5kRXhwaXJ5Q29udHJvbCwKICAgICAgICAgICAgZGlzcGxheU5hbWU6IG9iai5kaXNwbGF5TmFtZSwKICAgICAgICAgICAgY29sb3I6IG9iai5jb2xvciwKICAgICAgICAgICAgZXhhY3RNYXRjaDogb2JqLmV4YWN0TWF0Y2gKICAgICAgICAgIH07CiAgICAgICAgfSkpOwogICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKFtdKTsKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBjYWxsYmFjayhbXSk7CiAgICB9CiAgfSwgd2FpdFRpbWUpOwp9OwpleHBvcnQgdmFyIGRlYm91bmNlQXZhaWxhYmxlSXRlbXNGZXRjaCA9IGZ1bmN0aW9uIGRlYm91bmNlQXZhaWxhYmxlSXRlbXNGZXRjaCh3YWl0VGltZSwgbWluU2VhcmNoTGVuZ3RoKSB7CiAgcmV0dXJuIF8uZGVib3VuY2UoZnVuY3Rpb24gKHNlYXJjaFRlcm0sIGNhbGxiYWNrKSB7CiAgICBpZiAoc2VhcmNoVGVybSAmJiBzZWFyY2hUZXJtLmxlbmd0aCA+PSBtaW5TZWFyY2hMZW5ndGgpIHsKICAgICAgYXBpQ2xpZW50LmdldCgiL29wZW5ib3hlcy9hcGkvcHJvZHVjdHMvc2VhcmNoP25hbWU9Ii5jb25jYXQoc2VhcmNoVGVybSwgIiZwcm9kdWN0Q29kZT0iKS5jb25jYXQoc2VhcmNoVGVybSwgIiZhdmFpbGFibGVJdGVtcz10cnVlIikpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgIHJldHVybiBjYWxsYmFjayhfLm1hcChyZXN1bHQuZGF0YS5kYXRhLCBmdW5jdGlvbiAob2JqKSB7CiAgICAgICAgICB2YXIgX29iaiRwcm9kdWN0OwogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgaWQ6IG9iai5pZCwKICAgICAgICAgICAgdmFsdWU6IG9iai5pZCwKICAgICAgICAgICAgbmFtZTogb2JqLm5hbWUsCiAgICAgICAgICAgIHByb2R1Y3RDb2RlOiBvYmoucHJvZHVjdENvZGUsCiAgICAgICAgICAgIHF1YW50aXR5QXZhaWxhYmxlOiBvYmoucXVhbnRpdHlBdmFpbGFibGUsCiAgICAgICAgICAgIG1pbkV4cGlyYXRpb25EYXRlOiBvYmoubWluRXhwaXJhdGlvbkRhdGUsCiAgICAgICAgICAgIGhhbmRsaW5nSWNvbnM6IG9iai5wcm9kdWN0LmhhbmRsaW5nSWNvbnMsCiAgICAgICAgICAgIGRpc3BsYXlOYW1lczogb2JqID09PSBudWxsIHx8IG9iaiA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9vYmokcHJvZHVjdCA9IG9iai5wcm9kdWN0KSA9PT0gbnVsbCB8fCBfb2JqJHByb2R1Y3QgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9vYmokcHJvZHVjdC5kaXNwbGF5TmFtZXMsCiAgICAgICAgICAgIGNvbG9yOiBvYmouY29sb3IKICAgICAgICAgIH07CiAgICAgICAgfSkpOwogICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKFtdKTsKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBjYWxsYmFjayhbXSk7CiAgICB9CiAgfSwgd2FpdFRpbWUpOwp9OwpleHBvcnQgdmFyIGRlYm91bmNlUHJvZHVjdHNJbk9yZGVycyA9IGZ1bmN0aW9uIGRlYm91bmNlUHJvZHVjdHNJbk9yZGVycyh3YWl0VGltZSwgbWluU2VhcmNoTGVuZ3RoLCB2ZW5kb3IsIGRlc3RpbmF0aW9uKSB7CiAgcmV0dXJuIF8uZGVib3VuY2UoZnVuY3Rpb24gKHNlYXJjaFRlcm0sIGNhbGxiYWNrKSB7CiAgICBpZiAoc2VhcmNoVGVybSAmJiBzZWFyY2hUZXJtLmxlbmd0aCA+PSBtaW5TZWFyY2hMZW5ndGgpIHsKICAgICAgYXBpQ2xpZW50LmdldCgiL29wZW5ib3hlcy9hcGkvY29tYmluZWRTaGlwbWVudEl0ZW1zL2dldFByb2R1Y3RzSW5PcmRlcnM/bmFtZT0iLmNvbmNhdChzZWFyY2hUZXJtLCAiJnZlbmRvcj0iKS5jb25jYXQodmVuZG9yLCAiJmRlc3RpbmF0aW9uPSIpLmNvbmNhdChkZXN0aW5hdGlvbikpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgIHJldHVybiBjYWxsYmFjayhfLm1hcChyZXN1bHQuZGF0YS5kYXRhLCBmdW5jdGlvbiAob2JqKSB7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICB2YWx1ZTogb2JqLmlkLAogICAgICAgICAgICBpZDogb2JqLmlkLAogICAgICAgICAgICBuYW1lOiBvYmoubmFtZSwKICAgICAgICAgICAgcHJvZHVjdENvZGU6IG9iai5wcm9kdWN0Q29kZSwKICAgICAgICAgICAgaGFuZGxpbmdJY29uczogb2JqLmhhbmRsaW5nSWNvbnMsCiAgICAgICAgICAgIGRpc3BsYXlOYW1lczogb2JqID09PSBudWxsIHx8IG9iaiA9PT0gdm9pZCAwID8gdm9pZCAwIDogb2JqLmRpc3BsYXlOYW1lcywKICAgICAgICAgICAgY29sb3I6IG9iai5jb2xvcgogICAgICAgICAgfTsKICAgICAgICB9KSk7CiAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gY2FsbGJhY2soW10pOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIGNhbGxiYWNrKFtdKTsKICAgIH0KICB9LCB3YWl0VGltZSk7Cn07CmV4cG9ydCB2YXIgZGVib3VuY2VPcmdhbml6YXRpb25zRmV0Y2ggPSBmdW5jdGlvbiBkZWJvdW5jZU9yZ2FuaXphdGlvbnNGZXRjaCh3YWl0VGltZSwgbWluU2VhcmNoTGVuZ3RoKSB7CiAgdmFyIHJvbGVUeXBlcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogWydST0xFX1NVUFBMSUVSJ107CiAgdmFyIGFjdGl2ZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAzICYmIGFyZ3VtZW50c1szXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzNdIDogZmFsc2U7CiAgcmV0dXJuIF8uZGVib3VuY2UoZnVuY3Rpb24gKHNlYXJjaFRlcm0sIGNhbGxiYWNrKSB7CiAgICBpZiAoc2VhcmNoVGVybSAmJiBzZWFyY2hUZXJtLmxlbmd0aCA+PSBtaW5TZWFyY2hMZW5ndGgpIHsKICAgICAgYXBpQ2xpZW50LmdldCgiL29wZW5ib3hlcy9hcGkvb3JnYW5pemF0aW9ucz9xPSIuY29uY2F0KHNlYXJjaFRlcm0pLmNvbmNhdChyb2xlVHlwZXMgPyByb2xlVHlwZXMubWFwKGZ1bmN0aW9uIChyb2xlVHlwZSkgewogICAgICAgIHJldHVybiAiJnJvbGVUeXBlPSIuY29uY2F0KHJvbGVUeXBlKTsKICAgICAgfSkuam9pbignJykgOiAnJywgIiZhY3RpdmU9IikuY29uY2F0KGFjdGl2ZSkpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgIHJldHVybiBjYWxsYmFjayhfLm1hcChyZXN1bHQuZGF0YS5kYXRhLCBmdW5jdGlvbiAob2JqKSB7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICB2YWx1ZTogb2JqLmlkLAogICAgICAgICAgICBpZDogb2JqLmlkLAogICAgICAgICAgICBuYW1lOiBvYmoubmFtZSwKICAgICAgICAgICAgbGFiZWw6ICIiLmNvbmNhdChvYmouY29kZSwgIiAiKS5jb25jYXQob2JqLm5hbWUpCiAgICAgICAgICB9OwogICAgICAgIH0pKTsKICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBjYWxsYmFjayhbXSk7CiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgY2FsbGJhY2soW10pOwogICAgfQogIH0sIHdhaXRUaW1lKTsKfTsKZXhwb3J0IHZhciBkZWJvdW5jZUxvY2F0aW9uR3JvdXBzRmV0Y2ggPSBmdW5jdGlvbiBkZWJvdW5jZUxvY2F0aW9uR3JvdXBzRmV0Y2god2FpdFRpbWUsIG1pblNlYXJjaExlbmd0aCkgewogIHJldHVybiBfLmRlYm91bmNlKGZ1bmN0aW9uIChzZWFyY2hUZXJtLCBjYWxsYmFjaykgewogICAgaWYgKHNlYXJjaFRlcm0gJiYgc2VhcmNoVGVybS5sZW5ndGggPj0gbWluU2VhcmNoTGVuZ3RoKSB7CiAgICAgIGFwaUNsaWVudC5nZXQoIi9vcGVuYm94ZXMvYXBpL2xvY2F0aW9uR3JvdXBzP3E9Ii5jb25jYXQoc2VhcmNoVGVybSkpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgIHJldHVybiBjYWxsYmFjayhfLm1hcChyZXN1bHQuZGF0YS5kYXRhLCBmdW5jdGlvbiAob2JqKSB7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBpZDogb2JqLmlkLAogICAgICAgICAgICB2YWx1ZTogb2JqLmlkLAogICAgICAgICAgICBuYW1lOiBvYmoubmFtZSwKICAgICAgICAgICAgbGFiZWw6ICIiLmNvbmNhdChvYmoubmFtZSkKICAgICAgICAgIH07CiAgICAgICAgfSkpOwogICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKFtdKTsKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBjYWxsYmFjayhbXSk7CiAgICB9CiAgfSwgd2FpdFRpbWUpOwp9OwpleHBvcnQgdmFyIG9yZ2FuaXphdGlvbnNGZXRjaCA9IGZ1bmN0aW9uIG9yZ2FuaXphdGlvbnNGZXRjaCgpIHsKICB2YXIgcm9sZVR5cGVzID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBbJ1JPTEVfU1VQUExJRVInXTsKICB2YXIgYWN0aXZlID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBmYWxzZTsKICByZXR1cm4gYXBpQ2xpZW50LmdldCgiL29wZW5ib3hlcy9hcGkvb3JnYW5pemF0aW9ucz8iLmNvbmNhdChyb2xlVHlwZXMgPyByb2xlVHlwZXMubWFwKGZ1bmN0aW9uIChyb2xlVHlwZSkgewogICAgcmV0dXJuICImcm9sZVR5cGU9Ii5jb25jYXQocm9sZVR5cGUpOwogIH0pLmpvaW4oJycpIDogJycsICImYWN0aXZlPSIpLmNvbmNhdChhY3RpdmUpKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgIGlmIChyZXMuZGF0YS5kYXRhKSB7CiAgICAgIHJldHVybiByZXMuZGF0YS5kYXRhLm1hcChmdW5jdGlvbiAob2JqKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGlkOiBvYmouaWQsCiAgICAgICAgICB2YWx1ZTogb2JqLmlkLAogICAgICAgICAgbmFtZTogb2JqLm5hbWUsCiAgICAgICAgICBsYWJlbDogIiIuY29uY2F0KG9iai5uYW1lKQogICAgICAgIH07CiAgICAgIH0pOwogICAgfQogICAgcmV0dXJuIG51bGw7CiAgfSk7Cn07CmV4cG9ydCB2YXIgZmV0Y2hVc2VyQnlJZCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgdmFyIF9yZWYgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoaWQpIHsKICAgIHZhciBfcmVzcG9uc2UkZGF0YTsKICAgIHZhciByZXNwb25zZTsKICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgIHJldHVybiBhcGlDbGllbnQoIi9vcGVuYm94ZXMvYXBpL2dlbmVyaWMvcGVyc29uLyIuY29uY2F0KGlkKSk7CiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgKF9yZXNwb25zZSRkYXRhID0gcmVzcG9uc2UuZGF0YSkgPT09IG51bGwgfHwgX3Jlc3BvbnNlJGRhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9yZXNwb25zZSRkYXRhLmRhdGEpOwogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUpOwogIH0pKTsKICByZXR1cm4gZnVuY3Rpb24gZmV0Y2hVc2VyQnlJZChfeCkgewogICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCk7CmV4cG9ydCB2YXIgZmV0Y2hMb2NhdGlvbkJ5SWQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIHZhciBfcmVmMiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoaWQpIHsKICAgIHZhciBfcmVzcG9uc2UkZGF0YTI7CiAgICB2YXIgcmVzcG9uc2U7CiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI7CiAgICAgICAgICAgIHJldHVybiBhcGlDbGllbnQoIi9vcGVuYm94ZXMvYXBpL2xvY2F0aW9ucy8iLmNvbmNhdChpZCkpOwogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgKF9yZXNwb25zZSRkYXRhMiA9IHJlc3BvbnNlLmRhdGEpID09PSBudWxsIHx8IF9yZXNwb25zZSRkYXRhMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3Jlc3BvbnNlJGRhdGEyLmRhdGEpOwogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlMik7CiAgfSkpOwogIHJldHVybiBmdW5jdGlvbiBmZXRjaExvY2F0aW9uQnlJZChfeDIpIHsKICAgIHJldHVybiBfcmVmMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH07Cn0oKTsKZXhwb3J0IHZhciBmZXRjaFByb2R1Y3RzQ2F0ZWdvcmllcyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgdmFyIF9yZWYzID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMygpIHsKICAgIHZhciByZXNwb25zZTsKICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMjsKICAgICAgICAgICAgcmV0dXJuIGFwaUNsaWVudC5nZXQoJy9vcGVuYm94ZXMvYXBpL2NhdGVnb3J5T3B0aW9ucycpOwogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0My5zZW50OwogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIiwgcmVzcG9uc2UuZGF0YS5kYXRhKTsKICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTMpOwogIH0pKTsKICByZXR1cm4gZnVuY3Rpb24gZmV0Y2hQcm9kdWN0c0NhdGVnb3JpZXMoKSB7CiAgICByZXR1cm4gX3JlZjMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCk7CmV4cG9ydCB2YXIgZmV0Y2hQcm9kdWN0c0NhdGFsb2dzID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICB2YXIgX3JlZjQgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KCkgewogICAgdmFyIHJlc3BvbnNlOwogICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAyOwogICAgICAgICAgICByZXR1cm4gYXBpQ2xpZW50LmdldCgnL29wZW5ib3hlcy9hcGkvY2F0YWxvZ09wdGlvbnMnKTsKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDQuc2VudDsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIsIHJlc3BvbnNlLmRhdGEuZGF0YSk7CiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWU0KTsKICB9KSk7CiAgcmV0dXJuIGZ1bmN0aW9uIGZldGNoUHJvZHVjdHNDYXRhbG9ncygpIHsKICAgIHJldHVybiBfcmVmNC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH07Cn0oKTsKZXhwb3J0IHZhciBmZXRjaFByb2R1Y3RzVGFncyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgdmFyIF9yZWY1ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlNSgpIHsKICAgIHZhciByZXNwb25zZTsKICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMjsKICAgICAgICAgICAgcmV0dXJuIGFwaUNsaWVudC5nZXQoJy9vcGVuYm94ZXMvYXBpL3RhZ09wdGlvbnMnKTsKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDUuc2VudDsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5hYnJ1cHQoInJldHVybiIsIHJlc3BvbnNlLmRhdGEuZGF0YSk7CiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWU1KTsKICB9KSk7CiAgcmV0dXJuIGZ1bmN0aW9uIGZldGNoUHJvZHVjdHNUYWdzKCkgewogICAgcmV0dXJuIF9yZWY1LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpOwpleHBvcnQgdmFyIGZldGNoUHJvZHVjdHNHbEFjY291bnRzID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICB2YXIgX3JlZjYgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KHBhcmFtcykgewogICAgdmFyIF95aWVsZCRnbEFjY291bnRBcGkkZywgZGF0YTsKICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlNiQoX2NvbnRleHQ2KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMjsKICAgICAgICAgICAgcmV0dXJuIGdsQWNjb3VudEFwaS5nZXRHbEFjY291bnRPcHRpb25zKHsKICAgICAgICAgICAgICBwYXJhbXM6IHBhcmFtcwogICAgICAgICAgICB9KTsKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgX3lpZWxkJGdsQWNjb3VudEFwaSRnID0gX2NvbnRleHQ2LnNlbnQ7CiAgICAgICAgICAgIGRhdGEgPSBfeWllbGQkZ2xBY2NvdW50QXBpJGcuZGF0YTsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoInJldHVybiIsIGRhdGEuZGF0YSk7CiAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWU2KTsKICB9KSk7CiAgcmV0dXJuIGZ1bmN0aW9uIGZldGNoUHJvZHVjdHNHbEFjY291bnRzKF94MykgewogICAgcmV0dXJuIF9yZWY2LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpOwpleHBvcnQgdmFyIGZldGNoUHJvZHVjdEdyb3VwcyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgdmFyIF9yZWY3ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlNygpIHsKICAgIHZhciBfeWllbGQkcHJvZHVjdEdyb3VwQXAsIGRhdGE7CiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTckKF9jb250ZXh0NykgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDI7CiAgICAgICAgICAgIHJldHVybiBwcm9kdWN0R3JvdXBBcGkuZ2V0UHJvZHVjdEdyb3Vwc09wdGlvbnMoKTsKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgX3lpZWxkJHByb2R1Y3RHcm91cEFwID0gX2NvbnRleHQ3LnNlbnQ7CiAgICAgICAgICAgIGRhdGEgPSBfeWllbGQkcHJvZHVjdEdyb3VwQXAuZGF0YTsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5hYnJ1cHQoInJldHVybiIsIGRhdGEuZGF0YSk7CiAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWU3KTsKICB9KSk7CiAgcmV0dXJuIGZ1bmN0aW9uIGZldGNoUHJvZHVjdEdyb3VwcygpIHsKICAgIHJldHVybiBfcmVmNy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH07Cn0oKTsKdmFyIG1hcFNoaXBtZW50VHlwZSA9IGZ1bmN0aW9uIG1hcFNoaXBtZW50VHlwZShzaGlwbWVudFR5cGUpIHsKICB2YXIgX3NwbGl0VHJhbnNsYXRpb247CiAgLy8gRW51bSBrZXlzIGNhbiBiZSBlLmcuIEFJUiwgTEFORCwgU0VBIGV0Yy4KICB2YXIgZW51bUtleSA9IChfc3BsaXRUcmFuc2xhdGlvbiA9IHNwbGl0VHJhbnNsYXRpb24oc2hpcG1lbnRUeXBlID09PSBudWxsIHx8IHNoaXBtZW50VHlwZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogc2hpcG1lbnRUeXBlLm5hbWUsIG51bGwpKSA9PT0gbnVsbCB8fCBfc3BsaXRUcmFuc2xhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3NwbGl0VHJhbnNsYXRpb24udG9VcHBlckNhc2UoKTsKICByZXR1cm4gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBzaGlwbWVudFR5cGUpLCB7fSwgewogICAgdmFsdWU6IHNoaXBtZW50VHlwZSA9PT0gbnVsbCB8fCBzaGlwbWVudFR5cGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHNoaXBtZW50VHlwZS5pZCwKICAgIGVudW1LZXk6IGVudW1LZXkKICB9KTsKfTsKCi8vIFNoaXBtZW50IHR5cGVzIGFyZyBjYW4gYmUgYW4gYXJyYXkgb3IgYSBzaW5nbGUgZWxlbWVudCAocGFzc2VkIGZyb20gdGFibGUgY2VsbCkKZXhwb3J0IHZhciBtYXBTaGlwbWVudFR5cGVzID0gZnVuY3Rpb24gbWFwU2hpcG1lbnRUeXBlcyhzaGlwbWVudFR5cGVzKSB7CiAgaWYgKF8uaXNBcnJheShzaGlwbWVudFR5cGVzKSkgewogICAgcmV0dXJuIHNoaXBtZW50VHlwZXMubWFwKGZ1bmN0aW9uIChzaGlwbWVudFR5cGUpIHsKICAgICAgcmV0dXJuIG1hcFNoaXBtZW50VHlwZShzaGlwbWVudFR5cGUpOwogICAgfSk7CiAgfQogIHJldHVybiBtYXBTaGlwbWVudFR5cGUoc2hpcG1lbnRUeXBlcyk7Cn07CmV4cG9ydCB2YXIgc2VsZWN0TnVsbE9wdGlvbiA9IHsKICBpZDogJ251bGwnLAogIHZhbHVlOiAnbnVsbCcKfTs="},null]}