{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{393:function(e,t,a){\"use strict\";var n=a(0),r=a.n(n),o=a(1),i=a.n(o),s=[\"fieldRef\",\"onChange\",\"className\",\"arrowLeft\",\"arrowUp\",\"arrowRight\",\"arrowDown\",\"copyDown\",\"onTabPress\",\"isFormElement\"];function u(){return(u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var c=function(e){var t=e.fieldRef,a=e.onChange,n=e.className,o=void 0===n?\"\":n,i=e.arrowLeft,c=e.arrowUp,p=e.arrowRight,y=e.arrowDown,d=e.copyDown,f=e.onTabPress,m=e.isFormElement,b=l(e,s),h={};return r.a.createElement(\"input\",u({\"data-testid\":\"input\",type:\"text\",ref:t,onKeyPress:function(e){13===e.which&&e.preventDefault()},onKeyDown:function(e){h[e.keyCode]=!0,h[40]&&h[17]?d&&(d(),e.preventDefault()):h[37]?i&&(i(),e.preventDefault()):h[38]?c&&(c(),e.preventDefault()):h[39]?p&&(p(),e.preventDefault()):h[40]?y&&(y(),e.preventDefault()):h[9]&&f&&f(e)},onKeyUp:function(e){h={};var t=e.target.value;a(t)},className:\"\".concat(m?\"form-control form-control-xs\":\"\",\" \").concat(o,\" \").concat(\"number\"===b.type?\"text-right mr-2\":\"\")},b,{onChange:function(e){var t=e.target.value;return a&&a(t),e},onFocus:function(e){return e.target.select()},onDragStart:function(e){e.preventDefault()},onWheel:function(){return document.activeElement.blur()}}))};t.a=c,c.propTypes={onChange:i.a.func,className:i.a.string,arrowLeft:i.a.func,arrowUp:i.a.func,arrowRight:i.a.func,arrowDown:i.a.func,copyDown:i.a.func,fieldRef:i.a.func,onTabPress:i.a.func,isFormElement:i.a.bool},c.defaultProps={onChange:null,className:\"\",arrowLeft:null,arrowUp:null,arrowRight:null,arrowDown:null,copyDown:null,fieldRef:null,onTabPress:null,isFormElement:!1}},415:function(e,t){e.exports=function(e,t,a){var n=new Blob([e],{type:a||\"application/octet-stream\"});if(void 0!==window.navigator.msSaveBlob)window.navigator.msSaveBlob(n,t);else{var r=window.URL.createObjectURL(n),o=document.createElement(\"a\");o.style.display=\"none\",o.href=r,o.setAttribute(\"download\",t),void 0===o.download&&o.setAttribute(\"target\",\"_blank\"),document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(r)}}},854:function(e,t,a){},926:function(e,t,a){\"use strict\";a.r(t);var n=a(0),r=a.n(n),o=a(3),i=a.n(o),s=a(1),u=a.n(s),l=a(17),c=a(10),p=a(15),y=a(14),d=a(70),f=a(33),m=a.n(f),b=a(447),h=a(5),w=a(576),v=a(577),g=a(45),E=function(e,t,a,n){t.id&&t.id!==a.id&&Object(d.confirmAlert)({title:e(\"react.default.message.locationChanged.label\",\"Location was changed\"),message:e(\"react.default.locationChanged.message\",\"Current location was changed, do you want to change the location back and continue work? If you press No all not saved changes will be lost.\"),buttons:[{label:e(\"react.default.yes.label\",\"Yes\"),onClick:function(){Object(g.b)(Object(y.d)(t))}},{label:e(\"react.default.no.label\",\"No\"),onClick:function(){n&&n()}}]})},A=a(9);a(437),a(375);function S(e){return(S=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function O(){return(O=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function I(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){B(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function j(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,R(n.key),n)}}function x(e,t){return(x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function k(e){var t=function(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=M(e);if(t){var r=M(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return C(this,a)}}function C(e,t){if(t&&(\"object\"===S(t)||\"function\"==typeof t))return t;if(void 0!==t)throw new TypeError(\"Derived constructors may only return object or undefined\");return N(e)}function N(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function B(e,t,a){return(t=R(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function R(e){var t=function(e,t){if(\"object\"!==S(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||\"default\");if(\"object\"!==S(n))return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===t?String:Number)(e)}(e,\"string\");return\"symbol\"===S(t)?t:String(t)}var T=Object(w.a)(b.a),L=function(e){!function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,\"prototype\",{writable:!1}),t&&x(e,t)}(s,e);var t,a,n,o=k(s);function s(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,s),B(N(t=o.call(this,e)),\"onExpandedChange\",(function(e){var a=[];i.a.forEach(e,(function(e,t){e&&a.push(parseInt(t,10))})),t.setState({expanded:e})})),B(N(t),\"getColumns\",(function(){return[{Header:r.a.createElement(A.a,{id:\"react.putAway.code.label\",defaultMessage:\"Code\"}),accessor:\"product.productCode\",style:{whiteSpace:\"normal\"},Filter:v.a},{Header:r.a.createElement(A.a,{id:\"react.putAway.name.label\",defaultMessage:\"Name\"}),accessor:\"product.name\",style:{whiteSpace:\"normal\"},Filter:v.a},{Header:r.a.createElement(A.a,{id:\"react.putAway.lotSerialNo.label\",defaultMessage:\"Lot/Serial No.\"}),accessor:\"inventoryItem.lotNumber\",style:{whiteSpace:\"normal\"},Filter:v.a},{Header:r.a.createElement(A.a,{id:\"react.putAway.expiry.label\",defaultMessage:\"Expiry\"}),accessor:\"inventoryItem.expirationDate\",style:{whiteSpace:\"normal\"},Filter:v.a},{Header:r.a.createElement(A.a,{id:\"react.putAway.recipient.label\",defaultMessage:\"Recipient\"}),accessor:\"recipient.name\",style:{whiteSpace:\"normal\"},Filter:v.a},{Header:r.a.createElement(A.a,{id:\"react.putAway.qty.label\",defaultMessage:\"QTY\"}),accessor:\"quantity\",style:{whiteSpace:\"normal\"},Cell:function(e){return r.a.createElement(\"span\",null,e.value?e.value.toLocaleString(\"en-US\"):e.value)},Filter:v.a},{Header:r.a.createElement(A.a,{id:\"react.putAway.preferredBin.label\",defaultMessage:\"Preferred bin\"}),accessor:\"preferredBin\",style:{whiteSpace:\"normal\"},Cell:function(e){return r.a.createElement(\"div\",null,e.value&&e.value.zoneName?r.a.createElement(\"div\",null,e.value.zoneName,\": \"):\"\",r.a.createElement(\"div\",null,e.value?e.value.name:\"\"))},Filter:v.a},{Header:r.a.createElement(A.a,{id:\"react.putAway.currentBin.label\",defaultMessage:\"Current bin\"}),accessor:\"currentBins\",style:{whiteSpace:\"normal\"},Filter:v.a},{Header:r.a.createElement(A.a,{id:\"react.putAway.putAwayBin.label\",defaultMessage:\"Putaway Bin\"}),accessor:\"putawayLocation\",style:{whiteSpace:\"normal\"},Cell:function(e){return r.a.createElement(\"div\",null,e.value&&e.value.zoneName?r.a.createElement(\"div\",null,e.value.zoneName,\": \"):\"\",r.a.createElement(\"div\",null,e.value?e.value.name:\"\"))},Filter:v.a},{Header:r.a.createElement(A.a,{id:\"react.putAway.stockMovement.label\",defaultMessage:\"Stock Movement\"}),accessor:\"stockMovement.name\",style:{whiteSpace:\"normal\"},Expander:function(e){var t=e.isExpanded;return r.a.createElement(\"span\",{className:\"ml-2\"},r.a.createElement(\"div\",{className:\"rt-expander \".concat(t&&\"-open\")},\"•\"))},filterable:!0,Filter:v.a}]})),B(N(t),\"toggleTree\",(function(){t.state.pivotBy.length?t.setState({pivotBy:[],expanded:{}}):t.setState({pivotBy:[\"stockMovement.name\"],expanded:{}})})),B(N(t),\"filterMethod\",(function(e,t){return t._aggregated||t._groupedByPivot||i.a.toString(t[e.id]).toLowerCase().includes(e.value.toLowerCase())}));var a=t.getColumns(),n=t.props.initialValues,u=n.putAway,l=n.pivotBy,c=n.expanded;return t.state={putAway:I(I({},u),{},{putawayItems:s.processSplitLines(u.putawayItems)}),completed:\"COMPLETED\"===u.putawayStatus,columns:a,pivotBy:l,expanded:c,location:t.props.location},t.confirmEmptyBin=t.confirmEmptyBin.bind(N(t)),t.confirmLowerQuantity=t.confirmLowerQuantity.bind(N(t)),t.save=t.save.bind(N(t)),t}return t=s,n=[{key:\"processSplitLines\",value:function(e){var t=[];return e&&e.forEach((function(e){e.splitItems&&e.splitItems.length>0?e.splitItems.forEach((function(a){t.push(I(I({},e),{},{quantity:a.quantity,putawayFacility:a.putawayFacility,putawayLocation:a.putawayLocation,splitItems:[]}))})):t.push(e)})),t}}],(a=[{key:\"componentWillReceiveProps\",value:function(e){E(this.props.translate,this.state.location,e.location,(function(){window.location=\"/openboxes/order/list?orderType=PUTAWAY_ORDER&status=PENDING\"}));var t=this.state.location.id?this.state.location:e.location;this.setState({putAway:I(I({},e.initialValues.putAway),{},{putawayItems:s.processSplitLines(e.initialValues.putAway.putawayItems)}),completed:\"COMPLETED\"===e.initialValues.putAway.putawayStatus,location:t})}},{key:\"completePutAway\",value:function(){var e=!i.a.some(this.props.initialValues.putAway.putawayItems,(function(e){return i.a.isNull(e.putawayLocation.id)&&i.a.isEmpty(e.splitItems)})),t=i.a.filter(this.props.initialValues.putAway.putawayItems,(function(e){return e.quantity<e.quantityAvailable}));i.a.isEmpty(t)?e?this.save():this.confirmEmptyBin():this.confirmLowerQuantity(t)}},{key:\"save\",value:function(){var e=this;this.props.showSpinner();var t=\"/openboxes/api/putaways?location.id=\".concat(this.state.location.id),a=I(I({},this.props.initialValues.putAway),{},{putawayStatus:\"COMPLETED\",putawayItems:i.a.map(this.props.initialValues.putAway.putawayItems,(function(e){return I(I({},e),{},{putawayStatus:e.splitItems.length?\"CANCELLED\":\"COMPLETED\",splitItems:i.a.map(e.splitItems,(function(e){return I(I({},e),{},{putawayStatus:\"COMPLETED\"})}))})}))});return h.a.post(t,Object(h.b)(a)).then((function(){e.props.hideSpinner(),m.a.success(e.props.translate(\"react.putAway.alert.putAwayCompleted.label\",\"Putaway was successfully completed!\"),{timeout:3e3}),window.location=\"/openboxes/order/show/\".concat(e.props.initialValues.putAway.id)})).catch((function(){return e.props.hideSpinner()}))}},{key:\"goToFirstPage\",value:function(){this.props.history.push(\"/openboxes/putAway/create\"),this.props.goToPage(1,null)}},{key:\"confirmEmptyBin\",value:function(){var e=this;Object(d.confirmAlert)({title:this.props.translate(\"react.putAway.message.confirmPutAway.label\",\"Confirm putaway\"),message:this.props.translate(\"react.putAway.confirmPutAway.message\",\"Are you sure you want to putaway? There are some lines with empty bin locations.\"),buttons:[{label:this.props.translate(\"react.default.yes.label\",\"Yes\"),onClick:function(){return e.save()}},{label:this.props.translate(\"react.default.no.label\",\"No\")}]})}},{key:\"confirmLowerQuantity\",value:function(e){var t=this;Object(d.confirmAlert)({title:this.props.translate(\"react.putAway.message.confirmPutAway.label\",\"Confirm putaway\"),message:i.a.map(e,(function(e){return r.a.createElement(\"p\",null,\"Qty \",e.quantityAvailable-e.quantity,\" \",t.props.translate(\"react.putAway.alert.lowerQty1.label\",\"of item\"),\" \",\" \",e.product.name,\" \",t.props.translate(\"react.putAway.alert.lowerQty2.label\",\"is still in the receiving bin. Do you want to continue?\"))})),buttons:[{label:this.props.translate(\"react.default.yes.label\",\"Yes\"),onClick:function(){return t.save()}},{label:this.props.translate(\"react.default.no.label\",\"No\")}]})}},{key:\"render\",value:function(){var e=this,t=this.onExpandedChange,a=this.toggleTree,n=this.state,o=n.putAway,i=n.columns,s=n.pivotBy,u={pivotBy:s,expanded:n.expanded,onExpandedChange:t};return r.a.createElement(\"div\",{className:\"putaway\"},r.a.createElement(\"div\",{className:\"d-flex justify-content-between mb-2 putaway-buttons\"},r.a.createElement(\"div\",null,r.a.createElement(A.a,{id:\"react.putAway.showBy.label\",defaultMessage:\"Show by\"}),\":\",r.a.createElement(\"button\",{className:\"btn btn-primary ml-2 btn-xs\",\"data-toggle\":\"button\",\"aria-pressed\":\"false\",onClick:a},s&&s.length?r.a.createElement(A.a,{id:\"react.putAway.stockMovement.label\",defaultMessage:\"Stock Movement\"}):r.a.createElement(A.a,{id:\"react.putAway.product.label\",defaultMessage:\"Product\"}))),r.a.createElement(\"span\",{className:\"buttons-container classic-form-buttons\"},this.state.completed?r.a.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-secondary btn-xs mr-3\",onClick:function(){return e.goToFirstPage()}},r.a.createElement(A.a,{id:\"react.putAway.goBack.label\",defaultMessage:\"Go back to putaway list\"})):r.a.createElement(\"div\",null,r.a.createElement(\"button\",{type:\"button\",onClick:function(){return e.props.previousPage({putAway:e.state.putAway,pivotBy:e.state.pivotBy,expanded:e.state.expanded})},className:\"btn btn-outline-secondary btn-xs mr-3\"},r.a.createElement(A.a,{id:\"react.default.button.edit.label\",defaultMessage:\"Edit\"})),r.a.createElement(\"button\",{type:\"button\",onClick:function(){return e.completePutAway()},className:\"btn btn-outline-secondary btn-xs mr-3\"},r.a.createElement(A.a,{id:\"react.putAway.completePutAway.label\",defaultMessage:\"Complete Putaway\"}))))),o.putawayItems?r.a.createElement(T,O({data:o.putawayItems,columns:i,ref:function(t){e.selectTable=t},className:\"-striped -highlight\"},u,{defaultPageSize:Number.MAX_SAFE_INTEGER,minRows:0,showPaginationBottom:!1,filterable:!0,defaultFilterMethod:this.filterMethod})):null,r.a.createElement(\"div\",{className:\"submit-buttons\"},this.state.completed?r.a.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-primary btn-form btn-xs\",onClick:function(){return e.goToFirstPage()}},r.a.createElement(A.a,{id:\"react.putAway.goBack.label\",defaultMessage:\"Go back to putaway list\"})):r.a.createElement(\"div\",{className:\"submit-buttons\"},r.a.createElement(\"button\",{type:\"button\",onClick:function(){return e.completePutAway()},className:\"btn btn-outline-primary btn-form float-right btn-xs\"},r.a.createElement(A.a,{id:\"react.putAway.completePutAway.label\",defaultMessage:\"Complete Putaway\"})),r.a.createElement(\"button\",{type:\"button\",onClick:function(){return e.props.previousPage({putAway:e.state.putAway,pivotBy:e.state.pivotBy,expanded:e.state.expanded})},className:\"btn btn-outline-primary btn-form btn-xs\"},r.a.createElement(A.a,{id:\"react.default.button.edit.label\",defaultMessage:\"Edit\"})))))}}])&&j(t.prototype,a),n&&j(t,n),Object.defineProperty(t,\"prototype\",{writable:!1}),s}(n.Component),q=Object(c.a)((function(e){return{translate:Object(A.b)(Object(l.e)(e.localize))}}),{showSpinner:y.M,hideSpinner:y.C})(L);L.propTypes={initialValues:u.a.shape({putAway:u.a.arrayOf(u.a.shape({})),pivotBy:u.a.arrayOf(u.a.shape({})),expanded:u.a.arrayOf(u.a.shape({}))}).isRequired,showSpinner:u.a.func.isRequired,hideSpinner:u.a.func.isRequired,location:u.a.shape({id:u.a.string}).isRequired,history:u.a.shape({push:u.a.func}).isRequired,translate:u.a.func.isRequired,previousPage:u.a.func.isRequired,goToPage:u.a.func.isRequired},L.defaultProps={};var F=a(756),_=a.n(F),D=a(382);function z(e){return(z=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function Q(){return(Q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function H(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function V(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?H(Object(a),!0).forEach((function(t){Z(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):H(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function U(e){return function(e){if(Array.isArray(e))return Y(e)}(e)||function(e){if(\"undefined\"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e[\"@@iterator\"])return Array.from(e)}(e)||function(e,t){if(!e)return;if(\"string\"==typeof e)return Y(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===a&&e.constructor&&(a=e.constructor.name);if(\"Map\"===a||\"Set\"===a)return Array.from(e);if(\"Arguments\"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Y(e,t)}(e)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function G(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,ee(n.key),n)}}function W(e,t){return(W=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function $(e){var t=function(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=J(e);if(t){var r=J(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return K(this,a)}}function K(e,t){if(t&&(\"object\"===z(t)||\"function\"==typeof t))return t;if(void 0!==t)throw new TypeError(\"Derived constructors may only return object or undefined\");return X(e)}function X(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}function J(e){return(J=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Z(e,t,a){return(t=ee(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ee(e){var t=function(e,t){if(\"object\"!==z(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||\"default\");if(\"object\"!==z(n))return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===t?String:Number)(e)}(e,\"string\");return\"symbol\"===z(t)?t:String(t)}var te=_()(Object(w.a)(b.a));var ae=function(e){!function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,\"prototype\",{writable:!1}),t&&W(e,t)}(s,e);var t,a,n,o=$(s);function s(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,s),Z(X(t=o.call(this,e)),\"onExpandedChange\",(function(e){var a=[];i.a.forEach(e,(function(e,t){e&&a.push(parseInt(t,10))})),t.setState({expanded:e})})),Z(X(t),\"getColumns\",(function(){return[{Header:r.a.createElement(A.a,{id:\"react.putAway.code.label\",defaultMessage:\"Code\"}),accessor:\"product.productCode\",style:{whiteSpace:\"normal\"},Filter:v.a},{Header:r.a.createElement(A.a,{id:\"react.putAway.name.label\",defaultMessage:\"Name\"}),accessor:\"product.name\",style:{whiteSpace:\"normal\"},Filter:v.a},{Header:r.a.createElement(A.a,{id:\"react.putAway.lotSerialNo.label\",defaultMessage:\"Lot/Serial No.\"}),accessor:\"inventoryItem.lotNumber\",style:{whiteSpace:\"normal\"},Filter:v.a},{Header:r.a.createElement(A.a,{id:\"react.putAway.expiry.label\",defaultMessage:\"Expiry\"}),accessor:\"inventoryItem.expirationDate\",style:{whiteSpace:\"normal\"},Filter:v.a},{Header:r.a.createElement(A.a,{id:\"react.putAway.recipient.label\",defaultMessage:\"Recipient\"}),accessor:\"recipient.name\",style:{whiteSpace:\"normal\"},Filter:v.a},{Header:r.a.createElement(A.a,{id:\"react.putAway.qtyReceiving.label\",defaultMessage:\"Qty in receiving\"}),accessor:\"quantity\",style:{whiteSpace:\"normal\"},Cell:function(e){return r.a.createElement(\"span\",null,e.value?e.value.toLocaleString(\"en-US\"):e.value)},Filter:v.a},{Header:r.a.createElement(A.a,{id:\"react.putAway.stockMovement.label\",defaultMessage:\"Stock Movement\"}),accessor:\"stockMovement.name\",style:{whiteSpace:\"normal\"},Expander:function(e){var a=e.row,n=e.isExpanded;return r.a.createElement(\"span\",{className:\"ml-2\"},r.a.createElement(\"input\",{type:\"checkbox\",name:\"aggregationCheckbox\",checked:t.checkSelected(a),value:a._subRows[0]._original.stockMovement.id,ref:function(e){e&&(e.indeterminate=t.checkIndeterminate(a))},onChange:t.toggleSelectionsByStockMovement}),r.a.createElement(\"div\",{className:\"rt-expander \".concat(n&&\"-open\")},\"•\"))},filterable:!0,Filter:v.a}]})),Z(X(t),\"dataFetched\",!1),Z(X(t),\"toggleSelectionsByStockMovement\",(function(e){var a=e.target,n=a.checked,r=a.value,o=i.a.map(i.a.filter(t.state.putawayItems,(function(e){return e.stockMovement.id===r&&\"READY\"===e.putawayStatus})),(function(e){return e._id}));t.toggleSelection(o,n)})),Z(X(t),\"toggleAll\",(function(){var e=!t.state.selectAll,a=[];(function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.forEach((function(t){Object.prototype.hasOwnProperty.call(t,\"_subRows\")&&t._subRows?a=e(t._subRows,a):a.push(t._original)})),a})(t.selectTable.getWrappedInstance().getResolvedState().sortedData).forEach((function(e){\"READY\"===e.putawayStatus&&a.push(e._id)})),t.toggleSelection(a,e),t.setState({selectAll:e})})),Z(X(t),\"toggleTree\",(function(){t.state.pivotBy.length?t.setState({pivotBy:[],expanded:{}}):t.setState({pivotBy:[\"stockMovement.name\"],expanded:{}})})),Z(X(t),\"isSelected\",(function(e){return i.a.includes(U(t.state.selection),e)})),Z(X(t),\"toggleSelection\",(function(e,a){var n=new Set(t.state.selection);Array.isArray(e)?a?i.a.forEach(e,(function(e){n.add(e)})):i.a.forEach(e,(function(e){n.delete(e)})):n.has(e)?n.delete(e):n.has(e)||n.add(e),t.setState({selection:n})})),Z(X(t),\"filterMethod\",(function(e,t){return t._aggregated||t._groupedByPivot||i.a.toString(t[e.id]).toLowerCase().includes(e.value.toLowerCase())}));var a=t.getColumns();return t.state={pendingPutAways:[],readyPutAways:[],putawayItems:[],columns:a,selection:new Set,selectAll:!1,selectType:\"checkbox\",pivotBy:[\"stockMovement.name\"],expanded:{}},t}return t=s,(a=[{key:\"componentDidMount\",value:function(){this.props.putAwayTranslationsFetched&&(this.dataFetched=!0,this.fetchPutAwayCandidates(this.props.locationId))}},{key:\"componentWillReceiveProps\",value:function(e){e.putAwayTranslationsFetched&&(this.dataFetched?this.props.locationId!==e.locationId&&this.fetchPutAwayCandidates(e.locationId):(this.dataFetched=!0,this.fetchPutAwayCandidates(this.props.locationId)))}},{key:\"fetchPutAwayCandidates\",value:function(e){var t=this;this.props.showSpinner();var a=\"/openboxes/api/putaways?location.id=\".concat(e);return h.a.get(a).then((function(e){var a=Object(h.e)(e.data.data).map((function(e){return V(V({},e),{},{_id:i.a.uniqueId(\"item_\")})})),n=a.filter((function(e){return\"READY\"!==e.putawayStatus})),r=a.filter((function(e){return\"READY\"===e.putawayStatus})).map((function(e){return V(V({},e),{},{putawayFacility:{id:e.currentFacility?e.currentFacility.id:null}})}));t.setState({putawayItems:r,pendingPutAways:n,readyPutAways:r},(function(){return t.props.hideSpinner()}))})).catch((function(){return t.props.hideSpinner()}))}},{key:\"createPutAway\",value:function(){var e=this;this.props.showSpinner();var t=\"/openboxes/api/putaways?location.id=\".concat(this.props.locationId),a=i.a.filter(this.state.putawayItems,(function(t){return i.a.includes(U(e.state.selection),t._id)})),n={putawayNumber:\"\",\"putawayAssignee.id\":\"\",putawayStatus:\"PENDING\",putawayDate:\"\",putawayItems:i.a.map(a,(function(e){return V(V({},e),{},{putawayStatus:\"PENDING\"})}))};return h.a.post(t,Object(h.b)(n)).then((function(t){var a=Object(h.e)(t.data.data);e.props.hideSpinner();var n={};e.state.pivotBy.length&&i.a.forEach(e.state.putawayItems,(function(e,t){n[t]=!0})),e.props.history.push(\"/openboxes/putAway/create/\".concat(a.id)),e.props.nextPage({putAway:a,pivotBy:e.state.pivotBy,expanded:n})})).catch((function(){return e.props.hideSpinner()}))}},{key:\"filterPutAways\",value:function(e){e?this.setState({putawayItems:[].concat(U(this.state.readyPutAways),U(this.state.pendingPutAways)),expanded:{}}):this.setState({putawayItems:U(this.state.readyPutAways),expanded:{}})}},{key:\"checkIndeterminate\",value:function(e){var t=this;return i.a.some(e._subRows,(function(e){return!i.a.includes(U(t.state.selection),e._original._id)}))&&i.a.some(e._subRows,(function(e){return i.a.includes(U(t.state.selection),e._original._id)}))}},{key:\"checkSelected\",value:function(e){var t=this;return i.a.every(e._subRows,(function(e){return i.a.includes(U(t.state.selection),e._original._id)}))}},{key:\"render\",value:function(){var e=this,t=this.toggleSelection,a=this.toggleAll,n=this.isSelected,o=this.onExpandedChange,s=this.toggleTree,u=this.state,l=u.putawayItems,c=u.columns,p=u.selectAll,y=u.selectType,d=u.pivotBy,f=u.expanded,m={selectAll:p,isSelected:n,toggleAll:a,toggleSelection:t,selectType:y,pivotBy:d,expanded:f,onExpandedChange:o};return r.a.createElement(\"div\",{className:\"putaway\"},r.a.createElement(\"div\",{className:\"d-flex justify-content-between mb-2 putaway-buttons\"},r.a.createElement(\"div\",null,r.a.createElement(A.a,{id:\"react.putAway.showBy.label\",defaultMessage:\"Show by\"}),\":\",r.a.createElement(\"button\",{className:\"btn btn-primary ml-2 btn-xs\",\"data-toggle\":\"button\",\"aria-pressed\":\"false\",onClick:s},d&&d.length?r.a.createElement(A.a,{id:\"react.putAway.stockMovement.label\",defaultMessage:\"Stock Movement\"}):r.a.createElement(A.a,{id:\"react.putAway.product.label\",defaultMessage:\"Product\"}))),r.a.createElement(\"div\",{className:\"row bd-highlight\"},r.a.createElement(\"div\",{className:\"mr-1\"},r.a.createElement(A.a,{id:\"react.putAway.lines.label\",defaultMessage:\"Lines in pending putaways\"}),\":\"),r.a.createElement(\"div\",{style:{width:\"150px\"}},r.a.createElement(D.a,{options:[{value:!1,label:r.a.createElement(A.a,{id:\"react.putAway.exclude.label\",defaultMessage:\"Exclude\"})},{value:!0,label:r.a.createElement(A.a,{id:\"react.putAway.include.label\",defaultMessage:\"Include\"})}],onChange:function(t){return e.filterPutAways(t.value)},initialValue:{value:!1,label:r.a.createElement(A.a,{id:\"react.putAway.exclude.label\",defaultMessage:\"Exclude\"})},clearable:!1,className:\"select-xs\"}))),r.a.createElement(\"button\",{type:\"button\",disabled:this.state.selection.size<1,onClick:function(){return e.createPutAway()},className:\"btn btn-outline-primary btn-form float-right btn-xs\"},r.a.createElement(A.a,{id:\"react.putAway.startPutAway.label\",defaultMessage:\"Start Putaway\"}))),l?r.a.createElement(te,Q({data:l,columns:c,ref:function(t){e.selectTable=t},className:\"-striped -highlight\"},m,{defaultPageSize:Number.MAX_SAFE_INTEGER,minRows:0,showPaginationBottom:!1,filterable:!0,defaultFilterMethod:this.filterMethod,freezeWhenExpanded:!0,SelectInputComponent:function(e){var t=e.id,a=e.checked,n=e.onClick,o=e.row;return r.a.createElement(\"input\",{type:y,checked:a,onChange:function(){},onClick:function(e){var a=e.shiftKey;e.stopPropagation(),n(t,a,o)},disabled:\"READY\"!==o.putawayStatus})},getTdProps:function(e,t){return{style:{color:\"READY\"===i.a.get(t,\"original.putawayStatus\")||t.aggregated?\"black\":\"gray\"},onClick:function(e,t){var a=e.target;t&&\"aggregationCheckbox\"!==a.name&&t()}}}})):null,r.a.createElement(\"div\",{className:\"submit-buttons\"},r.a.createElement(\"button\",{type:\"button\",disabled:this.state.selection.size<1,onClick:function(){return e.createPutAway()},className:\"btn btn-outline-primary btn-form float-right btn-xs\"},r.a.createElement(A.a,{id:\"react.putAway.startPutAway.label\",defaultMessage:\"Start Putaway\"}))))}}])&&G(t.prototype,a),n&&G(t,n),Object.defineProperty(t,\"prototype\",{writable:!1}),s}(n.Component),ne=Object(p.j)(Object(c.a)((function(e){return{putAwayTranslationsFetched:e.session.fetchedTranslations.putAway}}),{showSpinner:y.M,hideSpinner:y.C})(ae));ae.propTypes={showSpinner:u.a.func.isRequired,hideSpinner:u.a.func.isRequired,nextPage:u.a.func.isRequired,locationId:u.a.string.isRequired,history:u.a.shape({push:u.a.func}).isRequired,putAwayTranslationsFetched:u.a.bool.isRequired};var re=a(36),oe=a.n(re),ie=a(415),se=a.n(ie),ue=a(31),le=a.n(ue),ce=a(41),pe=a(59),ye=a.n(pe),de=a(51),fe=a(393);a(245);function me(e){return(me=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function be(e){return function(e){if(Array.isArray(e))return he(e)}(e)||function(e){if(\"undefined\"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e[\"@@iterator\"])return Array.from(e)}(e)||function(e,t){if(!e)return;if(\"string\"==typeof e)return he(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===a&&e.constructor&&(a=e.constructor.name);if(\"Map\"===a||\"Set\"===a)return Array.from(e);if(\"Arguments\"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return he(e,t)}(e)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function he(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function we(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ve(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?we(Object(a),!0).forEach((function(t){ge(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):we(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ge(e,t,a){return(t=Ae(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Ee(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,Ae(n.key),n)}}function Ae(e){var t=function(e,t){if(\"object\"!==me(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||\"default\");if(\"object\"!==me(n))return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===t?String:Number)(e)}(e,\"string\");return\"symbol\"===me(t)?t:String(t)}function Se(e,t){return(Se=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Oe(e){var t=function(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=je(e);if(t){var r=je(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Pe(this,a)}}function Pe(e,t){if(t&&(\"object\"===me(t)||\"function\"==typeof t))return t;if(void 0!==t)throw new TypeError(\"Derived constructors may only return object or undefined\");return Ie(e)}function Ie(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}function je(e){return(je=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var xe=function(e){!function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,\"prototype\",{writable:!1}),t&&Se(e,t)}(s,e);var t,a,n,o=Oe(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,s),(t=o.call(this,e)).state={splitItems:[],showModal:!1},t.openModal=t.openModal.bind(Ie(t)),t.onSave=t.onSave.bind(Ie(t)),t.closeModal=t.closeModal.bind(Ie(t)),t.isValid=t.isValid.bind(Ie(t)),t.isBinSelected=t.isBinSelected.bind(Ie(t)),t}return t=s,(a=[{key:\"onSave\",value:function(){var e=this;this.calculatePutAwayQty()<this.props.putawayItem.quantity?Object(d.confirmAlert)({title:this.props.translate(\"react.putAway.message.confirmSplitLine.label\",\"Confirm split line\"),message:this.props.translate(\"react.putAway.confirmSplitLine.label\",\"There is still stock in the receiving bin. Do you want to putaway the rest of this line?\"),buttons:[{label:this.props.translate(\"react.default.yes.label\",\"Yes\")},{label:this.props.translate(\"react.default.no.label\",\"No\"),onClick:function(){return e.save()}}]}):this.save()}},{key:\"getErrorMessage\",value:function(){return this.isQuantityGreaterThanOriginalPutaway()?this.props.translate(\"react.putAway.sumOfAll.label\",\"Sum of all split items quantities cannot be greater than original putaway item quantity\"):this.isNegativeQuantity()?this.props.translate(\"react.putAway.negativeSumOfAll.label\",\"Items quantity cannot be less than 1\"):\"\"}},{key:\"save\",value:function(){this.props.saveSplitItems(i.a.map(this.state.splitItems,(function(e){return e.quantity&&\"0\"!==e.quantity?e:ve(ve({},e),{},{delete:!0})}))),this.closeModal()}},{key:\"openModal\",value:function(){var e=[];this.props.splitItems&&this.props.splitItems.length>0?e=be(this.props.splitItems):e.push({quantity:this.props.putawayItem.quantity,putawayFacility:{id:this.props.putawayItem.putawayFacility?this.props.putawayItem.putawayFacility.id:null},putawayLocation:{id:this.props.putawayItem.putawayLocation?this.props.putawayItem.putawayLocation.id:null,name:this.props.putawayItem.putawayLocation?this.props.putawayItem.putawayLocation.name:null,zoneId:this.props.putawayItem.putawayLocation?this.props.putawayItem.putawayLocation.zoneId:null,zoneName:this.props.putawayItem.putawayLocation?this.props.putawayItem.putawayLocation.zoneName:null},product:{id:this.props.putawayItem.product.id},inventoryItem:{id:this.props.putawayItem.inventoryItem.id},currentLocation:{id:this.props.putawayItem.currentLocation?this.props.putawayItem.currentLocation.id:null}}),this.setState({splitItems:e,showModal:!0})}},{key:\"closeModal\",value:function(){this.setState({showModal:!1})}},{key:\"isNegativeQuantity\",value:function(){return i.a.some(this.state.splitItems,(function(e){return i.a.toInteger(e.quantity)<=0}))}},{key:\"isQuantityGreaterThanOriginalPutaway\",value:function(){return this.calculatePutAwayQty()>i.a.toInteger(this.props.putawayItem.quantity)}},{key:\"isValid\",value:function(){return!this.isNegativeQuantity()&&!this.isQuantityGreaterThanOriginalPutaway()}},{key:\"calculatePutAwayQty\",value:function(){return i.a.reduce(this.state.splitItems,(function(e,t){return e+(!t.delete&&t.quantity?i.a.toInteger(t.quantity):0)}),0)}},{key:\"isBinSelected\",value:function(){return i.a.every(this.state.splitItems,(function(e){return i.a.get(e,\"putawayLocation.id\")}))}},{key:\"render\",value:function(){var e=this;return r.a.createElement(\"div\",null,r.a.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-success btn-xs mr-1 mb-1\",onClick:function(){return e.openModal()}},r.a.createElement(A.a,{id:\"react.putAway.splitLine.label\",defaultMessage:\"Split line\"})),r.a.createElement(ye.a,{isOpen:this.state.showModal,onRequestClose:this.closeModal,className:\"modal-content-custom\",shouldCloseOnOverlayClick:!1},r.a.createElement(\"div\",null,r.a.createElement(\"h3\",{className:\"font-weight-bold\"},\"\".concat(this.props.putawayItem.product.productCode,\" \").concat(this.props.putawayItem.product.name)),r.a.createElement(\"div\",{className:\"font-weight-bold\"},r.a.createElement(A.a,{id:\"react.putAway.expiry.label\",defaultMessage:\"Expiry\"}),\": \",this.props.putawayItem.inventoryItem.expirationDate),r.a.createElement(\"div\",{className:\"font-weight-bold\"},r.a.createElement(A.a,{id:\"react.putAway.totalQty.label\",defaultMessage:\"Total QTY\"}),\": \",this.props.putawayItem.quantity),r.a.createElement(\"div\",{className:\"font-weight-bold\"},r.a.createElement(A.a,{id:\"react.putAway.putAwayQty.label\",defaultMessage:\"Putaway QTY\"}),\": \",this.calculatePutAwayQty())),r.a.createElement(\"hr\",null),r.a.createElement(\"div\",{className:\"text-center\"},r.a.createElement(\"table\",{className:\"table table-striped text-center border\"},r.a.createElement(\"thead\",null,r.a.createElement(\"tr\",null,r.a.createElement(\"th\",{className:\"py-1\"},r.a.createElement(A.a,{id:\"react.putAway.putAwayBin.label\",defaultMessage:\"Putaway Bin\"})),r.a.createElement(\"th\",{className:\"py-1\"},r.a.createElement(A.a,{id:\"react.putAway.quantity.label\",defaultMessage:\"Quantity\"})),r.a.createElement(\"th\",{className:\"py-1\"},r.a.createElement(A.a,{id:\"react.default.button.delete.label\",defaultMessage:\"Delete\"})))),r.a.createElement(\"tbody\",null,i.a.map(this.state.splitItems,(function(t,a){return!t.delete&&r.a.createElement(\"tr\",{key:a},r.a.createElement(\"td\",{className:\"py-1 \".concat(i.a.get(t,\"putawayLocation.id\")?\"align-middle\":\"has-error align-middle\")},r.a.createElement(D.a,{options:e.props.bins,valueKey:\"id\",labelKey:\"name\",value:t.putawayLocation,onChange:function(t){return e.setState({splitItems:oe()(e.state.splitItems,ge({},a,{putawayLocation:{$set:t}}))})},className:\"select-xs\"})),r.a.createElement(\"td\",{className:\"py-1 align-middle\"},r.a.createElement(ce.Tooltip,{html:e.getErrorMessage(),disabled:!e.isQuantityGreaterThanOriginalPutaway()&&t.quantity>0,theme:\"transparent\",arrow:\"true\",delay:\"150\",duration:\"250\",hideDelay:\"50\"},r.a.createElement(\"div\",{className:e.isQuantityGreaterThanOriginalPutaway()||t.quantity<=0?\"has-error\":\"\"},r.a.createElement(fe.a,{type:\"number\",value:t.quantity,onChange:function(t){return e.setState({splitItems:oe()(e.state.splitItems,ge({},a,{quantity:{$set:t}}))})}})))),r.a.createElement(\"td\",{width:\"120px\",className:\"py-1\"},r.a.createElement(\"button\",{className:\"btn btn-outline-danger btn-xs\",onClick:function(){e.state.splitItems[a].id?e.setState({splitItems:oe()(e.state.splitItems,ge({},a,{delete:{$set:!0}}))}):e.setState({splitItems:oe()(e.state.splitItems,{$splice:[[a,1]]})})}},r.a.createElement(A.a,{id:\"react.default.button.delete.label\",defaultMessage:\"Delete\"}))))})))),r.a.createElement(\"button\",{className:\"btn btn-outline-success btn-xs\",onClick:function(){return e.setState({splitItems:oe()(e.state.splitItems,{$push:[{quantity:\"\",putawayFacility:{id:e.props.putawayItem.putawayFacility?e.props.putawayItem.putawayFacility.id:null},putawayLocation:{id:null},product:{id:e.props.putawayItem.product.id},inventoryItem:{id:e.props.putawayItem.inventoryItem.id},currentLocation:{id:e.props.putawayItem.currentLocation?e.props.putawayItem.currentLocation.id:null}}]})})}},r.a.createElement(A.a,{id:\"react.default.button.addLine.label\",defaultMessage:\"Add line\"}))),r.a.createElement(\"hr\",null),r.a.createElement(\"div\",{className:\"btn-group float-right\",role:\"group\"},r.a.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-success btn-sm\",disabled:!this.isValid()||!this.isBinSelected(),onClick:function(){return e.onSave()}},r.a.createElement(A.a,{id:\"react.default.button.save.label\",defaultMessage:\"Save\"})),r.a.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-secondary btn-sm\",onClick:function(){return e.closeModal()}},r.a.createElement(A.a,{id:\"react.default.button.cancel.label\",defaultMessage:\"Cancel\"})))))}}])&&Ee(t.prototype,a),n&&Ee(t,n),Object.defineProperty(t,\"prototype\",{writable:!1}),s}(n.Component),ke=Object(de.a)((function(e){return{translate:Object(A.b)(Object(l.e)(e.localize))}}))(xe);function Ce(e){return(Ce=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function Ne(){return(Ne=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Me(e){return function(e){if(Array.isArray(e))return Be(e)}(e)||function(e){if(\"undefined\"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e[\"@@iterator\"])return Array.from(e)}(e)||function(e,t){if(!e)return;if(\"string\"==typeof e)return Be(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===a&&e.constructor&&(a=e.constructor.name);if(\"Map\"===a||\"Set\"===a)return Array.from(e);if(\"Arguments\"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Be(e,t)}(e)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function Be(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function Re(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Te(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(a),!0).forEach((function(t){Qe(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Re(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Le(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,He(n.key),n)}}function qe(e,t){return(qe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Fe(e){var t=function(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=ze(e);if(t){var r=ze(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return _e(this,a)}}function _e(e,t){if(t&&(\"object\"===Ce(t)||\"function\"==typeof t))return t;if(void 0!==t)throw new TypeError(\"Derived constructors may only return object or undefined\");return De(e)}function De(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}function ze(e){return(ze=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qe(e,t,a){return(t=He(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function He(e){var t=function(e,t){if(\"object\"!==Ce(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||\"default\");if(\"object\"!==Ce(n))return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===t?String:Number)(e)}(e,\"string\");return\"symbol\"===Ce(t)?t:String(t)}xe.propTypes={saveSplitItems:u.a.func.isRequired,putawayItem:u.a.shape({product:u.a.shape({id:u.a.string,productCode:u.a.string,name:u.a.string}),inventoryItem:u.a.shape({id:u.a.string,expirationDate:u.a.string}),quantity:u.a.oneOfType([u.a.string,u.a.number]),putawayFacility:u.a.shape({id:u.a.string}),putawayLocation:u.a.shape({id:u.a.string,name:u.a.string,zoneId:u.a.string,zoneName:u.a.string}),currentLocation:u.a.shape({id:u.a.string})}),splitItems:u.a.arrayOf(u.a.shape({})),bins:u.a.arrayOf(u.a.shape({})),translate:u.a.func.isRequired},xe.defaultProps={putawayItem:{},splitItems:[],bins:[]};var Ve=Object(w.a)(b.a);function Ue(e,t){return e>t||e<1}var Ye=function(e){!function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,\"prototype\",{writable:!1}),t&&qe(e,t)}(s,e);var t,a,n,o=Fe(s);function s(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,s),Qe(De(t=o.call(this,e)),\"onExpandedChange\",(function(e){var a=[];i.a.forEach(e,(function(e,t){e&&a.push(parseInt(t,10))})),t.setState({expanded:e})})),Qe(De(t),\"getColumns\",(function(){return[{Header:r.a.createElement(A.a,{id:\"react.putAway.code.label\",defaultMessage:\"Code\"}),accessor:\"product.productCode\",style:{whiteSpace:\"normal\"},Filter:v.a},{Header:r.a.createElement(A.a,{id:\"react.putAway.name.label\",defaultMessage:\"Name\"}),accessor:\"product.name\",style:{whiteSpace:\"normal\"},Filter:v.a},{Header:r.a.createElement(A.a,{id:\"react.putAway.lotSerialNo.label\",defaultMessage:\"Lot/Serial No.\"}),accessor:\"inventoryItem.lotNumber\",style:{whiteSpace:\"normal\"},Filter:v.a},{Header:r.a.createElement(A.a,{id:\"react.putAway.expiry.label\",defaultMessage:\"Expiry\"}),accessor:\"inventoryItem.expirationDate\",style:{whiteSpace:\"normal\"},Filter:v.a},{Header:r.a.createElement(A.a,{id:\"react.putAway.recipient.label\",defaultMessage:\"Recipient\"}),accessor:\"recipient.name\",style:{whiteSpace:\"normal\"},Filter:v.a},{Header:r.a.createElement(A.a,{id:\"react.putAway.qty.label\",defaultMessage:\"QTY\"}),accessor:\"quantity\",style:{whiteSpace:\"normal\"},Cell:function(e){var a,n,o,s,u=e.index,l=i.a.get(t.state.putAway.putawayItems,\"[\".concat(u,\"].edit\"));return(null==e?void 0:e.value)<1&&(o=t.props.translate(\"react.putAway.negativeQuantity.label\",\"Quantity cannot be less than 1\")),(null==e?void 0:e.value)>(null===(a=e.original)||void 0===a?void 0:a.quantityAvailable)&&(o=t.props.translate(\"react.putAway.higherQuantity.label\",\"Quantity cannot be greater than original putaway item quantity\")),l?r.a.createElement(ce.Tooltip,{html:o,disabled:!o,theme:\"transparent\",arrow:\"true\",delay:\"150\",duration:\"250\",hideDelay:\"50\"},r.a.createElement(\"div\",{className:Ue(null==e?void 0:e.value,null===(s=e.original)||void 0===s?void 0:s.quantityAvailable)?\"has-error\":\"\"},r.a.createElement(\"input\",{type:\"number\",className:\"form-control form-control-xs\",value:e.value,onChange:function(e){var a=oe()(t.state.putAway,{putawayItems:Qe({},u,{quantity:{$set:e.target.value}})});t.changePutAway(a)}}))):r.a.createElement(ce.Tooltip,{html:o,disabled:!o,theme:\"transparent\",arrow:\"true\",delay:\"150\",duration:\"250\",hideDelay:\"50\"},r.a.createElement(\"div\",{className:Ue(e.value,null===(n=e.original)||void 0===n?void 0:n.quantityAvailable)?\"has-error\":\"\"},r.a.createElement(\"span\",null,e.value?e.value.toLocaleString(\"en-US\"):e.value)))},Filter:v.a},{Header:r.a.createElement(A.a,{id:\"react.putAway.preferredBin.label\",defaultMessage:\"Preferred bin\"}),accessor:\"preferredBin\",style:{whiteSpace:\"normal\"},Cell:function(e){return r.a.createElement(\"div\",null,e.value&&e.value.zoneName?r.a.createElement(\"div\",null,e.value.zoneName,\": \"):\"\",r.a.createElement(\"div\",null,e.value?e.value.name:\"\"))},Filter:v.a},{Header:r.a.createElement(A.a,{id:\"react.putAway.currentBin.label\",defaultMessage:\"Current bin\"}),accessor:\"currentBins\",style:{whiteSpace:\"normal\"},Filter:v.a},{Header:r.a.createElement(A.a,{id:\"react.putAway.stockMovement.label\",defaultMessage:\"Stock Movement\"}),accessor:\"stockMovement.name\",style:{whiteSpace:\"normal\"},Expander:function(e){var t=e.isExpanded;return r.a.createElement(\"span\",{className:\"ml-2\"},r.a.createElement(\"div\",{className:\"rt-expander \".concat(t&&\"-open\")},\"•\"))},filterable:!0,Filter:v.a},{Header:r.a.createElement(A.a,{id:\"react.putAway.putAwayBin.label\",defaultMessage:\"Putaway Bin\"}),accessor:\"putawayLocation\",Cell:function(e){var a=i.a.get(t.state.putAway.putawayItems,\"[\".concat(e.index,\"].splitItems\"));return a&&a.length>0?r.a.createElement(A.a,{id:\"react.putAway.splitLine.label\",defaultMessage:\"Split line\"}):r.a.createElement(D.a,{options:t.state.bins,valueKey:\"id\",labelKey:\"name\",value:i.a.get(t.state.putAway.putawayItems,\"[\".concat(e.index,\"].\").concat(e.column.id))||null,onChange:function(a){return t.changePutAway(oe()(t.state.putAway,{putawayItems:Qe({},e.index,{putawayLocation:{$set:a}})}))},className:\"select-xs\"})},Filter:v.a},{Header:\"\",accessor:\"splitItems\",Cell:function(e){return r.a.createElement(\"div\",{className:\"d-flex flex-row flex-wrap\"},r.a.createElement(ke,{putawayItem:t.state.putAway.putawayItems[e.index],splitItems:i.a.get(t.state.putAway.putawayItems,\"[\".concat(e.index,\"].\").concat(e.column.id)),saveSplitItems:function(a){t.saveSplitItems(a,e.index)},bins:t.state.bins}),r.a.createElement(\"button\",{className:\"btn btn-outline-primary btn-xs mr-1 mb-1\",onClick:function(){return t.editItem(e.index)}},r.a.createElement(A.a,{id:\"react.default.button.edit.label\",defaultMessage:\"Edit\"})),r.a.createElement(\"button\",{className:\"btn btn-outline-danger btn-xs mb-1\",onClick:function(){return t.deleteItem(e.index)}},r.a.createElement(A.a,{id:\"react.default.button.delete.label\",defaultMessage:\"Delete\"})))},filterable:!1}]})),Qe(De(t),\"dataFetched\",!1),Qe(De(t),\"toggleTree\",(function(){t.state.pivotBy.length?t.setState({pivotBy:[],expanded:{}}):t.setState({pivotBy:[\"stockMovement.name\"],expanded:{}})})),Qe(De(t),\"filterMethod\",(function(e,t){if(t._aggregated||t._groupedByPivot)return!0;var a=t[e.id];return\"putawayLocation\"===e.id&&(a=i.a.get(a,\"name\")),i.a.toString(a).toLowerCase().includes(e.value.toLowerCase())})),t.getColumns=t.getColumns.bind(De(t)),t.fetchItems=t.fetchItems.bind(De(t)),t.editItem=t.editItem.bind(De(t));var a=t.getColumns(),n=t.props.initialValues,u=n.putAway,l=n.pivotBy,c=n.expanded;return t.state={putAway:u||{},columns:a,pivotBy:l||[\"stockMovement.name\"],expanded:c,bins:[],location:t.props.location,sortBy:u&&u.sortBy},t}return t=s,(a=[{key:\"componentDidMount\",value:function(){this.props.putAwayTranslationsFetched&&(this.dataFetched=!0,this.fetchBins()),this.fetchPutAway()}},{key:\"componentWillReceiveProps\",value:function(e){E(this.props.translate,this.state.location,e.location,(function(){window.location=\"/openboxes/order/list?orderType=PUTAWAY_ORDER&status=PENDING\"}));var t=this.state.location.id?this.state.location:e.location;this.setState({location:t}),e.putAwayTranslationsFetched&&!this.dataFetched&&(this.dataFetched=!0,this.fetchBins())}},{key:\"fetchPutAway\",value:function(){var e=this;if(this.props.match.params.putAwayId){this.props.showSpinner();var t=\"/openboxes/api/putaways/\".concat(this.props.match.params.putAwayId);h.a.get(t).then((function(t){var a=Object(h.e)(t.data.data),n=i.a.map(a.putawayItems,(function(e){return Te(Te({},e),{},{putawayLocation:e.putawayLocation.id||e.preferredBin.id?{id:e.putawayLocation.id?e.putawayLocation.id:e.preferredBin.id,name:e.putawayLocation.name?e.putawayLocation.name:e.preferredBin.name,zoneId:e.putawayLocation.id?e.putawayLocation.zoneId:e.preferredBin.zoneId,zoneName:e.putawayLocation.id?e.putawayLocation.zoneName:e.preferredBin.zoneName}:null})}));e.props.hideSpinner();var r={};i.a.forEach(n,(function(e,t){r[t]=!0})),e.setState({expanded:r,putAway:Te(Te({},a),{},{putawayItems:n})})})).catch((function(){return e.props.hideSpinner()}))}}},{key:\"fetchBins\",value:function(){var e=this;this.props.showSpinner();var t=function(e){return i.a.chain(e).orderBy([\"name\"],[\"asc\"]).value()};return h.a.get(\"/openboxes/api/internalLocations\",{paramsSerializer:function(e){return le.a.stringify(e)},params:{\"location.id\":this.props.location.id,locationTypeCode:[\"BIN_LOCATION\",\"INTERNAL\"],ignoreActivityCodes:[\"RECEIVE_STOCK\"]}}).then((function(a){var n=i.a.partition(a.data.data,(function(e){return e.zoneName})),r=i.a.chain(n[0]).groupBy(\"zoneName\").map((function(e,a){return{name:a,options:t(e)}})).orderBy([\"label\"],[\"asc\"]).value(),o=t(n[1]);e.setState({bins:[].concat(Me(r),Me(o))},(function(){return e.props.hideSpinner()}))})).catch((function(){return e.props.hideSpinner()}))}},{key:\"saveSplitItems\",value:function(e,t){var a=oe()(this.state.putAway,{putawayItems:Qe({},t,{splitItems:{$set:e}})});this.savePutAways(a)}},{key:\"savePutAways\",value:function(e,t){var a=this;this.props.showSpinner();var n=\"/openboxes/api/putaways?location.id=\".concat(this.state.location.id);return h.a.post(n,Object(h.b)(e)).then((function(e){var n=Object(h.e)(e.data.data);a.setState({putAway:n},(function(){a.props.hideSpinner(),t&&t(n)}))})).catch((function(){return a.props.hideSpinner()}))}},{key:\"changePutAway\",value:function(e){this.setState({putAway:e})}},{key:\"editItem\",value:function(e){var t=oe()(this.state.putAway,{putawayItems:Qe({},e,{edit:{$set:!0},splitItems:{$set:i.a.map(i.a.filter(this.state.putAway.putawayItems[e].splitItems,(function(e){return e.id})),(function(e){return Te(Te({},e),{},{delete:!0})}))}})});this.changePutAway(t)}},{key:\"deleteItem\",value:function(e){var t=this;this.props.showSpinner();var a=\"/openboxes/api/putawayItems/\".concat(i.a.get(this.state.putAway.putawayItems,\"[\".concat(e,\"].id\")));h.a.delete(a).then((function(){var a=oe()(t.state.putAway,{putawayItems:{$splice:[[e,1]]}});t.changePutAway(a),t.props.hideSpinner()})).catch((function(){return t.props.hideSpinner()}))}},{key:\"nextPage\",value:function(){var e=this;i.a.some(this.state.putAway.putawayItems,(function(e){return e.quantity>e.quantityAvailable}))?Object(d.confirmAlert)({title:this.props.translate(\"react.putAway.message.putAwayError.label\",\"Putaway error\"),message:this.props.translate(\"react.putAway.putAwayAlert.message\",\"Cannot put away more than is available in the receiving bin. Reduce quantity of items in red to match the quantity in the receiving bin.\"),buttons:[{label:this.props.translate(\"react.default.ok.label\",\"OK\")}]}):this.savePutAways(this.state.putAway,(function(t){e.props.nextPage({putAway:t,pivotBy:e.state.pivotBy,expanded:e.state.expanded})}))}},{key:\"generatePutAwayList\",value:function(){var e=this;this.props.showSpinner();var t=this.state.putAway.putawayNumber;return h.a.post(\"/openboxes/putAway/generatePdf\",Object(h.b)(this.state.putAway),{responseType:\"blob\"}).then((function(a){se()(a.data,\"PutawayReport\".concat(t?\"-\".concat(t):\"\",\".pdf\"),\"application/pdf\"),e.fetchItems(e.state.sortBy),e.props.hideSpinner()})).catch((function(){return e.props.hideSpinner()}))}},{key:\"sortPutawayItems\",value:function(){var e=this.state.sortBy;switch(e){case\"currentBins\":e=\"preferredBin\";break;case\"preferredBin\":e=\"\";break;default:e=\"currentBins\"}this.setState({sortBy:e}),this.fetchItems(e)}},{key:\"fetchItems\",value:function(e){var t=this,a=\"/openboxes/api/putaways/\".concat(this.state.putAway.id,\"?sortBy=\").concat(e);return h.a.get(a).then((function(a){var n=i.a.map(Object(h.e)(a.data.data.putawayItems),(function(e){return Te(Te({},e),{},{putawayLocation:e.putawayLocation.id||e.preferredBin.id?{id:e.putawayLocation.id?e.putawayLocation.id:e.preferredBin.id,name:e.putawayLocation.name?e.putawayLocation.name:e.preferredBin.name,zoneId:e.putawayLocation.id?e.putawayLocation.zoneId:e.preferredBin.zoneId,zoneName:e.putawayLocation.id?e.putawayLocation.zoneName:e.preferredBin.zoneName}:null})}));t.changePutAway(Te(Te({},t.state.putAway),{},{sortBy:e,putawayItems:n}))})).catch((function(){return t.props.hideSpinner()}))}},{key:\"render\",value:function(){var e=this,t=this.onExpandedChange,a=this.toggleTree,n=this.state,o=n.columns,s=n.pivotBy,u=n.expanded,l=n.sortBy,c={pivotBy:s,expanded:u,onExpandedChange:t};return r.a.createElement(\"div\",{className:\"putaway\"},r.a.createElement(\"div\",{className:\"d-flex justify-content-between mb-2 putaway-buttons\"},r.a.createElement(\"div\",null,r.a.createElement(A.a,{id:\"react.putAway.showBy.label\",defaultMessage:\"Show by\"}),\":\",r.a.createElement(\"button\",{className:\"btn btn-primary ml-2 btn-xs\",\"data-toggle\":\"button\",\"aria-pressed\":\"false\",onClick:a},s&&s.length?r.a.createElement(A.a,{id:\"react.putAway.stockMovement.label\",defaultMessage:\"Stock Movement\"}):r.a.createElement(A.a,{id:\"react.putAway.product.label\",defaultMessage:\"Product\"}))),r.a.createElement(\"span\",{className:\"buttons-container classic-form-buttons\"},r.a.createElement(\"button\",{type:\"button\",onClick:function(){return e.savePutAways(e.state.putAway,(function(){return e.sortPutawayItems()}))},className:\"btn btn-outline-secondary btn-xs mr-3\"},r.a.createElement(\"span\",null,this.props.translate(\"react.putAway.\".concat(l?\"currentBins\"===l?\"sortByPreferredBin\":\"originalOrder\":\"sortByCurrentBins\",\".label\"),l?\"currentBins\"===l?\"Sort by preferred bin\":\"Original order\":\"Sort by current bins\"))),r.a.createElement(\"button\",{className:\"btn btn-outline-secondary btn-xs mr-3\",onClick:function(){return e.savePutAways(e.state.putAway,(function(){return e.generatePutAwayList()}))}},r.a.createElement(\"span\",null,r.a.createElement(\"i\",{className:\"fa fa-print pr-2\"}),r.a.createElement(A.a,{id:\"react.putAway.generateList.label\",defaultMessage:\"Generate Putaway list\"}))),r.a.createElement(\"button\",{type:\"button\",onClick:function(){return e.savePutAways(e.state.putAway)},className:\"btn btn-outline-secondary btn-xs\",disabled:i.a.some(this.state.putAway.putawayItems,(function(e){return Ue(e.quantity,e.quantityAvailable)}))},r.a.createElement(A.a,{id:\"react.default.button.save.label\",defaultMessage:\"Save\"})))),this.state.putAway.putawayItems?r.a.createElement(Ve,Ne({data:this.state.putAway.putawayItems,columns:o,ref:function(t){e.selectTable=t},className:\"-striped -highlight\"},c,{defaultPageSize:Number.MAX_SAFE_INTEGER,minRows:0,showPaginationBottom:!1,filterable:!0,defaultFilterMethod:this.filterMethod})):null,r.a.createElement(\"div\",{className:\"submit-buttons\"},r.a.createElement(\"button\",{disabled:i.a.some(this.state.putAway.putawayItems,(function(e){return Ue(e.quantity,e.quantityAvailable)})),type:\"button\",onClick:function(){return e.nextPage()},className:\"btn btn-outline-primary btn-form float-right btn-xs\"},r.a.createElement(A.a,{id:\"react.default.button.next.label\",defaultMessage:\"Next\"}))))}}])&&Le(t.prototype,a),n&&Le(t,n),Object.defineProperty(t,\"prototype\",{writable:!1}),s}(n.Component),Ge=Object(c.a)((function(e){return{translate:Object(A.b)(Object(l.e)(e.localize)),putAwayTranslationsFetched:e.session.fetchedTranslations.putAway}}),{showSpinner:y.M,hideSpinner:y.C})(Ye);Ye.defaultProps={original:{}},Ye.propTypes={showSpinner:u.a.func.isRequired,hideSpinner:u.a.func.isRequired,nextPage:u.a.func.isRequired,translate:u.a.func.isRequired,initialValues:u.a.shape({putAway:u.a.arrayOf(u.a.shape({})),pivotBy:u.a.arrayOf(u.a.shape({})),expanded:u.a.arrayOf(u.a.shape({}))}).isRequired,original:u.a.shape({quantityAvailable:u.a.number}),match:u.a.shape({params:u.a.shape({putAwayId:u.a.string})}).isRequired,location:u.a.shape({id:u.a.string}).isRequired,putAwayTranslationsFetched:u.a.bool.isRequired};var We=a(439);a(854);function $e(e){return($e=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function Ke(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,at(n.key),n)}}function Xe(e,t){return(Xe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Je(e){var t=function(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=tt(e);if(t){var r=tt(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Ze(this,a)}}function Ze(e,t){if(t&&(\"object\"===$e(t)||\"function\"==typeof t))return t;if(void 0!==t)throw new TypeError(\"Derived constructors may only return object or undefined\");return et(e)}function et(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}function tt(e){return(tt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function at(e){var t=function(e,t){if(\"object\"!==$e(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||\"default\");if(\"object\"!==$e(n))return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===t?String:Number)(e)}(e,\"string\");return\"symbol\"===$e(t)?t:String(t)}var nt=function(e){!function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,\"prototype\",{writable:!1}),t&&Xe(e,t)}(s,e);var t,a,n,o=Je(s);function s(e){var t,a,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,s),t=o.call(this,e),a=et(t),r=!1,(n=at(n=\"dataFetched\"))in a?Object.defineProperty(a,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):a[n]=r,t.state={page:e.match.params.putAwayId?2:1,putAway:{}},t.updateWizardValues=t.updateWizardValues.bind(et(t)),t}return t=s,(a=[{key:\"componentDidMount\",value:function(){this.props.fetchTranslations(\"\",\"putAway\"),this.props.putAwayTranslationsFetched&&(this.dataFetched=!0,this.fetchPutAway())}},{key:\"componentWillReceiveProps\",value:function(e){this.props.locale&&this.props.locale!==e.locale&&this.props.fetchTranslations(e.locale,\"putAway\"),e.putAwayTranslationsFetched&&!this.dataFetched&&(this.dataFetched=!0,this.fetchPutAway())}},{key:\"stepList\",get:function(){return[this.props.translate(\"react.putAway.createPutAway.label\",\"Create Putaway\"),this.props.translate(\"react.putAway.startPutAway.label\",\"Start Putaway\"),this.props.translate(\"react.putAway.completePutAway.label\",\"Complete Putaway\")]}},{key:\"wizardTitle\",get:function(){var e,t=this.state.putAway;return null!=t&&null!==(e=t.putAway)&&void 0!==e&&e.putawayNumber?[{text:this.props.translate(\"react.putAway.putAway.label\",\"Putaway\"),color:\"#000000\",delimeter:\" | \"},{text:t.putAway.putawayNumber,color:\"#000000\",delimeter:\"\"}]:\"\"}},{key:\"updateWizardValues\",value:function(e,t){this.setState({page:e,putAway:t})}},{key:\"fetchPutAway\",value:function(){var e=this;if(this.props.match.params.putAwayId){this.props.showSpinner();var t=\"/openboxes/api/putaways/\".concat(this.props.match.params.putAwayId);h.a.get(t).then((function(t){var a=Object(h.e)(t.data.data);e.props.hideSpinner(),e.setState({putAway:{putAway:a},page:\"COMPLETED\"===a.putawayStatus?3:2})})).catch((function(){return e.props.hideSpinner()}))}}},{key:\"render\",value:function(){var e=this.state,t=e.page,a=e.putAway,n=this.props,o=n.location,s=n.history,u=n.match,l=o.id,c=[ne,Ge,q];return i.a.get(o,\"id\")?r.a.createElement(We.a,{pageList:c,stepList:this.stepList,initialValues:a,title:this.wizardTitle,currentPage:t,prevPage:1===t?1:t-1,updateWizardValues:this.updateWizardValues,additionalProps:{locationId:l,location:o,history:s,match:u}}):null}}])&&Ke(t.prototype,a),n&&Ke(t,n),Object.defineProperty(t,\"prototype\",{writable:!1}),s}(n.Component);t.default=Object(p.j)(Object(c.a)((function(e){return{location:e.session.currentLocation,locale:e.session.activeLanguage,putAwayTranslationsFetched:e.session.fetchedTranslations.putAway,translate:Object(A.b)(Object(l.e)(e.localize))}}),{showSpinner:y.M,hideSpinner:y.C,fetchTranslations:y.y})(nt));nt.propTypes={location:u.a.shape({id:u.a.string}).isRequired,locale:u.a.string.isRequired,putAwayTranslationsFetched:u.a.bool.isRequired,fetchTranslations:u.a.func.isRequired,translate:u.a.func.isRequired,showSpinner:u.a.func.isRequired,hideSpinner:u.a.func.isRequired,match:u.a.shape({params:u.a.shape({putAwayId:u.a.string})}).isRequired,history:u.a.shape({push:u.a.func}).isRequired}}}]);","extractedComments":[]}