{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{862:function(e,t,r){},931:function(e,t,r){\"use strict\";r.r(t);var n=r(0),a=r.n(n),o=r(3),s=r.n(o),i=r(1),c=r.n(i),l=r(17),u=r(10),f=r(15),p=r(14),d=r(447),b=r(756),h=r.n(b),m=r(5),y=r(576),T=r(577),k=r(9);r(437);function v(e){return(v=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function g(){return(g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function O(e){return function(e){if(Array.isArray(e))return w(e)}(e)||function(e){if(\"undefined\"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e[\"@@iterator\"])return Array.from(e)}(e)||function(e,t){if(!e)return;if(\"string\"==typeof e)return w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===r&&e.constructor&&(r=e.constructor.name);if(\"Map\"===r||\"Set\"===r)return Array.from(e);if(\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w(e,t)}(e)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,R(n.key),n)}}function j(e,t){return(j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function P(e){var t=function(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=N(e);if(t){var a=N(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return I(this,r)}}function I(e,t){if(t&&(\"object\"===v(t)||\"function\"==typeof t))return t;if(void 0!==t)throw new TypeError(\"Derived constructors may only return object or undefined\");return C(e)}function C(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}function N(e){return(N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function q(e,t,r){return(t=R(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R(e){var t=function(e,t){if(\"object\"!==v(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||\"default\");if(\"object\"!==v(n))return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===t?String:Number)(e)}(e,\"string\");return\"symbol\"===v(t)?t:String(t)}var x=h()(Object(y.a)(d.a));var M=function(e){!function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,\"prototype\",{writable:!1}),t&&j(e,t)}(i,e);var t,r,n,o=P(i);function i(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,i),q(C(t=o.call(this,e)),\"getColumns\",(function(){return[{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.code.label\",defaultMessage:\"Code\"}),accessor:\"product.productCode\",style:{whiteSpace:\"normal\"},Filter:T.a},{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.product.label\",defaultMessage:\"Product\"}),accessor:\"product.name\",style:{whiteSpace:\"normal\"},Filter:T.a},{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.lot.label\",defaultMessage:\"Lot\"}),accessor:\"lotNumber\",style:{whiteSpace:\"normal\"},Filter:T.a},{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.expiry.label\",defaultMessage:\"Expiry\"}),accessor:\"expirationDate\",style:{whiteSpace:\"normal\"},Filter:T.a},{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.zone.label\",defaultMessage:\"Zone\"}),accessor:\"originZone\",style:{whiteSpace:\"normal\"},Filter:T.a},{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.binLocation.label\",defaultMessage:\"Bin Location\"}),accessor:\"originBinLocation.name\",style:{whiteSpace:\"normal\"},Filter:T.a},{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.quantityOnHand.label\",defaultMessage:\"QOH\"}),accessor:\"quantityOnHand\",style:{whiteSpace:\"normal\"},Cell:function(e){return a.a.createElement(\"span\",null,e.value?e.value.toLocaleString(\"en-US\"):e.value)},Filter:T.a},{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.quantityAvailableToTransfer.label\",defaultMessage:\"Quantity Available to Transfer\"}),accessor:\"quantityNotPicked\",style:{whiteSpace:\"normal\"},Cell:function(e){return a.a.createElement(\"span\",null,e.value?e.value.toLocaleString(\"en-US\"):e.value)},Filter:T.a}]})),q(C(t),\"dataFetched\",!1),q(C(t),\"filterMethod\",(function(e,t){var r=t[e.id];return s.a.toString(r).toLowerCase().includes(e.value.toLowerCase())})),q(C(t),\"toggleAll\",(function(){var e=!t.state.selectAll,r=[];(function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.forEach((function(t){Object.prototype.hasOwnProperty.call(t,\"_subRows\")&&t._subRows?r=e(t._subRows,r):r.push(t._original)})),r})(t.selectTable.getWrappedInstance().getResolvedState().sortedData).forEach((function(e){e&&0!==e.quantityNotPicked&&r.push(e._id)})),t.toggleSelection(r,e),t.setState({selectAll:e})})),q(C(t),\"isSelected\",(function(e){return s.a.includes(O(t.state.selection),e)})),q(C(t),\"toggleSelection\",(function(e,r){var n=new Set(t.state.selection);Array.isArray(e)?r?s.a.forEach(e,(function(e){n.add(e)})):s.a.forEach(e,(function(e){n.delete(e)})):n.has(e)?n.delete(e):n.has(e)||n.add(e),t.setState({selection:n})}));var r=t.getColumns();return t.state={stockTransferItems:[],columns:r,selection:new Set,selectAll:!1,selectType:\"checkbox\"},t}return t=i,(r=[{key:\"componentDidMount\",value:function(){this.props.stockTransferTranslationsFetched&&(this.dataFetched=!0,this.fetchStockTransferCandidates(this.props.locationId))}},{key:\"componentWillReceiveProps\",value:function(e){e.stockTransferTranslationsFetched&&(this.dataFetched?this.props.locationId!==e.locationId&&this.fetchStockTransferCandidates(e.locationId):(this.dataFetched=!0,this.fetchStockTransferCandidates(this.props.locationId)))}},{key:\"fetchStockTransferCandidates\",value:function(e){var t=this;this.props.showSpinner();var r=\"/openboxes/api/stockTransfers/candidates?location.id=\".concat(e);return m.a.get(r).then((function(e){var r=Object(m.e)(e.data.data),n=[];r.forEach((function(e){var t=s.a.uniqueId(\"item_\");n.push(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){q(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({_id:t},e))})),t.setState({stockTransferItems:n},(function(){return t.props.hideSpinner()}))})).catch((function(){return t.props.hideSpinner()}))}},{key:\"createStockTransfer\",value:function(){var e=this;this.props.showSpinner();var t={stockTransferItems:s.a.filter(this.state.stockTransferItems,(function(t){return s.a.includes(O(e.state.selection),t._id)}))};m.a.post(\"/openboxes/api/stockTransfers/\",Object(m.b)(t)).then((function(t){var r=Object(m.e)(t.data.data);e.props.hideSpinner(),e.props.history.push(\"/openboxes/stockTransfer/create/\".concat(r.id)),e.props.nextPage({stockTransfer:r})})).catch((function(){return e.props.hideSpinner()}))}},{key:\"render\",value:function(){var e=this,t=this.toggleSelection,r=this.toggleAll,n=this.isSelected,o=this.state,s=o.stockTransferItems,i=o.columns,c=o.selectAll,l=o.selectType,u={selectAll:c,isSelected:n,toggleAll:r,toggleSelection:t,selectType:l};return a.a.createElement(\"div\",{className:\"stock-transfer\"},a.a.createElement(\"div\",{className:\"d-flex justify-content-between stock-transfer-buttons\"},a.a.createElement(\"div\",{className:\"count-selected \"},this.state.selection.size,\" \",a.a.createElement(k.a,{id:\"react.stockTransfer.selected.label\",defaultMessage:\"Selected\"})),a.a.createElement(\"button\",{type:\"button\",disabled:this.state.selection.size<1,onClick:function(){return e.createStockTransfer()},className:\"btn btn-outline-primary btn-form float-right btn-xs\"},a.a.createElement(k.a,{id:\"react.stockTransfer.startStockTransfer.label\",defaultMessage:\"Start Stock Transfer\"}))),s?a.a.createElement(x,g({data:s,columns:i,ref:function(t){e.selectTable=t},className:\"-striped -highlight\"},u,{defaultPageSize:Number.MAX_SAFE_INTEGER,minRows:0,showPaginationBottom:!1,filterable:!0,defaultFilterMethod:this.filterMethod,SelectInputComponent:function(e){var t=e.id,r=e.checked,n=e.onClick,o=e.row;return a.a.createElement(\"input\",{type:l,checked:r,disabled:o&&0===o.quantityNotPicked,onChange:function(){},onClick:function(e){var r=e.shiftKey;e.stopPropagation(),n(t,r,o)}})}})):null,a.a.createElement(\"div\",{className:\"submit-buttons\"},a.a.createElement(\"button\",{type:\"button\",disabled:this.state.selection.size<1,onClick:function(){return e.createStockTransfer()},className:\"btn btn-outline-primary btn-form float-right btn-xs\"},a.a.createElement(k.a,{id:\"react.stockTransfer.startStockTransfer.label\",defaultMessage:\"Start Stock Transfer\"}))))}}])&&E(t.prototype,r),n&&E(t,n),Object.defineProperty(t,\"prototype\",{writable:!1}),i}(n.Component),F=Object(f.j)(Object(u.a)((function(e){return{stockTransferTranslationsFetched:e.session.fetchedTranslations.stockTransfer}}),{showSpinner:p.M,hideSpinner:p.C})(M));M.propTypes={showSpinner:c.a.func.isRequired,hideSpinner:c.a.func.isRequired,nextPage:c.a.func.isRequired,locationId:c.a.string.isRequired,history:c.a.shape({push:c.a.func}).isRequired,stockTransferTranslationsFetched:c.a.bool.isRequired};var L=r(70),D=r(33),A=r.n(D);function _(e){return(_=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function H(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?B(Object(r),!0).forEach((function(t){z(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function z(e,t,r){return(t=function(e){var t=function(e,t){if(\"object\"!==_(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||\"default\");if(\"object\"!==_(n))return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===t?String:Number)(e)}(e,\"string\");return\"symbol\"===_(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q(e,t){var r=e.destinationBinLocation,n=e.destinationZone,a={};return a=\"PENDING\"===t?{id:null,name:null,zoneId:null,zoneName:null}:{id:r&&r.id?r.id:null,name:r&&r.name?r.name:null,zoneId:n&&n.id?n.id:null,zoneName:n&&n.name?n.name:null},H(H({},e),{},{destinationBinLocation:a,quantity:\"PENDING\"===t?\"\":e.quantity})}function Z(e,t,r){var n={};return n=\"PENDING\"===r?{id:null,name:null,zoneId:null,zoneName:null}:{id:t.destinationBinLocation.id?t.destinationBinLocation.id:null,name:t.destinationBinLocation.name?t.destinationBinLocation.name:null,zoneId:t.destinationZone?t.destinationZone.id:null,zoneName:t.destinationZone?t.destinationZone.name:null},H(H({},t),{},{destinationBinLocation:n,quantity:\"PENDING\"===r?\"\":t.quantity,quantityOnHand:e.quantityOnHand,referenceId:e.id})}function V(e){var t=[];return s.a.forEach(e.stockTransferItems,(function(r){t.push(Q(r,e.status)),r.splitItems.length>0&&s.a.forEach(r.splitItems,(function(n){t.push(Z(r,n,e.status))}))})),t}r(375);function W(e){return(W=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function G(){return(G=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function $(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function K(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$(Object(r),!0).forEach((function(t){re(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function U(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,ne(n.key),n)}}function X(e,t){return(X=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function J(e){var t=function(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=te(e);if(t){var a=te(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Y(this,r)}}function Y(e,t){if(t&&(\"object\"===W(t)||\"function\"==typeof t))return t;if(void 0!==t)throw new TypeError(\"Derived constructors may only return object or undefined\");return ee(e)}function ee(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}function te(e){return(te=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function re(e,t,r){return(t=ne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ne(e){var t=function(e,t){if(\"object\"!==W(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||\"default\");if(\"object\"!==W(n))return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===t?String:Number)(e)}(e,\"string\");return\"symbol\"===W(t)?t:String(t)}var ae=Object(y.a)(d.a),oe=function(e){!function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,\"prototype\",{writable:!1}),t&&X(e,t)}(i,e);var t,r,n,o=J(i);function i(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,i),re(ee(t=o.call(this,e)),\"getColumns\",(function(){return[{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.code.label\",defaultMessage:\"Code\"}),accessor:\"product.productCode\",style:{whiteSpace:\"normal\"},Filter:T.a},{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.product.label\",defaultMessage:\"Product\"}),accessor:\"product.name\",style:{whiteSpace:\"normal\"},Filter:T.a},{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.lot.label\",defaultMessage:\"Lot\"}),accessor:\"lotNumber\",style:{whiteSpace:\"normal\"},Filter:T.a},{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.expiry.label\",defaultMessage:\"Expiry\"}),accessor:\"expirationDate\",style:{whiteSpace:\"normal\"},Filter:T.a},{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.quantityAvailableToTransfer.label\",defaultMessage:\"Quantity Available to Transfer\"}),accessor:\"quantityNotPicked\",style:{whiteSpace:\"normal\"},width:220,Filter:T.a},{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.currentZone.label\",defaultMessage:\"Current Zone\"}),accessor:\"originZone\",style:{whiteSpace:\"normal\"},Filter:T.a},{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.currentBinLocation.label\",defaultMessage:\"Current Bin Location\"}),accessor:\"originBinLocation.name\",style:{whiteSpace:\"normal\"},Filter:T.a},{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.qtyToTransfer.label\",defaultMessage:\"Qty to Transfer\"}),accessor:\"quantity\",style:{whiteSpace:\"normal\"},Filter:T.a},{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.transferTo.label\",defaultMessage:\"Transfer to\"}),accessor:\"destinationBinLocation.name\",style:{whiteSpace:\"normal\"},Filter:T.a}]})),re(ee(t),\"dataFetched\",!1),re(ee(t),\"filterMethod\",(function(e,t){var r=t[e.id];return s.a.toString(r).toLowerCase().includes(e.value.toLowerCase())})),t.getColumns=t.getColumns.bind(ee(t));var r=t.getColumns(),n=t.props.initialValues.stockTransfer;return t.state={stockTransfer:n||{},columns:r},t.completeStockTransfer=t.completeStockTransfer.bind(ee(t)),t}return t=i,(r=[{key:\"componentDidMount\",value:function(){this.props.stockTransferTranslationsFetched&&(this.dataFetched=!0),this.fetchStockTransfer()}},{key:\"componentWillReceiveProps\",value:function(e){e.stockTransferTranslationsFetched&&!this.dataFetched&&(this.dataFetched=!0)}},{key:\"fetchStockTransfer\",value:function(){var e=this;this.props.showSpinner();var t=\"/openboxes/api/stockTransfers/\".concat(this.props.match.params.stockTransferId);m.a.get(t).then((function(t){var r=Object(m.e)(t.data.data),n=function(e){var t=[];return s.a.forEach(e.stockTransferItems,(function(r){\"CANCELED\"!==r.status&&t.push(Q(r,e.status)),r.splitItems.length>0&&s.a.forEach(r.splitItems,(function(n){t.push(Z(r,n,e.status))}))})),t}(r);e.setState({stockTransfer:K(K({},r),{},{stockTransferItems:n}),originalItems:r.stockTransferItems},(function(){return e.props.hideSpinner()}))})).catch((function(){return e.props.hideSpinner()}))}},{key:\"save\",value:function(){var e=this;this.props.showSpinner();var t=\"/openboxes/api/stockTransfers/\".concat(this.props.match.params.stockTransferId),r=K(K({},this.state.stockTransfer),{},{stockTransferItems:this.state.originalItems,status:\"COMPLETED\"});return m.a.put(t,Object(m.b)(r)).then((function(){e.props.hideSpinner(),A.a.success(e.props.translate(\"react.stockTransfer.alert.stockTransferCompleted.label\",\"Stock transfer was successfully completed!\"),{timeout:3e3}),window.location=\"/openboxes/stockTransfer/show/\".concat(e.state.stockTransfer.id)})).catch((function(){return e.props.hideSpinner()}))}},{key:\"completeStockTransfer\",value:function(){var e=s.a.filter(this.state.stockTransfer.stockTransferItems,(function(e){return e.transferQty<e.quantityNotPicked}));s.a.isEmpty(e)?this.save():this.confirmLowerQuantity(e)}},{key:\"confirmLowerQuantity\",value:function(e){var t=this;Object(L.confirmAlert)({title:this.props.translate(\"react.stockTransfer.message.confirmStockTransfer.label\",\"Confirm Stock Transfer\"),message:s.a.map(e,(function(e){return a.a.createElement(\"p\",null,\"Qty \",e.quantityNotPicked-e.transferQty,\" \",t.props.translate(\"react.stockTransfer.alert.lowerQty1.label\",\"of item\"),\" \",\" \",e.productName,\" \",t.props.translate(\"react.stockTransfer.alert.lowerQty2.label\",\"is still in the receiving bin. Do you want to continue?\"))})),buttons:[{label:this.props.translate(\"react.default.yes.label\",\"Yes\"),onClick:function(){return t.save()}},{label:this.props.translate(\"react.default.no.label\",\"No\")}]})}},{key:\"previousPage\",value:function(){var e=this;this.props.showSpinner();var t=\"/openboxes/api/stockTransfers/\".concat(this.props.match.params.stockTransferId),r=K(K({},this.state.stockTransfer),{},{stockTransferItems:this.state.originalItems});return m.a.put(t,Object(m.b)(r)).then((function(){e.props.hideSpinner(),e.props.previousPage({stockTransfer:e.state.stockTransfer})})).catch((function(){return e.props.hideSpinner()}))}},{key:\"render\",value:function(){var e=this,t=this.state,r=t.columns,n={pivotBy:t.pivotBy};return a.a.createElement(\"div\",{className:\"stock-transfer\"},this.state.stockTransfer&&\"COMPLETED\"===this.state.stockTransfer.status&&a.a.createElement(\"div\",{className:\"submit-buttons d-flex justify-content-end mb-3 mt-0\"},a.a.createElement(\"button\",{type:\"button\",onClick:function(){window.location=\"/openboxes/stockTransfer/show/\".concat(e.state.stockTransfer.id)},className:\"btn btn-outline-primary btn-form btn-xs\",hidden:\"COMPLETED\"!==this.state.stockTransfer.status},a.a.createElement(k.a,{id:\"react.default.button.exit.label\",defaultMessage:\"Exit\"}))),this.state.stockTransfer.stockTransferItems?a.a.createElement(ae,G({data:this.state.stockTransfer.stockTransferItems,columns:r,ref:function(t){e.selectTable=t},className:\"-striped -highlight\"},n,{defaultPageSize:Number.MAX_SAFE_INTEGER,minRows:0,showPaginationBottom:!1,filterable:!0,defaultFilterMethod:this.filterMethod})):null,a.a.createElement(\"div\",{className:\"submit-buttons\"},a.a.createElement(\"button\",{type:\"button\",onClick:function(){return e.previousPage()},className:\"btn btn-outline-primary btn-form btn-xs\",disabled:\"COMPLETED\"===this.state.stockTransfer.status},a.a.createElement(k.a,{id:\"react.default.button.previous.label\",defaultMessage:\"Previous\"})),a.a.createElement(\"button\",{type:\"button\",onClick:function(){return e.completeStockTransfer()},className:\"btn btn-outline-success float-right btn-xs mr-3\",disabled:\"COMPLETED\"===this.state.stockTransfer.status},a.a.createElement(k.a,{id:\"react.stockTransfer.completeStockTransfer.label\",defaultMessage:\"Complete Stock Transfer\"}))))}}])&&U(t.prototype,r),n&&U(t,n),Object.defineProperty(t,\"prototype\",{writable:!1}),i}(n.Component),se=Object(u.a)((function(e){return{translate:Object(k.b)(Object(l.e)(e.localize)),stockTransferTranslationsFetched:e.session.fetchedTranslations.stockTransfer}}),{showSpinner:p.M,hideSpinner:p.C})(oe);oe.propTypes={showSpinner:c.a.func.isRequired,hideSpinner:c.a.func.isRequired,nextPage:c.a.func.isRequired,previousPage:c.a.func.isRequired,translate:c.a.func.isRequired,initialValues:c.a.shape({stockTransfer:c.a.arrayOf(c.a.shape({}))}).isRequired,match:c.a.shape({params:c.a.shape({stockTransferId:c.a.string})}).isRequired,location:c.a.shape({id:c.a.string}).isRequired,stockTransferTranslationsFetched:c.a.bool.isRequired};var ie=r(36),ce=r.n(ie),le=r(31),ue=r.n(le),fe=r(41),pe=r(382);function de(e){return(de=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function be(){return(be=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function he(e){return function(e){if(Array.isArray(e))return me(e)}(e)||function(e){if(\"undefined\"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e[\"@@iterator\"])return Array.from(e)}(e)||function(e,t){if(!e)return;if(\"string\"==typeof e)return me(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===r&&e.constructor&&(r=e.constructor.name);if(\"Map\"===r||\"Set\"===r)return Array.from(e);if(\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return me(e,t)}(e)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ye(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(r),!0).forEach((function(t){Ee(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ye(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ke(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,je(n.key),n)}}function ve(e,t){return(ve=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function ge(e){var t=function(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=we(e);if(t){var a=we(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Se(this,r)}}function Se(e,t){if(t&&(\"object\"===de(t)||\"function\"==typeof t))return t;if(void 0!==t)throw new TypeError(\"Derived constructors may only return object or undefined\");return Oe(e)}function Oe(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}function we(e){return(we=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ee(e,t,r){return(t=je(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function je(e){var t=function(e,t){if(\"object\"!==de(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||\"default\");if(\"object\"!==de(n))return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===t?String:Number)(e)}(e,\"string\");return\"symbol\"===de(t)?t:String(t)}var Pe=Object(y.a)(d.a),Ie=function(e){!function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,\"prototype\",{writable:!1}),t&&ve(e,t)}(i,e);var t,r,n,o=ge(i);function i(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,i),Ee(Oe(t=o.call(this,e)),\"getColumns\",(function(){return[{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.code.label\",defaultMessage:\"Code\"}),accessor:\"product.productCode\",style:{whiteSpace:\"normal\"},Filter:T.a},{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.product.label\",defaultMessage:\"Product\"}),accessor:\"product.name\",style:{whiteSpace:\"normal\"},Filter:T.a},{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.lot.label\",defaultMessage:\"Lot\"}),accessor:\"lotNumber\",style:{whiteSpace:\"normal\"},Filter:T.a},{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.expiry.label\",defaultMessage:\"Expiry\"}),accessor:\"expirationDate\",style:{whiteSpace:\"normal\"},Filter:T.a},{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.quantityAvailableToTransfer.label\",defaultMessage:\"Quantity Available to Transfer\"}),accessor:\"quantityNotPicked\",style:{whiteSpace:\"normal\"},width:220,Filter:T.a},{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.currentZone.label\",defaultMessage:\"Current Zone\"}),accessor:\"originZone\",style:{whiteSpace:\"normal\"},Filter:T.a},{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.currentBinLocation.label\",defaultMessage:\"Current Bin Location\"}),accessor:\"originBinLocation.name\",style:{whiteSpace:\"normal\"},Filter:T.a},{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.qtyToTransfer.label\",defaultMessage:\"Qty to Transfer\"}),accessor:\"quantity\",style:{whiteSpace:\"normal\"},Cell:function(e){var r,n=e.index,o=t.state.stockTransfer.stockTransferItems,i=s.a.filter(o,(function(t){return t.referenceId&&t.referenceId===e.original.referenceId})),c=!1;!e.original.id||i.length>1?s.a.reduce(i,(function(e,t){return e+(t.quantity?s.a.toInteger(t.quantity):0)}),0)>e.original.quantityNotPicked&&s.a.forEach(o,(function(e){s.a.forEach(i,(function(n){e===n&&(c=!0,r=t.props.translate(\"react.stockTransfer.higherSplitQuantity.label\",\"Sum of quantity to transfer of split items cannot be higher than quantity in current bin.\"))}))})):1===i.length&&e.original.quantityNotPicked<s.a.toInteger(e.value)&&(c=!0,r=t.props.translate(\"react.stockTransfer.higherQuantity.label\",\"Quantity to transfer cannot be higher than quantity in current bin\"));return s.a.toInteger(e.value)?s.a.toInteger(e.value)>e.original.quantityNotPicked?(c=!0,r=t.props.translate(\"react.stockTransfer.higherThanQoH.label\",\"Cant transfer more than on hand.\")):s.a.toInteger(e.value)<0&&(c=!0,r=t.props.translate(\"react.stockTransfer.errors.negativeQty.label\",\"Quantity to transfer can't be negative\")):(c=!0,r=t.props.translate(\"react.stockTransfer.selectOrDeleteLine.label\",\"Please select a quantity or delete the line\")),a.a.createElement(fe.Tooltip,{html:r,disabled:!c,theme:\"transparent\",arrow:\"true\",delay:\"150\",duration:\"250\",hideDelay:\"50\"},a.a.createElement(\"div\",{className:c&&\"CANCELED\"!==e.original.status?\"has-error\":\"\"},a.a.createElement(\"input\",{type:\"number\",className:\"form-control form-control-xs\",value:e.value,disabled:\"CANCELED\"===e.original.status,onChange:function(e){var r=ce()(t.state.stockTransfer,{stockTransferItems:Ee({},n,{quantity:{$set:e.target.value}})});t.changeStockTransfer(r)}})))},Filter:T.a},{Header:a.a.createElement(k.a,{id:\"react.stockTransfer.transferTo.label\",defaultMessage:\"Transfer to\"}),accessor:\"destinationBinLocation\",Cell:function(e){return a.a.createElement(pe.a,{options:t.state.bins,value:s.a.get(t.state.stockTransfer.stockTransferItems,\"[\".concat(e.index,\"].\").concat(e.column.id))||null,onChange:function(r){return t.changeStockTransfer(ce()(t.state.stockTransfer,{stockTransferItems:Ee({},e.index,{destinationBinLocation:{$set:r}})}))},valueKey:\"id\",labelKey:\"name\",className:\"select-xs\",disabled:\"CANCELED\"===e.original.status})},Filter:T.a},{Header:\"\",accessor:\"splitItems\",Cell:function(e){return a.a.createElement(\"div\",{className:\"d-flex flex-row flex-wrap\"},!e.original.referenceId&&a.a.createElement(\"button\",{className:\"btn btn-outline-success btn-xs mr-1 mb-1\",onClick:function(){return t.splitItem(e)}},a.a.createElement(k.a,{id:\"react.stockTransfer.splitItem.label\",defaultMessage:\"Split line\"})),a.a.createElement(\"button\",{className:\"btn btn-outline-danger btn-xs mb-1\",onClick:function(){return t.deleteItem(e.index)}},a.a.createElement(k.a,{id:\"react.default.button.delete.label\",defaultMessage:\"Delete\"})))},filterable:!1}]})),Ee(Oe(t),\"dataFetched\",!1),Ee(Oe(t),\"filterMethod\",(function(e,t){var r=t[e.id];return\"destinationBinLocation\"===e.id&&(r=s.a.get(r,\"name\")),s.a.toString(r).toLowerCase().includes(e.value.toLowerCase())})),t.getColumns=t.getColumns.bind(Oe(t));var r=t.getColumns(),n=t.props.initialValues.stockTransfer;return t.state={stockTransfer:n||{},columns:r,bins:[]},t}return t=i,(r=[{key:\"componentDidMount\",value:function(){this.props.stockTransferTranslationsFetched&&(this.dataFetched=!0,this.fetchBins()),this.fetchStockTransfer()}},{key:\"componentWillReceiveProps\",value:function(e){e.stockTransferTranslationsFetched&&!this.dataFetched&&(this.dataFetched=!0,this.fetchBins())}},{key:\"fetchStockTransfer\",value:function(){var e=this;this.props.showSpinner();var t=\"/openboxes/api/stockTransfers/\".concat(this.props.match.params.stockTransferId);m.a.get(t).then((function(t){var r=Object(m.e)(t.data.data),n=V(r);e.setState({stockTransfer:Te(Te({},r),{},{stockTransferItems:n})},(function(){return e.props.hideSpinner()}))})).catch((function(){return e.props.hideSpinner()}))}},{key:\"fetchBins\",value:function(){var e=this;this.props.showSpinner();var t=function(e){return s.a.chain(e).orderBy([\"label\"],[\"asc\"]).value()};return m.a.get(\"/openboxes/api/internalLocations\",{paramsSerializer:function(e){return ue.a.stringify(e)},params:{\"location.id\":this.props.location.id,locationTypeCode:[\"BIN_LOCATION\",\"INTERNAL\"],ignoreActivityCodes:[\"RECEIVE_STOCK\"]}}).then((function(r){var n=s.a.partition(r.data.data,(function(e){return e.zoneName})),a=s.a.chain(n[0]).groupBy(\"zoneName\").map((function(e,r){return{name:r,options:t(e)}})).orderBy([\"name\"],[\"asc\"]).value(),o=t(n[1]);e.setState({bins:[].concat(he(a),he(o))},(function(){return e.props.hideSpinner()}))})).catch((function(){return e.props.hideSpinner()}))}},{key:\"saveStockTransfer\",value:function(e,t){var r,n,a,o,i=this,c=\"/openboxes/api/stockTransfers/\".concat(this.props.match.params.stockTransferId),l=(r=e,n=\"APPROVED\",a=s.a.filter(r.stockTransferItems,(function(e){return!e.referenceId})),o=s.a.map(a,(function(e){return H(H({},e),{},{splitItems:s.a.filter(r.stockTransferItems,(function(t){return t.referenceId===e.id})),quantity:\"\"===e.quantity?e.quantityOnHand:e.quantity})})),H(H({},r),{},{stockTransferItems:o,status:n}));m.a.put(c,Object(m.b)(l)).then((function(e){var r=Object(m.e)(e.data.data),n=V(r);i.setState({stockTransfer:Te(Te({},r),{},{stockTransferItems:n})},(function(){i.props.hideSpinner(),t&&t(r)}))})).catch((function(){return i.props.hideSpinner()}))}},{key:\"changeStockTransfer\",value:function(e){this.setState({stockTransfer:e})}},{key:\"deleteItem\",value:function(e){var t=this;this.props.showSpinner();var r=s.a.get(this.state.stockTransfer.stockTransferItems,\"[\".concat(e,\"]\"));if(r.id){var n=\"/openboxes/api/stockTransferItems/\".concat(r.id);m.a.delete(n).then((function(e){var r=Object(m.e)(e.data.data),n=V(r);t.setState({stockTransfer:Te(Te({},r),{},{stockTransferItems:n})},(function(){return t.props.hideSpinner()}))})).catch((function(){return t.props.hideSpinner()}))}else{var a=ce()(this.state.stockTransfer,{stockTransferItems:{$splice:[[e,1]]}}),o=s.a.find(a.stockTransferItems,(function(e){return e.id===r.referenceId}));if(0===s.a.filter(a.stockTransferItems,(function(e){return e.referenceId===o.id})).length&&o){var i=s.a.findIndex(a.stockTransferItems,o);a=ce()(a,{stockTransferItems:Ee({},i,{status:{$set:\"PENDING\"}})})}this.setState({stockTransfer:a}),this.props.hideSpinner()}}},{key:\"nextPage\",value:function(){var e=this;this.saveStockTransfer(this.state.stockTransfer,(function(t){e.props.nextPage({stockTransfer:t})}))}},{key:\"printStockTransfer\",value:function(){var e=\"/openboxes/stockTransfer/print/\".concat(this.props.match.params.stockTransferId);this.saveStockTransfer(this.state.stockTransfer,(function(){return window.open(e,\"_blank\")}))}},{key:\"generateStockTransfer\",value:function(){}},{key:\"splitItem\",value:function(e){var t=e.index,r=e.original,n=Te(Te({},r),{},{referenceId:r.id?r.id:r.referenceId,id:null,status:null}),a=ce()(this.state.stockTransfer,{stockTransferItems:Ee({$splice:\"CANCELED\"!==r.status?[[t+1,0,n],[t+1,0,n]]:[[t+1,0,n]]},t,{$set:r.id?Te(Te({},r),{},{status:\"CANCELED\",quantity:\"\"}):Te(Te({},r),{},{quantity:\"\"})})});this.setState({stockTransfer:a})}},{key:\"autofill\",value:function(){var e=this.state.stockTransfer;this.setState({stockTransfer:Te(Te({},e),{},{stockTransferItems:s.a.map(e.stockTransferItems,(function(e){return Te(Te({},e),{},{quantity:e.quantityNotPicked})}))})})}},{key:\"isDisabled\",value:function(){var e=this.state.stockTransfer.stockTransferItems;return e&&!!e.find((function(t){var r=t.quantity,n=t.quantityNotPicked;if(\"CANCELED\"!==t.status&&(!r||r>n||r<=0))return!0;var a=s.a.filter(e,(function(e){return e.referenceId&&e.referenceId===t.referenceId}));return(!t.id||a.length>1)&&s.a.reduce(a,(function(e,t){return e+(t.quantity?s.a.toInteger(t.quantity):0)}),0)>n}))}},{key:\"render\",value:function(){var e=this,t=this.state,r=t.columns,n={pivotBy:t.pivotBy};return a.a.createElement(\"div\",{className:\"stock-transfer\"},a.a.createElement(\"div\",{className:\"d-flex\"},a.a.createElement(\"div\",{className:\"submit-buttons\"},a.a.createElement(\"button\",{type:\"button\",onClick:function(){return e.autofill(e.state.stockTransfer)},className:\"btn btn-primary btn-form btn-xs\"},a.a.createElement(k.a,{id:\"react.partialReceiving.autofillQuantities.label\",defaultMessage:\"Autofill quantities\"}))),a.a.createElement(\"div\",{className:\"d-flex mb-3 justify-content-end submit-buttons\"},a.a.createElement(\"button\",{type:\"button\",onClick:function(){return e.saveStockTransfer(e.state.stockTransfer)},className:\"btn btn-success btn-form btn-xs\",disabled:s.a.some(this.state.stockTransfer.stockTransferItems,(function(e){return e.quantity>e.quantityAvailable}))},a.a.createElement(\"span\",null,a.a.createElement(\"i\",{className:\"fa fa-save pr-2\"}),a.a.createElement(k.a,{id:\"react.default.button.save.label\",defaultMessage:\"Save\"}))),a.a.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-secondary btn-xs p-1 ml-3 mb-1\",onClick:function(){return e.printStockTransfer()}},a.a.createElement(\"span\",null,a.a.createElement(\"i\",{className:\"fa fa-print pr-2\"}),a.a.createElement(k.a,{id:\"react.stockTransfer.generateStockTransfer.label\",defaultMessage:\"Generate Stock Transfer\"}))))),this.state.stockTransfer.stockTransferItems?a.a.createElement(Pe,be({data:this.state.stockTransfer.stockTransferItems,columns:r,ref:function(t){e.selectTable=t},className:\"-striped -highlight\"},n,{defaultPageSize:Number.MAX_SAFE_INTEGER,minRows:0,showPaginationBottom:!1,filterable:!0,defaultFilterMethod:this.filterMethod})):null,a.a.createElement(\"div\",{className:\"submit-buttons\"},a.a.createElement(\"button\",{type:\"button\",onClick:function(){return e.nextPage()},disabled:this.isDisabled(),className:\"btn btn-outline-primary btn-form float-right btn-xs\"},a.a.createElement(k.a,{id:\"react.default.button.next.label\",defaultMessage:\"Next\"}))))}}])&&ke(t.prototype,r),n&&ke(t,n),Object.defineProperty(t,\"prototype\",{writable:!1}),i}(n.Component),Ce=Object(u.a)((function(e){return{translate:Object(k.b)(Object(l.e)(e.localize)),stockTransferTranslationsFetched:e.session.fetchedTranslations.stockTransfer}}),{showSpinner:p.M,hideSpinner:p.C})(Ie);Ie.propTypes={showSpinner:c.a.func.isRequired,hideSpinner:c.a.func.isRequired,nextPage:c.a.func.isRequired,translate:c.a.func.isRequired,initialValues:c.a.shape({stockTransfer:c.a.arrayOf(c.a.shape({}))}).isRequired,match:c.a.shape({params:c.a.shape({stockTransferId:c.a.string})}).isRequired,location:c.a.shape({id:c.a.string}).isRequired,stockTransferTranslationsFetched:c.a.bool.isRequired};var Ne=r(439);r(862);function qe(e){return(qe=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function Re(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,Ae(n.key),n)}}function xe(e,t){return(xe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Me(e){var t=function(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=De(e);if(t){var a=De(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Fe(this,r)}}function Fe(e,t){if(t&&(\"object\"===qe(t)||\"function\"==typeof t))return t;if(void 0!==t)throw new TypeError(\"Derived constructors may only return object or undefined\");return Le(e)}function Le(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}function De(e){return(De=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ae(e){var t=function(e,t){if(\"object\"!==qe(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||\"default\");if(\"object\"!==qe(n))return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===t?String:Number)(e)}(e,\"string\");return\"symbol\"===qe(t)?t:String(t)}var _e=function(e){!function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,\"prototype\",{writable:!1}),t&&xe(e,t)}(i,e);var t,r,n,o=Me(i);function i(e){var t,r,n,a;return function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,i),t=o.call(this,e),r=Le(t),a=!1,(n=Ae(n=\"dataFetched\"))in r?Object.defineProperty(r,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[n]=a,t.state={page:e.match.params.stockTransferId?2:1,stockTransfer:{}},t.updateWizardValues=t.updateWizardValues.bind(Le(t)),t}return t=i,(r=[{key:\"componentDidMount\",value:function(){this.props.fetchTranslations(\"\",\"stockTransfer\"),this.props.stockTransferTranslationsFetched&&(this.dataFetched=!0,this.fetchStockTransfer())}},{key:\"componentWillReceiveProps\",value:function(e){this.props.locale&&this.props.locale!==e.locale&&this.props.fetchTranslations(e.locale,\"stockTransfer\"),e.stockTransferTranslationsFetched&&!this.dataFetched&&(this.dataFetched=!0,this.fetchStockTransfer())}},{key:\"stepList\",get:function(){return[this.props.translate(\"react.stockTransfer.createStockTransfer.label\",\"Create Stock Transfer\"),this.props.translate(\"react.stockTransfer.startStockTransfer.label\",\"Start Stock Transfer\"),this.props.translate(\"react.stockTransfer.checkStockTransfer.label\",\"Check Stock Transfer\")]}},{key:\"wizardTitle\",get:function(){var e,t=this.state.stockTransfer;return null!=t&&null!==(e=t.stockTransfer)&&void 0!==e&&e.stockTransferNumber?[{text:this.props.translate(\"react.stockTransfer.label\",\"Stock Transfer\"),color:\"#000000\",delimeter:\" | \"},{text:t.stockTransfer.stockTransferNumber,color:\"#000000\",delimeter:\"\"}]:\"\"}},{key:\"updateWizardValues\",value:function(e,t){this.setState({page:e,stockTransfer:t})}},{key:\"fetchStockTransfer\",value:function(){var e=this;if(this.props.match.params.stockTransferId){this.props.showSpinner();var t=\"/openboxes/api/stockTransfers/\".concat(this.props.match.params.stockTransferId);m.a.get(t).then((function(t){var r=Object(m.e)(t.data.data);e.setState({stockTransfer:{stockTransfer:r},page:\"COMPLETED\"===r.status?3:2}),e.props.hideSpinner()})).catch((function(){return e.props.hideSpinner()}))}}},{key:\"render\",value:function(){var e=this.state,t=e.page,r=e.stockTransfer,n=this.props,o=n.location,i=n.history,c=n.match,l=o.id,u=[F,Ce,se];return s.a.get(o,\"id\")?a.a.createElement(Ne.a,{pageList:u,stepList:this.stepList,initialValues:r,title:this.wizardTitle,additionalTitle:null,currentPage:t,prevPage:1===t?1:t-1,updateWizardValues:this.updateWizardValues,additionalProps:{locationId:l,location:o,history:i,match:c}}):null}}])&&Re(t.prototype,r),n&&Re(t,n),Object.defineProperty(t,\"prototype\",{writable:!1}),i}(n.Component);t.default=Object(f.j)(Object(u.a)((function(e){return{location:e.session.currentLocation,locale:e.session.activeLanguage,stockTransferTranslationsFetched:e.session.fetchedTranslations.stockTransfer,translate:Object(k.b)(Object(l.e)(e.localize))}}),{showSpinner:p.M,hideSpinner:p.C,fetchTranslations:p.y})(_e));_e.propTypes={location:c.a.shape({id:c.a.string}).isRequired,locale:c.a.string.isRequired,stockTransferTranslationsFetched:c.a.bool.isRequired,fetchTranslations:c.a.func.isRequired,translate:c.a.func.isRequired,showSpinner:c.a.func.isRequired,hideSpinner:c.a.func.isRequired,match:c.a.shape({params:c.a.shape({stockTransferId:c.a.string})}).isRequired,history:c.a.shape({push:c.a.func}).isRequired}}}]);","extractedComments":[]}